/*!
* ofa v3.0.9
* https://github.com/kirakiray/ofa.js
* 
* (c) 2018-2023 YAO
* Released under the MIT License.
*/(e=>{"use strict";const t=()=>Math.random().toString(32).substr(2);var r=Object.prototype.toString,s=e=>r.call(e).toLowerCase().replace(/(\[object )|(])/g,"");const a=e=>s(e).search("function")>-1;var n=e=>!Object.keys(e).length;const o=Object.defineProperties,i=Object.getOwnPropertyDescriptor,l=e=>e instanceof x,c=null!==document.currentScript.getAttribute("debug"),h=(()=>{if(c){let e=new Map;return(r,s)=>{s||(s=t());let a=e.get(s);clearTimeout(a),e.set(s,setTimeout(()=>{r(),e.delete(s)}))}}let e=new Map,r=e=>Promise.resolve().then(()=>e());"object"==typeof process&&process.nextTick&&(r=process.nextTick);let s=!1;return(a,n)=>{n||(n=t()),e.set(n,{key:n,fun:a}),s||(s=!0,r(()=>{e.size&&e.forEach(({key:t,fun:r})=>{try{r()}catch(e){console.error(e)}e.delete(t)}),e.clear(),s=!1}))}})(),d=(e,t)=>{let r,s=[];const a=n=>{s.push({...n}),t?(clearTimeout(r),r=setTimeout(()=>{e(s),s.length=0},t)):h(()=>{e(s),s.length=0},a)};return a},u=(e,t,r={})=>{Object.keys(t).forEach(s=>{let{get:a,set:n,value:o}=i(t,s);o?e.hasOwnProperty(s)?e[s]=o:Object.defineProperty(e,s,{...r,value:o}):Object.defineProperty(e,s,{...r,get:a,set:n})})},p=Symbol("self"),f=Symbol("proxy"),m=Symbol("watchs"),g=Symbol("can_update"),y=new Set(["root","sub","revoke"]),b=(e,t,r,s)=>{if(r&&r.includes(e[f]))return void console.warn("Circular references appear");let a;a=t.path=r?[e[f],...r]:[e[f]],e[m].forEach(e=>e(t)),s||e._unupdate||e.owner&&e.owner.forEach(e=>b(e,t,a.slice()))};class x{constructor(e,r){let s;e.get?(s=new Proxy(this,{get:e.get,ownKeys:e.ownKeys,getOwnPropertyDescriptor:e.getOwnPropertyDescriptor,set:w.set}),delete e.get,delete e.ownKeys,delete e.getOwnPropertyDescriptor):s=new Proxy(this,w);let a=r;o(this,{[p]:{value:this},[f]:{value:s},xid:{value:"x_"+t()},_xtatus:{get:()=>a,set(e){if(!y.has(e))throw{target:s,desc:`xtatus not allowed to be set ${e}`};const t=this.owner.size;if("revoke"===e&&t)throw{target:s,desc:"the owner is not empty"};if("revoke"===a&&"revoke"!==e)t||v(this);else if("sub"===a&&"root"===e)throw{target:s,desc:"cannot modify sub to root"};a=e}},owner:{configurable:!0,writable:!0,value:new Set},length:{configurable:!0,writable:!0,value:0},[m]:{value:new Map},[g]:{writable:!0,value:0}});let n=-1;return Object.keys(e).forEach(t=>{let r=i(e,t),{value:a,get:l,set:c}=r;"get"!==t&&(/\D/.test(t)||(t=parseInt(t))>n&&(n=t),l||c?o(this,{[t]:r}):s[t]=a)}),n>-1&&(this.length=n+1),this[g]=1,s}watch(e){const r="e_"+t();return this[m].set(r,e),r}unwatch(e){return this[m].delete(e)}setData(e,t){let r,a=s(t);"array"!=a&&"object"!=a||(t=E(t,"sub")).owner.add(this);const n=Object.getOwnPropertyDescriptor(this,e),o=this[f];try{r=o[e]}catch(e){}if(r===t)return!0;let i;return n&&n.set?(n.set.call(o,t),i=!0):i=Reflect.set(this,e,t),this[g]&&b(this,{xid:this.xid,name:"setData",args:[e,t]}),_(r,this),i}update(e={}){b(this,Object.assign({},e,{xid:this.xid,isCustom:!0}))}delete(e){if(/^_/.test(e)||"symbol"==typeof e)return Reflect.deleteProperty(this,e);if(!e)return!1;const t=this[p];let r=t[e];_(r,t);let s=Reflect.deleteProperty(t,e);return b(this,{xid:this.xid,name:"delete",args:[e]}),s}}const w={set(e,t,r,s){if("symbol"==typeof t)return Reflect.set(e,t,r,s);if(/^_/.test(t))return e.hasOwnProperty(t)?Reflect.set(e,t,r,s):o(e,{[t]:{writable:!0,configurable:!0,value:r}}),!0;try{return e.setData(t,r)}catch(e){throw{desc:`failed to set ${t}`,key:t,value:r,target:s}}},deleteProperty:function(e,t){return e.delete(t)}},_=(e,t)=>{if(!l(e))return;const{owner:r}=e;r.delete(t),r.size||(e._xtatus="revoke",Object.values(e).forEach(t=>{_(t,e[p])}))},v=e=>{"revoke"===e._xtatus&&Object.values(e).forEach(t=>{l(t)&&(v(t),t.owner.add(e),t._xtatus="sub")})},E=(e,t="root")=>l(e)?(e._xtatus=t,e):new x(e,t);u(x.prototype,{seek(e){let t=[];if(!a(e)){let t=new Function(`with(this){return ${e}}`);e=(e=>{try{return t.call(e,e)}catch(e){}})}return e.call(this,this)&&t.push(this),Object.values(this).forEach(r=>{l(r)&&t.push(...r.seek(e))}),t},watchTick(e,t){return this.watch(d(e,t))},watchUntil(e){let t=a(e);if(!t&&/[^=><]=[^=]/.test(e))throw"cannot use single =";return new Promise(r=>{let s,a=t?e.bind(this):new Function(`\n        try{with(this){\n            return ${e}\n        }}catch(e){}`).bind(this);const n=this.watchTick(s=(()=>{let e=a();e&&(this.unwatch(n),r(e))}));s()})},watchKey(e,t){t&&Object.keys(e).forEach(t=>e[t].call(this,this[t]));let r={};return Object.keys(e).forEach(e=>{r[e]=this[e]}),this.watch(d(t=>{Object.keys(e).forEach(s=>{let a=this[s],n=r[s];if(n!==a)e[s].call(this,a,{old:n});else if(l(a)){t.some(e=>{return e.path[1]==a})&&e[s].call(this,a,{old:n})}r[s]=a})}))},toJSON(){let e={},t=!0,r=0;Object.keys(this).forEach(s=>{let a=this[s];/\D/.test(s)?t=!1:(s=parseInt(s))>r&&(r=s),l(a)&&(a=a.toJSON()),e[s]=a}),t&&(e.length=r+1,e=Array.from(e));const s=this.xid;return o(e,{xid:{get:()=>s}}),e},toString(){return JSON.stringify(this.toJSON())}}),["concat","every","filter","find","findIndex","forEach","map","slice","some","indexOf","lastIndexOf","includes","join"].forEach(e=>{let t=Array.prototype[e];t&&o(x.prototype,{[e]:{value:t}})});const k=Array.prototype.splice;u(x.prototype,{splice(e,t,...r){let a=this[p];r=r.map(e=>{let t=s(e);return"array"!=t&&"object"!=t||(e=E(e,"sub")).owner.add(a),e});const n="number"==s(t)?t:this.length-e,o=k.call(a,e,n,...r);return o.forEach(e=>_(e,a)),b(this,{xid:this.xid,name:"splice",args:[e,t,...r]}),o},unshift(...e){return this.splice(0,0,...e),this.length},push(...e){return this.splice(this.length,0,...e),this.length},shift(){return this.splice(0,1)[0]},pop(){return this.splice(this.length-1,1)[0]}}),["sort","reverse"].forEach(e=>{const t=Array.prototype[e];t&&o(x.prototype,{[e]:{value(...r){let s=t.apply(this[p],r);return b(this,{xid:this.xid,name:e}),s}}})});const A=e=>e?e.__xEle__?e.__xEle__:e.__xEle__=new R(e):null,O=document.createElement("template"),j=(e,t)=>!!e.tagName&&(e===t||e!==document&&(O.innerHTML=`<${e.tagName.toLowerCase()} ${Array.from(e.attributes).map(e=>e.name+'="'+e.value+'"').join(" ")} />`,!!O.content.querySelector(t))),S=e=>{const t=document.createElement("div");return t.innerHTML=e,Array.from(t.children).map(function(e){return t.removeChild(e),e})},$=e=>{if(!e.tag)throw console.error("this data need tag =>",e),"";let t=document.createElement(e.tag);e.class&&t.setAttribute("class",e.class),e.slot&&t.setAttribute("slot",e.slot);const r=A(t);r[I].forEach(t=>{e[t]&&(r[t]=e[t])});let s=0;for(;s in e;){let r=$(e[s]);t.appendChild(r),s++}return t},L=e=>(/\-/.test(e)&&(e=e.replace(/\-[\D]/g,e=>e.substr(1).toUpperCase())),e),T=e=>(/[A-Z]/.test(e)&&(e=e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase())),e),C=(e,t)=>{if("string"==typeof t&&t.includes(".")){let r=e;return t.split(".").forEach(e=>{r=r[e]}),r}return e[t]},P=(e,t,r)=>{if("string"==typeof t&&t.includes(".")){let s=e,a=t,n=t.split("."),o=n.length-1;n.forEach((t,r)=>{r!==o?s=e[t]:a=t}),s[a]=r}else e[t]=r},N={get:(e,t,r)=>"string"!=typeof t||/\D/.test(t)?Reflect.get(e,t,r):A(e.ele.children[t]),ownKeys(e){let t=Reflect.ownKeys(e),r=e.ele.children.length;for(let e=0;e<r;e++)t.push(String(e));return t},getOwnPropertyDescriptor:(e,t)=>"string"!=typeof t||/\D/.test(t)?Reflect.getOwnPropertyDescriptor(e,t):{enumerable:!0,configurable:!0}},D=Symbol("events"),M=x.prototype.setData,H=["text","html","show","style"],I=Symbol("cansetkeys");class R extends x{constructor(e){super(Object.assign({},N));const t=this[p];t.tag=e.tagName?e.tagName.toLowerCase():"",o(t,{owner:{get(){let t=e.parentNode;return t?[A(t)]:[]}}}),o(t,{ele:{get:()=>e},[D]:{writable:!0,value:""}}),delete t.length,"input"!=t.tag&&"textarea"!=t.tag&&"select"!=t.tag||q(t)}setData(e,t){if(!this[I]||this[I].has(e))return M.call(this,e,t)}get root(){return A(this.ele.getRootNode())}get host(){let e=this.ele.getRootNode(),{host:t}=e;return t?A(t):null}get shadow(){return A(this.ele.shadowRoot)}get parent(){let{parentNode:e}=this.ele;return e&&e!==document?A(e):null}get index(){let{parentNode:e}=this.ele;return e?Array.prototype.indexOf.call(e.children,this.ele):null}get length(){return this.ele.children.length}get text(){return this.ele.textContent}set text(e){this.ele.textContent=e}get html(){return this.ele.innerHTML}set html(e){this.ele.innerHTML=e}get class(){return this.ele.classList}get data(){return this.ele.dataset}get css(){return getComputedStyle(this.ele)}get style(){return this.ele.style}set style(e){if("string"==s(e))return void(this.ele.style=e);let{style:t}=this,r=Array.from(t),a=Object.keys(e);r.forEach(e=>{a.includes(e)||(t[e]="")}),Object.assign(t,e)}get show(){return"none"!==this.ele.style.display}set show(e){this.ele.style.display=e?"":"none"}get position(){return{top:this.ele.offsetTop,left:this.ele.offsetLeft}}get offset(){let e={top:0,left:0},t=this.ele;for(;t&&t!==document;)e.top+=t.offsetTop,e.left+=t.offsetLeft,t=t.offsetParent;return e}get width(){return parseInt(getComputedStyle(this.ele).width)}get height(){return parseInt(getComputedStyle(this.ele).height)}get innerWidth(){return this.ele.clientWidth}get innerHeight(){return this.ele.clientHeight}get offsetWidth(){return this.ele.offsetWidth}get offsetHeight(){return this.ele.offsetHeight}get outerWidth(){let e=getComputedStyle(this.ele);return this.ele.offsetWidth+parseInt(e["margin-left"])+parseInt(e["margin-right"])}get outerHeight(){let e=getComputedStyle(this.ele);return this.ele.offsetHeight+parseInt(e["margin-top"])+parseInt(e["margin-bottom"])}get next(){const e=this.ele.nextElementSibling;return e?A(e):null}get prev(){const e=this.ele.previousElementSibling;return e?A(e):null}$(e){const t=this.ele.querySelector(e);return t?A(t):null}all(e){return Array.from(this.ele.querySelectorAll(e)).map(e=>A(e))}is(e){return j(this.ele,e)}attr(...e){let[t,r]=e,{ele:s}=this;if(1==e.length)return t instanceof Object&&Object.keys(t).forEach(e=>{s.setAttribute(e,t[e])}),s.getAttribute(t);null===r?s.removeAttribute(t):s.setAttribute(t,r)}siblings(e){let t=Array.from(this.parent.ele.children),r=t.indexOf(this.ele);return t.splice(r,1),e&&(t=t.filter(t=>{if(j(t,e))return!0})),t.map(e=>A(e))}parents(e,t){let r=[],a=this.parent;if(e){if("string"==s(e))for(;a&&a;)j(a.ele,e)&&r.push(a),a=a.parent}else for(;a;)r.push(a),a=a.parent;if(t)if(t instanceof R){let e=[];r.some(r=>{if(r===t)return!0;e.push(r)}),r=e}else if("string"==s(t)){let e=[];r.some(r=>{if(r.is(t))return!0;e.push(r)}),r=e}return r}clone(){let e=A(this.ele.cloneNode(!0));return Object.keys(this).forEach(t=>{"tag"!==t&&(e[t]=this[t])}),e}remove(){const{parent:e}=this;e.splice(e.indexOf(this),1)}extend(e){const t=Object.getOwnPropertyDescriptors(e);Object.entries(t).forEach(([e,t])=>{t.set&&this[I].add(e)}),u(this,e,{configurable:!0})}}o(R.prototype,{[I]:{value:new Set(H)}});const q=e=>{let t=e.attr("type")||"text";const{ele:r}=e;let s={type:{enumerable:!0,get:()=>t},name:{enumerable:!0,get:()=>r.name},value:{enumerable:!0,get:()=>r.hasOwnProperty("__value")?r.__value:r.value,set(t){r.value=r.__value=t,b(e,{xid:e.xid,name:"setData",args:["value",t]})}},disabled:{enumerable:!0,get:()=>r.disabled,set(e){r.disabled=e}},msg:{writable:!0,value:null},[I]:{value:new Set(["value","disabled","msg",...H])}};switch(t){case"radio":case"checkbox":Object.assign(s,{checked:{enumerable:!0,get:()=>r.checked,set(e){r.checked=e}},name:{enumerable:!0,get:()=>r.name}}),delete s.msg,e.on("change",t=>{b(e,{xid:e.xid,name:"setData",args:["checked",r.checked]})}),s[I].value.add("checked");break;case"file":Object.assign(s,{accept:{enumerable:!0,get:()=>r.accept}});break;case"text":default:e.on("input",t=>{delete r.__value,b(e,{xid:e.xid,name:"setData",args:["value",r.value]})})}o(e,s)};const J=(e,t)=>{const r={};return e.forEach(e=>{const{name:s,type:a,value:n}=e;switch(a){case"radio":e.checked&&(r[s]=n);break;case"checkbox":let o=r[s]||(r[s]=t[s])||(r[s]=[]);e.checked?o.includes(e.value)||o.push(n):o.includes(e.value)&&o.splice(o.indexOf(e.value),1);break;case"text":default:r[s]=n}}),r},F=e=>{e.forEach(e=>{const t=new CustomEvent("verify",{bubbles:!1});if(t.msg="",t.formData=this,t.$target=e,e.trigger(t),!e.hasOwnProperty("msg"))return;const{msg:r}=t,a=s(r);"string"==a?e.msg=r||null:"error"==a?"error"===s(e.msg)&&e.msg.message===r.message||(e.msg=r):console.warn({target:e,msg:r,desc:"msg can only be Error or String"})})};u(R.prototype,{form(e){const t={selector:"input,textarea,select",delay:100};return"string"===s(e)?t.selector=e:Object.assign(t,e),new class extends x{constructor(e,{selector:t,delay:r,_target:s}){super(e,"root"),this._selector=t,this._target=s,this._delay=r;let a,n,o=0,i=()=>{const e=this.eles(),t=J(e,this),r=Object.keys(t);Object.keys(this).filter(e=>!r.includes(e)).forEach(e=>{delete this[e]}),Object.assign(this,t),a=this.toJSON(),o&&F(e)};this._wid=s.watch(()=>{clearTimeout(n),n=setTimeout(()=>{i()},this._delay)}),i(),o=1,this.watchTick(e=>{let t=this.toJSON();Object.entries(t).forEach(([e,t])=>{let r=a[e];(t!==r||"object"==typeof t&&"object"==typeof r&&JSON.stringify(t)!==JSON.stringify(r))&&this.eles(e).forEach(e=>{switch(e.type){case"checkbox":t.includes(e.value)?e.checked=!0:e.checked=!1;break;case"radio":e.value==t?e.checked=!0:e.checked=!1;break;case"text":default:e.value=t}})}),a=t})}eles(e){let t=this._target.all(this._selector);return e?t.filter(t=>t.name===e):t}}({},{selector:t.selector,delay:t.delay,_target:this})}}),["concat","every","filter","find","findIndex","forEach","map","slice","some","indexOf","lastIndexOf","includes","join"].forEach(e=>{const t=Array.prototype[e];t&&Object.defineProperty(R.prototype,e,{value(...e){return t.apply(Array.from(this.ele.children).map(A),e)}})}),u(R.prototype,{splice(e,t,...r){const{ele:a}=this,n=Array.from(a.children),o=[];let i=e,l="number"==s(t)?t:this.length-e,c=n[i];for(;c&&l>0;)o.push(c),a.removeChild(c),l--,c=n[++i];if(r.length){let t=document.createDocumentFragment();r.forEach(e=>{if(e instanceof Element)return void t.appendChild(e);if(e instanceof R)return void t.appendChild(e.ele);let r=s(e);"string"==r?S(e).forEach(e=>{t.appendChild(e)}):"object"==r&&t.appendChild($(e))}),e>=this.length?a.appendChild(t):a.insertBefore(t,a.children[e])}return b(this,{xid:this.xid,name:"splice",args:[e,t,...r]}),o},sort(e){const t=this.ele,r=Array.from(t.children).map(A).sort(e);return U(t,r),b(this,{xid:this.xid,name:"sort"}),this},reverse(){const e=this.ele,t=Array.from(e.children).reverse();return U(e,t),b(this,{xid:this.xid,name:"reverse"}),this}});const U=(e,t)=>{const{children:r}=e;t.forEach((t,s)=>{let a=t.ele||t;const n=r[s];n?a!==n&&e.insertBefore(a,n):e.appendChild(a)})},K=e=>e[D]?e[D]:e[D]=new Map,z=e.MouseEvent||Event,W=e.TouchEvent||Event,B=new Map([["click",z],["mousedown",z],["mouseup",z],["mousemove",z],["mouseenter",z],["mouseleave",z],["touchstart",W],["touchend",W],["touchmove",W]]),Z=(e,t,r,s=!0)=>{let a=B.get(t)||CustomEvent;const n=t instanceof Event?t:new a(t,{bubbles:s,cancelable:!0});return n.data=r,e.ele.dispatchEvent(n)};u(R.prototype,{on(e,r,s){if(a(r))s=r,r=void 0;else{const e=s,{ele:t}=this;s=(s=>{let a;s.path?a=s.path:(a=A(s.target).parents(null,t).map(e=>e.ele)).unshift(s.target),a.some(a=>{if(a==t)return!0;A(a).is(r)&&(s.selector=a,e(s),delete s.selector)})})}this.ele.addEventListener(e,s);const n="e_"+t();return K(this).set(n,{name:e,selector:r,callback:s}),n},off(e){let t=K(this).get(e);return!!t&&(this.ele.removeEventListener(t.name,t.callback),this[D].delete(e),!0)},one(e,t,r){let s,a;return"string"==typeof t?(a=r,r=(e=>{a(e),this.off(s)})):(a=t,t=(e=>{a(e),this.off(s)})),s=this.on(e,t,r)},trigger(e,t){return Z(this,e,t)},triggerHandler(e,t){return Z(this,e,t,!1)}}),["click","focus","blur"].forEach(e=>{u(R.prototype,{[e](t){if(!a(t))return this.trigger(e,t);this.on(e,t)}})});const V={},G={},Q=async({xele:e,defs:t,temps:r,_this:s})=>{if(Object.assign(e,t.data,t.attrs),t.created&&t.created.call(e),t.temp){const a=s.attachShadow({mode:"open"});a.innerHTML=t.temp,ye({host:e,xdata:e,content:a,temps:r}),e.shadow&&e.shadow.watchTick(t=>{t.some(e=>e.path.length>1)&&b(e,{xid:e.xid,name:"forceUpdate"})},10);const n=a.querySelectorAll("link");n&&n.length&&await Promise.all(Array.from(n).map(t=>new Promise((r,s)=>{if(t.sheet)r();else{let a,n;t.addEventListener("load",a=(e=>{t.removeEventListener("load",a),t.removeEventListener("error",n),r()})),t.addEventListener("error",n=(r=>{t.removeEventListener("load",a),t.removeEventListener("error",n),s({desc:"link load error",ele:t,target:e.ele})}))}})))}if(t.ready&&t.ready.call(e),!n(t.attrs)){const{ele:r}=e;Object.keys(t.attrs).forEach(t=>{r.hasAttribute(t)&&(e[t]=r.getAttribute(t))}),e.watchTick(r=>{s.__set_attr=1,Object.keys(t.attrs).forEach(t=>{let r=e[t];null===r||void 0===r?s.removeAttribute(T(t)):s.setAttribute(T(t),e[t])}),delete s.__set_attr})}let a=t.watch;n(a)||e.watchKey(a,!0)},X=Symbol("runned_revoke"),Y=e=>{const t={tag:"",temp:"",attrs:{},data:{},watch:{},proto:{}};let r;if(Object.assign(t,e),t.temp){const e=te(t.temp,t.tag);t.temp=e.html,r=e.temps}let s=L(e.tag);const a=class extends R{constructor(e){super(e),e.isCustom=!0}forceUpdate(){b(this,{xid:this.xid,name:"forceUpdate"})}revoke(){this[X]||(this[X]=1,Object.values(this).forEach(e=>{e instanceof R||!l(e)||_(e,this[p])}),fe(this.shadow.ele))}};u(a.prototype,t.proto);const n=ee(t);o(a.prototype,{[I]:{writable:!0,value:new Set([...H,...n])}});customElements.define(t.tag,class extends HTMLElement{constructor(...e){super(...e),this.__xEle__=new a(this);const s=A(this);Q({xele:s,defs:t,temps:r,_this:this}).then(e=>{this.__x_connected?this.setAttribute("x-render",1):this.x_render=1})}connectedCallback(){this.x_render&&this.setAttribute("x-render",this.x_render),this.__x_connected=!0,t.attached&&!this.__x_runned_connected&&h(()=>{this.__x_connected&&!this.__x_runned_connected&&(this.__x_runned_connected=!0,t.attached.call(A(this)))})}disconnectedCallback(){this.__x_connected=!1,t.detached&&!this.__x_runnded_disconnected&&h(()=>{this.__x_connected||this.__x_runnded_disconnected||(this.__x_runnded_disconnected=!0,t.detached.call(A(this)))})}attributeChangedCallback(e,t,r){this.__set_attr||(A(this)[L(e)]=r)}static get observedAttributes(){return Object.keys(t.attrs).map(e=>T(e))}}),G[s]?(G[s](a),delete G[s]):V[s]=Promise.resolve(a)},ee=e=>{const{attrs:t,data:r,watch:s,proto:a}=e,n=[...Object.keys(t),...Object.keys(r),...Object.keys(s)],o=Object.getOwnPropertyDescriptors(a);return Object.keys(o).forEach(e=>{let{set:t}=o[e];t&&n.push(e)}),n},te=(e,t)=>{var r=(e=e.replace(/<!--.+?-->/g,"")).match(/{{.+?}}/g);r&&r.forEach(t=>{var r=/{{(.+?)}}/.exec(t);r&&(e=e.replace(t,`<x-span prop="${encodeURI(r[1])}"></x-span>`))});const s=document.createElement("template");s.innerHTML=e;let a=[],n=[];Array.from(s.content.querySelectorAll("*")).forEach(e=>{const t={},r=[];Array.from(e.attributes).forEach(s=>{let o,i,{name:l,value:c}=s,h=/^temp:(.+)/.exec(l);if(h){let[,t]=h,r=document.createElement("template");return r.setAttribute("name",t),e.removeAttribute(l),r.innerHTML=e.outerHTML,a.push(r),n.push(e),!0}if(/^#/.test(l))o="cmd",i=l.replace(/^#/,"");else if(/^@/.test(l))o="on",i=l.replace(/^@/,"");else if(l.includes(":")){let t=l.split(":");if(2!=t.length)throw{desc:"template binding mark error",target:e,expr:l};o=t[0],i=t[1],""===o&&(o="prop")}if(o){let e=t[o]||(t[o]={});"on"==o?e[i]={name:c}:i&&(e[i]=c),r.push(l)}}),r.length&&(Object.keys(t).forEach(r=>{let s=t[r];"cmd"==r?Object.keys(s).forEach(t=>{e.setAttribute(`x-cmd-${t}`,s[t])}):e.setAttribute(`x-${r}`,JSON.stringify(s))}),r.forEach(t=>e.removeAttribute(t)))}),a.length&&(a.forEach(e=>{s.content.appendChild(e)}),n.forEach(e=>{s.content.removeChild(e)})),Array.from(s.content.querySelectorAll("template")).forEach(e=>{e.innerHTML=te(e.innerHTML).html}),re(s);let o=new Map;if(Array.from(s.content.querySelectorAll("template[name]")).forEach(e=>{o.set(e.getAttribute("name"),{ele:e,code:e.content.children[0].outerHTML}),e.parentNode.removeChild(e)}),o.size)for(let[e,r]of o.entries()){const{children:s}=r.ele.content;if(1!==s.length)throw{name:e,html:r.code,tag:t,desc:"register error, only one element must exist in the template"};if(s[0].getAttribute("x-cmd-if"))throw{name:e,html:r.code,tag:t,desc:"register error, cannot use if on template first element"}}return{temps:o,html:s.innerHTML}},re=e=>{e.content.querySelectorAll("[x-cmd-if],[x-cmd-else-if],[x-cmd-else],[x-cmd-await],[x-cmd-then],[x-cmd-catch]").forEach(e=>{if("template"==e.tagName.toLowerCase())return;let t=document.createElement("template");["x-cmd-if","x-cmd-else-if","x-cmd-else","x-cmd-await","x-cmd-then","x-cmd-catch"].forEach(r=>{let s=e.getAttribute(r);null!==s&&(t.setAttribute(r,s),e.removeAttribute(r))}),e.parentNode.insertBefore(t,e),t.content.appendChild(e)}),Array.from(e.content.querySelectorAll("template")).forEach(re)},se=(e,t)=>{let r=Array.from(e.querySelectorAll(t));return e instanceof Element&&j(e,t)&&r.push(e),r},ae=e=>{let t=new Comment("x-marker"),r=e.parentNode;return r.insertBefore(t,e),r.removeChild(e),{marker:t,parent:r}},ne=e=>new Function("...$args",`\nconst [$e,$target] = $args;\n\ntry{\n    with(this){\n        ${e};\n    }\n}catch(e){\n    throw {\n        message:e.message || "run error",\n        expr:\`${e.replace(/`/g,"\\`")}\`,\n        target:this,\n        error:e\n    };\n}`),oe=(e,t,r)=>{e.removeAttribute(t);let s=e.__renderData;s||(s=e.__renderData={},e.setAttribute("x-rendered","")),s[t]=r},ie=(e,t,r)=>{let s=e.watchTick(t);r.push({eid:s,target:e})},le=(e,t)=>{let r;return r=ue.test(e)?ne("return "+e).bind(t):()=>C(t,e)},ce=({xdata:e,host:t,expr:r,watchFun:s})=>{const a=[];return e instanceof R?ie(e,s,a):r.includes("$host")?(r.includes("$index")&&ie(e,s,a),ie(t,s,a)):r.includes("$index")||r.includes("$item")?(ie(e,s,a),l(e.$data)&&ie(e.$data,s,a)):r.includes("$data")&&l(e.$data)&&ie(e.$data,s,a),a},he=({xdata:e,host:t,expr:r,callback:s,isArray:a})=>{let n,o,i,c=le(r,e);const h=e=>{const t=c();if(l(t))if(a){let r=t.map(e=>e&&e.xid?e.xid:e).join(",");o!==r&&(s({val:t,modifys:e}),o=r)}else{let r=t.toJSON();n===t&&r===i||(s({val:t,modifys:e}),i=r)}else n!==t&&(s({val:t,modifys:e}),i=null);n=t};return h(),ce({xdata:e,host:t,expr:r,watchFun:h})},de=(e,t)=>{(e.__bindings||(e.__bindings=[])).push(...t)},ue=/[\(\)\;\=\>\<\|\!\?\+\-\*\/\&\|\{\}`]/,pe=(e,t)=>{Array.from(e.childNodes).forEach(e=>{t(e),e instanceof Element&&pe(e,t)})},fe=e=>{pe(e,e=>{e.isCustom&&A(e).revoke(),e.__bindings&&e.__bindings.forEach(e=>{let{target:t,eid:r}=e;t.unwatch(r)})})},me=({temp:e,temps:t,marker:r,parent:s,host:a,xdata:n})=>{let o=S(e.innerHTML);return o.forEach(e=>{s.insertBefore(e,r),ye({host:a,xdata:n,content:e,temps:t})}),o},ge=e=>{e.forEach(e=>{fe(e),e.parentNode.removeChild(e)})},ye=({host:e,xdata:t,content:r,temps:s})=>{se(r,"[x-on]").forEach(r=>{let s=JSON.parse(r.getAttribute("x-on")),n=[];const o=A(r);Object.keys(s).forEach(r=>{let i,{name:l}=s[r];if(ue.test(l)){const e=ne(l);i=o.on(r,r=>{e.call(t,r,o)})}else i=o.on(r,r=>{const s=C(t,l);s?a(s)?s.call(e,r):console.error({target:t,host:e,name:l,value:s,desc:"bind value is not function"}):console.error({target:t,host:e,name:l,desc:"no binding function"})});n.push(i)}),oe(r,"x-on",s)}),se(r,"[x-attr]").forEach(r=>{const s=JSON.parse(r.getAttribute("x-attr"));oe(r,"x-attr",s),Object.keys(s).forEach(a=>{const n=he({xdata:t,host:e,expr:s[a],callback:({val:e})=>{null===e||void 0===e?r.removeAttribute(a):r.setAttribute(a,e)}});de(r,n)})}),se(r,"[x-class]").forEach(r=>{const s=JSON.parse(r.getAttribute("x-class"));oe(r,"x-class",s),Object.keys(s).forEach(a=>{const n=he({xdata:t,host:e,expr:s[a],callback:({val:e})=>{e?r.classList.add(a):r.classList.remove(a)}});de(r,n)})}),se(r,"[x-prop]").forEach(r=>{const s=JSON.parse(r.getAttribute("x-prop")),a=A(r);oe(r,"x-prop",s),Object.keys(s).forEach(n=>{const o=he({xdata:t,host:e,expr:s[n],callback:({val:t})=>{n=L(n);try{a[n]=t}catch(t){throw{target:r,host:e.ele,desc:`failed to set property ${n} (:${n} or prop:${n}), did you want to use attr:${n}?`,error:t}}}});de(r,o)})}),se(r,"[x-sync]").forEach(r=>{const s=JSON.parse(r.getAttribute("x-sync")),a=A(r);Object.keys(s).forEach(n=>{let o=s[n];if(ue.test(o))throw{desc:"sync only accepts attribute names"};const i=he({xdata:t,host:e,expr:o,callback:({val:e})=>{P(a,n,e)}}),l=he({xdata:a,host:e,expr:n,callback:({val:e})=>{P(t,o,e)}});de(r,[...i,...l])})}),se(r,"x-span").forEach(r=>{let s=decodeURI(r.getAttribute("prop")),{marker:a,parent:n}=ae(r);const o=document.createTextNode("");n.replaceChild(o,a);const i=he({xdata:t,host:e,expr:s,callback:({val:e})=>{o.textContent=e}});de(o,i)}),se(r,"[x-cmd-if]").forEach(r=>{const a=[r];let{nextElementSibling:n}=r;for(;n&&(n.hasAttribute("x-cmd-else-if")||n.hasAttribute("x-cmd-else"));)n.parentNode.removeChild(n),a.push(n),n=r.nextElementSibling;let o="";const i=a.map((e,r)=>{let s;const a=e.getAttribute("x-cmd-else-if")||e.getAttribute("x-cmd-if");return a&&(s=le(a,t),o+=`${0==r?"if":"else-if"}(${a})...`),{callback:s,tempEle:e}});let{marker:l,parent:c}=ae(r),h=null,d=-1;const u=r=>{let a,n,o=-1;i.some((e,t)=>{if(e.callback){if(n=!!e.callback())return a=e.tempEle,o=t,!0}else a=e.tempEle,o=t}),d!==o&&(h&&(fe(h),h.parentNode.removeChild(h),h=null),a&&(h=S(a.content.children[0].outerHTML)[0],c.insertBefore(h,l),ye({host:e,xdata:t,content:h,temps:s}))),d=o};u(),de(l,ce({xdata:t,host:e,expr:o,watchFun:u}))}),se(r,"[x-cmd-await]").forEach(r=>{let a,n,o=r,{nextElementSibling:i}=r;for(;i&&(i.hasAttribute("x-cmd-then")||i.hasAttribute("x-cmd-catch"));)i.hasAttribute("x-cmd-then")?a=i:i.hasAttribute("x-cmd-catch")&&(n=i),i.parentNode.removeChild(i),i=r.nextElementSibling;let l,c,{marker:h,parent:d}=ae(r),u=r.getAttribute("x-cmd-await");const p=he({xdata:t,host:e,expr:u,callback:({val:r})=>{c&&(ge(c),c=null),c=me({temp:o,temps:s,marker:h,parent:d,host:e,xdata:t}),l=r,r.then(t=>{l===r&&(ge(c),c=null,a&&(c=me({temp:a,temps:s,marker:h,parent:d,host:e,xdata:{[a.getAttribute("x-cmd-then")]:t,$host:e}})))}).catch(t=>{l===r&&(ge(c),c=null,n&&(c=me({temp:n,temps:s,marker:h,parent:d,host:e,xdata:{[n.getAttribute("x-cmd-catch")]:t,$host:e}})))})}});de(h,p)}),se(r,"[x-fill]").forEach(r=>{const a=JSON.parse(r.getAttribute("x-fill"));let n=r.getAttribute("x-item");n&&(n=JSON.parse(n));const o=r;A(o)._unupdate=1;let i,[l,c]=Object.entries(a)[0];oe(r,"x-fill",a),oe(r,"x-item",n);const h=he({xdata:t,host:e,expr:c,isArray:1,callback:r=>{const a=r.val;let c=s.get(l);if(!c)throw{target:e.ele,desc:"this template was not found",name:l};if(i){const r=Array.from(o.children),i=r.map(e=>e.__fill_item.$data),l=Symbol("holder"),h=[];a.forEach((a,o)=>{let d=i.indexOf(a);if(-1===d){let r=xe({host:e,data:a,index:o,tempData:c,temps:s});n&&be(r,n,t,e),h.push(r.ele)}else{let e=r[d];e.__fill_item.$index=o,h.push(e),i[d]=l}});const d=[];i.forEach((e,t)=>{if(e!==l){let e=r[t];d.push(e),o.removeChild(e)}}),d.forEach(e=>fe(e)),U(o,h)}else a.forEach((r,a)=>{const i=xe({host:e,data:r,index:a,tempData:c,temps:s});n&&be(i,n,t,e),o.appendChild(i.ele)}),i=a.xid}});de(r,h)})},be=(e,t,r,s)=>{let a=e.$item;Object.keys(t).forEach(n=>{let o=t[n];const i=L(n);let l=he({xdata:r,host:s,expr:o,callback:({val:e})=>{a[i]=e}});de(e.ele,l)})},xe=({host:e,data:t,index:r,tempData:s,temps:a})=>{const n=A(S(s.code)[0]),i=E({get $host(){return e},$index:r,get $data(){return t},get $item(){return i}});return o(n,{$item:{get:()=>i},$data:{get:()=>t}}),n.ele.__fill_item=i,ye({host:e,xdata:i,content:n.ele,temps:a}),n};function we(e){if(e instanceof Element)return A(e);const t=s(e);let r;return"string"==t?r=/\<.+\>/.test(e)?S(e)[0]:document.querySelector(e):"object"==t?r=$(e):(e===document||e instanceof DocumentFragment)&&(r=e),r?A(r):null}Object.assign(we,{all:e=>Array.from(document.querySelectorAll(e)).map(e=>A(e)),register:Y,xdata:e=>E(e),nextTick:h,fn:R.prototype,tag:e=>{if(e=L(e),V[e])return V[e];let t=new Promise(t=>{G[e]=t});return V[e]=t,t}}),(e=>{const t=()=>Math.random().toString(32).substr(2),r=Object.prototype.toString,s=e=>(e=>r.call(e).toLowerCase().replace(/(\[object )|(])/g,""))(e).search("function")>-1,{defineProperties:a}=Object,n=(()=>{const e=e=>Promise.resolve().then(()=>e());return"object"==typeof process&&process.nextTick&&(e=process.nextTick),e})(),o=new Map,i=(t,r)=>{o.set(t,r),a(e,{[t]:{value:e=>{let s=document.currentScript.src,a=p(s);a||(a=new f(s),u(s,a)),a.status=1,a.ptype=t,r({respone:e,record:a,relativeLoad(...e){let t=new E(...e);return t.__relative__=s,t}})}}})};i("define",async({respone:e,record:t,relativeLoad:r})=>{let a;if(s(e)){const s={};let n=await e({load:r,FILE:t.src,exports:s});void 0!==n||(e=>!(0 in Object.keys(e)))(s)||(n=s),a=(e=>n)}else a=(t=>e);t.done(a)}),i("task",async({respone:e,record:t,relativeLoad:r})=>{if(!s(e))throw"task must be a function";t.done(async s=>await e({data:s.data,load:r,FILE:t.src}))});const l=new Map,c=(e,t)=>{l.set(e,r=>{const s=p(r);return s.type=e,t({src:r,record:s})})};c("js",({src:e,record:t})=>new Promise((r,s)=>{let a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=e,t.sourceElement=a,a.addEventListener("load",async()=>{t.loadedTime=Date.now(),0==t.status&&(t.ptype="script",t.done(e=>{})),r()}),a.addEventListener("error",e=>{s({desc:"load script error",event:e})}),document.head.appendChild(a)})),c("mjs",async({src:e,record:t})=>{let r=await import(e);t.done(()=>r)}),c("wasm",async({src:e,record:t})=>{let r=await fetch(e).then(e=>e.arrayBuffer()),s=await WebAssembly.compile(r);const a=new WebAssembly.Instance(s);t.done(()=>a.exports)}),c("json",async({src:e,record:t})=>{let r=await fetch(e);r=await r.json(),t.done(()=>r)}),c("css",async({src:e,record:t})=>{let r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=e,t.sourceElement=r;let s=!1;t.done(async e=>{if(e.params.includes("-unpull"))return r;s||(document.head.appendChild(r),s=!0),r.sheet||await new Promise(e=>{r.addEventListener("load",t=>{e()})})})}),["html"].forEach(e=>{c(e,async({src:e,record:t})=>{let r=await fetch(e).then(e=>e.text());t.done(()=>r)})});const h=async({src:e,record:t})=>{let r=await fetch(e);if(!r.ok)throw{desc:"fetch "+r.statusText,response:r};t.done(()=>r)},d=new Map,u=(e,t)=>{let r=new URL(e);d.set(r.origin+r.pathname,t)},p=e=>{let t=new URL(e);return d.get(t.origin+t.pathname)};class f{constructor(e){this.src=e,this.status=0,this.bid="b_"+t(),this.data=new Promise((e,t)=>{this.__resolve=e,this.__reject=t}),this.startTime=Date.now()}done(e){this.status=2,this.__resolve(e),delete this.__resolve,delete this.__reject,this.doneTime=Date.now()}fail(e){this.status=-1,this.__reject(data),delete this.__resolve,delete this.__reject,this.doneTime=Date.now()}}const m={};const g=new Map;class y{constructor(e,t){let[r,...s]=e.split(" ");this.url=r,this.params=s,this.bag=t}get src(){let{url:e}=this;if(/^@.+/.test(e))for(let[t,r]of g)if(t.test(e)){e=e.replace(t,r);break}if(this.params.includes("-p")){e+=`/${e.replace(/.+\/(.+)/,"$1")}.js`}return new URL(e,this.relative).href}get ftype(){let e=new URL(this.src).pathname.replace(/.+\.(.+)/,"$1");return this.params.some(t=>{if(/^:(.+)/.test(t))return e=t.replace(/^:(.+)/,"$1"),!0}),e}get data(){return this.bag[_]}get relative(){return this.bag.__relative__||location.href}}function b(e){e.args.forEach(t=>e.result.push(void 0));let t=0,r=!1,{result:s}=e;const a=e[v];e.args.forEach((n,o)=>{let i=new y(n,e),c=n=>{s[o]=n,t++,a&&a({index:o,pkg:i,data:n}),1===e.args.length?e[x](n):t!==e.args.length||r||e[x](s),c=null};i.params.includes("-link")?c(i.src):i.params.includes("-pkg")?c(i):async function(e){let t=p(e.src);if(t){if(-1==t.status)throw{expr:e.url,src:t.src};const r=await t.data;return await r(e)}t=new f(e.src),u(e.src,t);let r=l.get(e.ftype);try{r?await r(t.src):(m[e.ftype]||(console.warn({desc:"did not find this loader",type:e.ftype}),m[e.ftype]=1),await h({src:t.src,record:t}))}catch(e){t.fail(e)}const s=await t.data;return await s(e)}(i).then(c).catch(t=>{r=!0,t&&console.error({expr:n,src:i.src,...t}),s[o]=t,e[w]({expr:n,src:i.src,error:t}),c=null})})}const x=Symbol("resolve"),w=Symbol("reject"),_=Symbol("postData"),v=Symbol("pendFunc");class E extends Promise{constructor(...e){if(s(e[0]))return super(...e),this;let r,o;super((e,t)=>{r=e,o=t}),this.id="d_"+t(),a(this,{[x]:{value:r},[w]:{value:o},args:{value:e},result:{value:[]},__relative__:{writable:!0,value:""}}),n(()=>b(this))}pend(e){if(this[v])throw{desc:"pend has been used",target:this};return a(this,{[v]:{value:e}}),this}post(e){if(this[_])throw{desc:"post has been used",target:this};return a(this,{[_]:{value:e}}),this}}const k=e.load=((...e)=>new E(...e));a(e,{drill:{value:{load:k,config:e=>{let{paths:t}=e;t&&Object.keys(t).forEach(e=>{let r=t[e];if(!/^@.+\/$/.test(e))throw{desc:"incorrect definition of paths",key:e};if(!/.+\/$/.test(e))throw{desc:"incorrect definition of paths",key:e,path:r};g.set(new RegExp("^"+e),r)})},async has(e){let t=await k(`${e} -link`);return!!p(t)},async remove(e){let t=await k(`${e} -link`),r=p(t).sourceElement;r&&r.parentNode.removeChild(r),d.delete(t)},ext(e){e({bag:d,addLoader:c,addProcess:i})},bag:d,version:"4.0.0",v:4e6}}})})("undefined"!=typeof globalThis?globalThis:window),drill.ext(({addProcess:e})=>{e("Component",async({respone:e,record:t,relativeLoad:r})=>{let s=e;a(e)&&(s=await e({load:r,FILE:t.src}));const n=await _e(t,r,s);Y(n),t.done(async e=>{})})});const _e=async(e,t,r)=>{const s={temp:"",data:{},attrs:{},proto:{},watch:{}};Object.assign(s,r);let a=new URL(e.src).pathname.replace(/.*\/(.+)/,"$1").replace(/\.js$/,"");if(s.tag||(s.tag=a),""===s.temp){let e=await t(`./${a}.html`);s.temp=await ve(e,t)}return s},ve=async(e,t)=>{let r=document.createElement("template");r.innerHTML=e;let s=r.content.querySelectorAll("[href]"),a=r.content.querySelectorAll("[src]"),n=r.content.querySelectorAll('[style*="url("]');const o=[];s&&Array.from(s).forEach(e=>{o.push((async()=>{let r=await t(`${e.getAttribute("href")} -link`);e.setAttribute("href",r)})())}),a&&Array.from(a).forEach(e=>{o.push((async()=>{let r=await t(`${e.getAttribute("src")} -link`);e.setAttribute("src",r)})())}),n&&Array.from(n).forEach(e=>{o.push((async()=>{e.setAttribute("style",await Ee(e.getAttribute("style"),t))})())});let i=r.content.querySelectorAll("style");return i&&Array.from(i).forEach(e=>{o.push((async()=>{e.innerHTML=await Ee(e.innerHTML,t)})())}),await Promise.all(o),r.innerHTML},Ee=async(e,t)=>{let r=e.match(/url\(.+?\)/g);return r&&await Promise.all(r.map(async r=>{let s=r.replace(/url\((.+?)\)/,"$1"),a=await t(`${s} -link`);e=e.replace(r,`url(${a})`)})),e};drill.ext(({addProcess:e})=>{e("Page",async({respone:e,record:t,relativeLoad:r})=>{let s=e;a(e)&&(s=await e({load:r,FILE:t.src}));const n=await _e(t,r,s);let o=te(n.temp);n.temp=o.html;const i=ee(n);t.done(async e=>({defaults:n,cansetKeys:i,temps:o.temps}))})});const ke=Symbol("page_status"),Ae=e=>{if(e.parent.is("o-app"))return e;for(;e.host;)if((e=e.host).is("o-page")&&e.parent.is("o-app"))return e};Y({tag:"o-page",attrs:{src:null,[ke]:"empty"},proto:{get status(){return this[ke]},get app(){let e=Ae(this);return e?e.parent:(console.warn({desc:"cannot find the app",target:this}),null)},get query(){const e=new URLSearchParams(this.src.replace(/.+(\?.+)/,"$1"));let t={};for(const[r,s]of e.entries())t[r]=s;return t},navigateTo(e){let t=Ae(this);if(!t)throw{desc:"cannot use navigateTo without in app",target:this};const{router:r}=this.app;let s=r.findIndex(e=>e._page==t);r.splice(s+1,r.length,e)},replaceTo(e){let t=Ae(this);if(!t)throw{desc:"cannot use replaceTo without in app",target:this};const{router:r}=this.app;let s=r.findIndex(e=>e._page==t);r.splice(s,r.length,e)},back(){let{app:e}=this;e&&e.back()}},watch:{async src(t){if(!t)return;if("empty"!==this[ke])throw{desc:"src can only be set once",target:this};let r;this[ke]="loading",this._waiting&&await this._waiting;try{let s=await load(t);this._realsrc=await load(t+" -link");const a=new Set([...Array.from(this[I]),...s.cansetKeys]);a.delete("src"),this[I]=a,r=s.defaults,u(this,r.proto),Q({xele:this,defs:Object.assign({},r,{attrs:{}}),temps:s.temps,_this:this.ele}).then(e=>{this.ele.x_render=2,this.attr("x-render",2)})}catch(t){return void(e.ofa&&(this.html=Se.onState.loadError(t),this[ke]="error"))}this[ke]="loaded",b(this,{xid:this.xid,name:"setData",args:["status",this[ke]]}),r.attached&&this.__attached_pms.then(()=>r.attached.call(this)),r.detached&&this.__detached_pms.then(()=>r.detached.call(this))}},created(){this.__attached_pms=new Promise(e=>this.__attached_resolve=e),this.__detached_pms=new Promise(e=>this.__detached_resolve=e)},attached(){this.__attached_resolve()},detached(){this.__detached_resolve()}});Symbol("router_page");const Oe=[];Y({tag:"o-app",temp:'<style>:host{display:block}::slotted(o-page){position:absolute;left:0;top:0;width:100%;height:100%}::slotted(o-page[page-area]){transform:translate(0,0);transition:all ease-in-out .25s;z-index:2}::slotted(o-page[page-area=back]){transform:translate(-30%,0);opacity:0;z-index:1}::slotted(o-page[page-area=next]){transform:translate(30%,0);opacity:0;z-index:1}.container{display:flex;flex-direction:column;width:100%;height:100%}.main{position:relative;flex:1}.article{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}</style><style id="initStyle">::slotted(o-page[page-area]){transition:none}</style><div class="container"><div><slot name="header"></slot></div><div class="main"><div class="article" part="body"><slot></slot></div></div></div>',attrs:{home:"",src:""},data:{router:[],visibility:document.hidden?0:1},watch:{async src(e){if(!e||this._loaded_src)return;this._loaded_src=1;let t=await load(e);t.data&&Object.assign(this,t.data),t.proto&&this.extend(t.proto),t.ready&&t.ready.call(this),this.home&&!this.router.length&&this.router.push({path:this.home})},home(e){this.src||!e||this.router.length||this.router.push({path:e})},router(t){if(!t.length)return;let r=this._backup_router;r||(r=this._backup_router=[]);const s=r.filter(e=>!t.includes(e)),a=[];let n=t.length-1;const o=t.map((s,o)=>{if("string"==typeof s&&(s=E({path:s})).owner.add(t[p]),!s._page){let t,r=s._page=we({tag:"o-page",src:s.path});e.ofa&&Se.onState.loading&&r.push(Se.onState.loading({src:s.path})),r._waiting=new Promise(e=>t=e),r.__waiter_resolve=t}if(s.state&&void 0===s._page.state){let e=s.state;u(s._page,{get state(){return e}})}return r.includes(s)||a.push(s),o<n?s._page.attr("page-area","back"):o==n&&(null===s._page.attr("page-area")?(s._page.attr("page-area","next"),setTimeout(()=>{"next"===s._page.attr("page-area")&&s._page.attr("page-area","")},10)):s._page.attr("page-area","")),o+2>n&&s._page.__waiter_resolve&&(s._page.__waiter_resolve(),delete s._page.__waiter_resolve),s});a.forEach(e=>{this.push(e._page)}),s.forEach(e=>{if(e._page.attr("page-area","next"),parseFloat(e._page.css.transitionDuration)>0){let t=setTimeout(()=>e._page.remove(),500);e._page.one("transitionend",()=>{e._page.remove(),clearTimeout(t)})}else e._page.remove()}),t[p].splice(0,1e3,...o),this._backup_router=t.slice(),t.slice(-1)[0]._page.trigger("activepage")}},proto:{get currentPage(){return this.router.slice(-1)[0]._page},back(){const e=new Event("back",{cancelable:!0});e.delta=1,this.triggerHandler(e),e.returnValue&&this.router.length>1&&this.router.splice(-1,1)},postback(e){let t;if(top!==window)t=top;else{if(!opener)return console.warn("can't use postback"),!1;t=opener}return t.postMessage({type:"web-app-postback-data",data:e},"*"),!0}},ready(){window.addEventListener("visibilitychange",e=>{this.visibility=document.hidden?0:1}),setTimeout(()=>{this.shadow.$("#initStyle").remove()},150)},attached(){Oe.push(this)},detached(){let e=Oe.indexOf(this);e>-1&&Oe.splice(e,1)}}),we.fn.extend({get page(){let e=this;for(;e&&!e.is("o-page");)e=e.host;return e}});let je=e.ofa;const Se={v:3000009,version:"3.0.9",get config(){return drill.config},onState:{loading:e=>'<div style="display:flex;justify-content:center;align-items:center;width:100%;height:100%;font-size:14px;color:#aaa;">Loading</div>',loadError:e=>`<div style="text-align:center;"><h2>load Error</h2><div style="color:#aaa;">error expr:${e.expr} <br>error src:${e.src}</div></div>`},get apps(){return Oe.slice()}};o(e,{ofa:{set(e){e(Se)},get:()=>Se}}),je&&je(Se),drill.config({paths:{"@lib/":"https://cdn.jsdelivr.net/gh/kirakiray/ofa.js/lib/"}}),e.$=we})(window);