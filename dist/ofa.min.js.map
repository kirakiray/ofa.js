{"version":3,"file":"ofa.min.js","sources":["../packages/ofa-error/main.js","../packages/stanz/public.mjs","../packages/xhear/public.mjs","../packages/stanz/watch.mjs","../packages/stanz/array.mjs","../packages/stanz/main.mjs","../packages/stanz/accessor.mjs","../packages/xhear/accessor.mjs","../packages/xhear/render/render.mjs","../packages/xhear/render/sync.mjs","../packages/xhear/event.mjs","../packages/xhear/array.mjs","../packages/stanz/base.mjs","../packages/xhear/form.mjs","../packages/xhear/css.mjs","../packages/xhear/register.mjs","../packages/xhear/render/fake-node.mjs","../packages/xhear/render/condition.mjs","../packages/xhear/render/fill.mjs","../packages/xhear/main.mjs","../packages/xhear/util.mjs","../packages/xhear/dollar.mjs","../packages/ofa/inject-host.mjs","../packages/xhear/base.mjs","../packages/drill.js/onion.mjs","../packages/drill.js/use.mjs","../packages/drill.js/config.mjs","../packages/drill.js/main.mjs","../packages/drill.js/component.mjs","../packages/drill.js/base.mjs","../packages/ofa/public.mjs","../packages/ofa/link.mjs","../packages/ofa/draw-template.mjs","../packages/ofa/page.mjs","../packages/ofa/comp.mjs","../packages/ofa/app.mjs","../packages/ofa/extend.mjs","../packages/ofa/context.mjs","../packages/ofa/main.mjs"],"sourcesContent":["// const error_origin = \"http://127.0.0.1:5793/errors\";\nconst error_origin = \"https://ofajs.github.io/ofa-errors/errors\";\n\n// 存放错误信息的数据对象\nconst errors = {};\n\nif (globalThis.navigator && navigator.language) {\n  let langFirst = navigator.language.toLowerCase().split(\"-\")[0];\n\n  if (langFirst === \"zh\" && navigator.language.toLowerCase() !== \"zh-cn\") {\n    langFirst = \"zhft\";\n  }\n\n  (async () => {\n    if (localStorage[\"ofa-errors\"]) {\n      const targetLangErrors = JSON.parse(localStorage[\"ofa-errors\"]);\n      Object.assign(errors, targetLangErrors);\n    }\n\n    const errCacheTime = localStorage[\"ofa-errors-time\"];\n\n    if (!errCacheTime || Date.now() > Number(errCacheTime) + 5 * 60 * 1000) {\n      const targetLangErrors = await fetch(`${error_origin}/${langFirst}.json`)\n        .then((e) => e.json())\n        .catch(() => null);\n\n      if (targetLangErrors) {\n        localStorage[\"ofa-errors\"] = JSON.stringify(targetLangErrors);\n        localStorage[\"ofa-errors-time\"] = Date.now();\n      } else {\n        targetLangErrors = await fetch(`${error_origin}/en.json`)\n          .then((e) => e.json())\n          .catch((error) => {\n            console.error(error);\n            return null;\n          });\n      }\n\n      Object.assign(errors, targetLangErrors);\n    }\n  })();\n}\n\nlet isSafari = false;\nif (globalThis.navigator) {\n  isSafari =\n    navigator.userAgent.includes(\"Safari\") &&\n    !navigator.userAgent.includes(\"Chrome\");\n}\n\n/**\n * 根据键、选项和错误对象生成错误对象。\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @param {Error} [error] - 原始错误对象。\n * @returns {Error} 生成的错误对象。\n */\nexport const getErr = (key, options, error) => {\n  let desc = getErrDesc(key, options);\n\n  let errObj;\n  if (error) {\n    if (isSafari) {\n      desc += `\\nCaused by: ${error.toString()}\\n  ${error.stack.replace(\n        /\\n/g,\n        \"\\n    \"\n      )}`;\n    }\n    errObj = new Error(desc, { cause: error });\n  } else {\n    errObj = new Error(desc);\n  }\n  return errObj;\n};\n\n/**\n * 根据键、选项生成错误描述\n *\n * @param {string} key - 错误描述的键。\n * @param {Object} [options] - 映射相关值的选项对象。\n * @returns {string} 生成的错误描述。\n */\nexport const getErrDesc = (key, options) => {\n  if (!errors[key]) {\n    return `Error code: \"${key}\", please go to https://github.com/ofajs/ofa-errors to view the corresponding error information`;\n  }\n\n  let desc = errors[key];\n\n  // 映射相关值\n  if (options) {\n    for (let k in options) {\n      desc = desc.replace(new RegExp(`{${k}}`, \"g\"), options[k]);\n    }\n  }\n\n  return desc;\n};\n","import { getErr, getErrDesc } from \"../ofa-error/main.js\";\n\nexport const getRandomId = () => Math.random().toString(32).slice(2);\n\nconst objectToString = Object.prototype.toString;\nexport const getType = (value) =>\n  objectToString\n    .call(value)\n    .toLowerCase()\n    .replace(/(\\[object )|(])/g, \"\");\n\nexport const isObject = (obj) => {\n  const type = getType(obj);\n  return type === \"array\" || type === \"object\";\n};\n\nexport const isDebug = {\n  value: null,\n};\n\nif (typeof document !== \"undefined\") {\n  if (document.currentScript) {\n    isDebug.value = document.currentScript.attributes.hasOwnProperty(\"debug\");\n  } else {\n    isDebug.value = true;\n  }\n}\n\nconst TICKERR = \"nexttick_thread_limit\";\n\nlet asyncsCounter = 0;\nlet afterTimer;\nconst tickSets = new Set();\nexport function nextTick(callback) {\n  clearTimeout(afterTimer);\n  afterTimer = setTimeout(() => {\n    asyncsCounter = 0;\n  });\n\n  if (isDebug.value) {\n    Promise.resolve().then(() => {\n      asyncsCounter++;\n      if (asyncsCounter > 100000) {\n        console.log(getErrDesc(TICKERR), \"lastCall => \", callback);\n        throw getErr(TICKERR);\n      }\n\n      callback();\n    });\n    return;\n  }\n\n  const tickId = `t-${getRandomId()}`;\n  tickSets.add(tickId);\n  Promise.resolve().then(() => {\n    asyncsCounter++;\n    // console.log(\"asyncsCounter => \", asyncsCounter);\n    if (asyncsCounter > 50000) {\n      tickSets.clear();\n\n      console.log(getErrDesc(TICKERR), \"lastCall => \", callback);\n      throw getErr(TICKERR);\n    }\n    if (tickSets.has(tickId)) {\n      callback();\n      tickSets.delete(tickId);\n    }\n  });\n  return tickId;\n}\n\n// export const clearTick = (id) => tickSets.delete(id);\n\nexport function debounce(func, wait = 0) {\n  let timeout = null;\n  let hisArgs = [];\n\n  return function (...args) {\n    hisArgs.push(...args);\n\n    if (wait > 0) {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        func.call(this, hisArgs);\n        hisArgs = [];\n        timeout = null;\n      }, wait);\n    } else {\n      if (timeout === null) {\n        timeout = 1;\n        nextTick(() => {\n          timeout = null;\n          const args = hisArgs.slice();\n          hisArgs = [];\n          func.call(this, args);\n        });\n      }\n    }\n  };\n}\n\n// Enhanced methods for extending objects\nexport const extend = (_this, proto, descriptor = {}) => {\n  [\n    ...Object.getOwnPropertyNames(proto),\n    ...Object.getOwnPropertySymbols(proto),\n  ].forEach((k) => {\n    const result = Object.getOwnPropertyDescriptor(proto, k);\n    const { configurable, enumerable, writable, get, set, value } = result;\n\n    if (\"value\" in result) {\n      if (_this.hasOwnProperty(k)) {\n        _this[k] = value;\n      } else {\n        Object.defineProperty(_this, k, {\n          enumerable,\n          configurable,\n          writable,\n          ...descriptor,\n          value,\n        });\n      }\n    } else {\n      Object.defineProperty(_this, k, {\n        enumerable,\n        configurable,\n        ...descriptor,\n        get,\n        set,\n      });\n    }\n  });\n\n  return _this;\n};\n\nexport function dataRevoked(data) {\n  try {\n    data.xid;\n  } catch (err) {\n    return isRevokedErr(err);\n  }\n\n  return false;\n}\n\nexport function isRevokedErr(error) {\n  const firstLine = error.stack.split(/\\\\n/)[0].toLowerCase();\n  if (firstLine.includes(\"proxy\") && firstLine.includes(\"revoked\")) {\n    return true;\n  }\n\n  return false;\n}\n","import { getErr } from \"../ofa-error/main.js\";\nimport { getType } from \"../stanz/public.mjs\";\n\nexport const isFunction = (val) => getType(val).includes(\"function\");\n\nexport const hyphenToUpperCase = (str) =>\n  str.replace(/-([a-z])/g, (match, p1) => {\n    return p1.toUpperCase();\n  });\n\nexport function capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nexport const isArrayEqual = (arr1, arr2) => {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  for (let i = 0, len = arr1.length; i < len; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n};\n\nexport const toDashCase = (str) => {\n  return str.replace(/[A-Z]/g, function (match) {\n    return \"-\" + match.toLowerCase();\n  });\n};\n\n// Determine if an element is eligible\nexport const meetsEle = (ele, expr) => {\n  const temp = document.createElement(\"template\");\n  temp.content.append(ele.cloneNode());\n  return !!temp.content.querySelector(expr);\n};\n\nexport function isEmptyObject(obj) {\n  if (!obj) {\n    return false;\n  }\n  for (var key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport const removeArrayValue = (arr, target) => {\n  const index = arr.indexOf(target);\n  if (index > -1) {\n    arr.splice(index, 1);\n  }\n};\n\nexport const searchEle = (el, expr) => {\n  if (el instanceof HTMLTemplateElement) {\n    return Array.from(el.content.querySelectorAll(expr));\n  }\n  return Array.from(el.querySelectorAll(expr));\n};\n\nexport function mergeObjects(obj1, obj2) {\n  for (let key of Object.keys(obj1)) {\n    if (!obj2.hasOwnProperty(key)) {\n      delete obj1[key];\n    }\n  }\n\n  for (let [key, value] of Object.entries(obj2)) {\n    obj1[key] = value;\n  }\n}\n\nexport const isSafariBrowser = () =>\n  /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n","import { getRandomId, debounce, dataRevoked } from \"./public.mjs\";\nimport { WATCHS } from \"./main.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\nconst { assign, freeze } = Object;\n\nclass Watcher {\n  constructor(opts) {\n    assign(this, opts);\n    freeze(this);\n  }\n\n  hasModified(k) {\n    if (this.type === \"array\") {\n      return this.path.includes(this.currentTarget.get(k));\n    }\n\n    const keys = k.split(\".\");\n\n    if (this.currentTarget === this.target && this.name === keys[0]) {\n      return true;\n    }\n\n    const modifieds = getModifieds(this, keys);\n\n    const positionIndex = modifieds.indexOf(this.target);\n    if (positionIndex > -1) {\n      const currentKeys = keys.slice(positionIndex + 1);\n\n      if (!currentKeys.length) {\n        // This is listening for changes in the child object itself\n        return true;\n      }\n\n      return this.name === currentKeys[0];\n    }\n\n    // Data belonging to the chain of change\n    return this.path.includes(this.currentTarget[k]);\n  }\n\n  hasReplaced(k) {\n    if (this.type !== \"set\") {\n      return false;\n    }\n\n    const keys = k.split(\".\");\n\n    if (this.target === this.currentTarget && this.name === keys[0]) {\n      return true;\n    }\n\n    const modifieds = getModifieds(this, keys);\n\n    const positionIndex = modifieds.indexOf(this.target);\n\n    if (positionIndex > -1) {\n      const currentKeys = keys.slice(positionIndex + 1);\n\n      return currentKeys[0] === this.name;\n    }\n\n    return false;\n  }\n}\n\nconst getModifieds = (_this, keys) => {\n  const modifieds = [];\n\n  const cloneKeys = keys.slice();\n  let target = _this.currentTarget;\n  while (cloneKeys.length) {\n    const targetKey = cloneKeys.shift();\n    if (target) {\n      target = target[targetKey];\n    }\n\n    modifieds.push(target);\n  }\n\n  return modifieds;\n};\n\nclass Watchers extends Array {\n  constructor(arr) {\n    super(...arr);\n  }\n\n  hasModified(key) {\n    return this.some((e) => e.hasModified(key));\n  }\n\n  hasReplaced(key) {\n    return this.some((e) => e.hasReplaced(key));\n  }\n}\n\nexport const emitUpdate = ({\n  type,\n  currentTarget,\n  target,\n  name,\n  value,\n  oldValue,\n  args,\n  path = [],\n}) => {\n  if (path && path.includes(currentTarget)) {\n    console.warn(\"Circular references appear\");\n    return;\n  }\n\n  let options = {\n    type,\n    target,\n    name,\n    oldValue,\n    value,\n  };\n\n  if (type === \"array\") {\n    delete options.value;\n    options.args = args;\n  }\n\n  if (currentTarget._hasWatchs) {\n    const watcher = new Watcher({\n      currentTarget,\n      ...options,\n      path: [...path],\n    });\n\n    currentTarget[WATCHS].forEach((func) => {\n      func(watcher);\n    });\n  }\n\n  currentTarget._update &&\n    currentTarget.owner.forEach((parent) => {\n      emitUpdate({\n        currentTarget: parent,\n        ...options,\n        path: [currentTarget, ...path],\n      });\n    });\n};\n\nexport default {\n  watch(callback) {\n    if (!(callback instanceof Function)) {\n      throw getErr(\"not_func\", { name: \"watch\" });\n    }\n\n    const wid = \"w-\" + getRandomId();\n\n    this[WATCHS].set(wid, callback);\n\n    return wid;\n  },\n\n  unwatch(wid) {\n    return this[WATCHS].delete(wid);\n  },\n\n  watchTick(callback, wait) {\n    if (!(callback instanceof Function)) {\n      throw getErr(\"not_func\", { name: \"watchTick\" });\n    }\n\n    return this.watch(\n      debounce((arr) => {\n        if (dataRevoked(this)) {\n          // console.warn(`The revoked object cannot use watchTick : `, this);\n          return;\n        }\n        arr = arr.filter((e) => {\n          try {\n            e.path.forEach((item) => item.xid);\n          } catch (err) {\n            return false;\n          }\n\n          return true;\n        });\n\n        callback(new Watchers(arr));\n      }, wait || 0)\n    );\n  },\n  // For manual use of emitUpdate\n  refresh(opts) {\n    const options = {\n      ...opts,\n      type: \"refresh\",\n      target: this,\n      currentTarget: this,\n    };\n    emitUpdate(options);\n  },\n  watchUntil(func) {\n    return new Promise((resolve) => {\n      let f;\n      const tid = this.watch(\n        (f = () => {\n          const bool = func();\n          if (bool) {\n            this.unwatch(tid);\n            resolve(this);\n          }\n        })\n      );\n\n      f();\n    });\n  },\n};\n","import { clearData } from \"./accessor.mjs\";\nimport { SELF, PROXY, isxdata } from \"./main.mjs\";\nimport { isObject } from \"./public.mjs\";\nimport { emitUpdate } from \"./watch.mjs\";\n\nconst mutatingMethods = [\n  \"push\",\n  \"pop\",\n  \"shift\",\n  \"unshift\",\n  \"splice\",\n  \"reverse\",\n  \"sort\",\n  \"fill\",\n  \"copyWithin\",\n];\n\nconst holder = Symbol(\"placeholder\");\n\nfunction compareArrays(oldArray, newArray) {\n  const backupNewArray = Array.from(newArray);\n  const backupOldArray = Array.from(oldArray);\n  const deletedItems = [];\n  const addedItems = new Map();\n\n  const oldLen = oldArray.length;\n  for (let i = 0; i < oldLen; i++) {\n    const oldItem = oldArray[i];\n    const newIndex = backupNewArray.indexOf(oldItem);\n    if (newIndex > -1) {\n      backupNewArray[newIndex] = holder;\n    } else {\n      deletedItems.push(oldItem);\n    }\n  }\n\n  const newLen = newArray.length;\n  for (let i = 0; i < newLen; i++) {\n    const newItem = newArray[i];\n    const oldIndex = backupOldArray.indexOf(newItem);\n    if (oldIndex > -1) {\n      backupOldArray[oldIndex] = holder;\n    } else {\n      addedItems.set(i, newItem);\n    }\n  }\n\n  return { deletedItems, addedItems };\n}\n\nconst fn = {};\n\nconst arrayFn = Array.prototype;\n\nmutatingMethods.forEach((methodName) => {\n  if (arrayFn[methodName]) {\n    fn[methodName] = function (...args) {\n      const backupArr = Array.from(this);\n\n      const reval = arrayFn[methodName].apply(this[SELF], args);\n\n      const { deletedItems, addedItems } = compareArrays(backupArr, this);\n\n      // Refactoring objects as proxy instances\n      for (let [key, value] of addedItems) {\n        if (isxdata(value)) {\n          value._owner.push(this);\n        } else if (isObject(value)) {\n          this.__unupdate = 1;\n          this[key] = value;\n          delete this.__unupdate;\n        }\n      }\n\n      for (let item of deletedItems) {\n        clearData(item, this);\n      }\n\n      emitUpdate({\n        type: \"array\",\n        currentTarget: this,\n        target: this,\n        args,\n        name: methodName,\n        oldValue: backupArr,\n      });\n\n      if (reval === this[SELF]) {\n        return this[PROXY];\n      }\n\n      return reval;\n    };\n  }\n});\n\n// Object.getOwnPropertyNames(Array.prototype).forEach((methodName) => {\n[\"concat\", \"filter\", \"slice\", \"flatMap\", \"map\"].forEach((methodName) => {\n  if (methodName === \"constructor\" || mutatingMethods.includes(methodName)) {\n    return;\n  }\n\n  const oldFunc = Array.prototype[methodName];\n  if (oldFunc instanceof Function) {\n    fn[methodName] = function (...args) {\n      return oldFunc.call(Array.from(this), ...args);\n    };\n  }\n});\n\nexport default fn;\n","import { extend, getRandomId } from \"./public.mjs\";\nimport { handler as stanzHandler } from \"./accessor.mjs\";\nimport arrayFn from \"./array.mjs\";\nimport watchFn from \"./watch.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\nconst { defineProperties, getOwnPropertyDescriptor, entries } = Object;\n\nexport const SELF = Symbol(\"self\");\nexport const PROXY = Symbol(\"proxy\");\nexport const WATCHS = Symbol(\"watchs\");\nexport const ISXDATA = Symbol(\"isxdata\");\n\nexport const isxdata = (val) => val && !!val[ISXDATA];\n\nexport function constructor(data, handler = stanzHandler) {\n  // const proxySelf = new Proxy(this, handler);\n  let { proxy: proxySelf, revoke } = Proxy.revocable(this, handler);\n\n  // Determines the properties of the listener bubble\n  proxySelf._update = 1;\n\n  let watchs;\n\n  defineProperties(this, {\n    xid: { value: data.xid || getRandomId() },\n    // Save all parent objects\n    _owner: {\n      value: [],\n    },\n    owner: {\n      configurable: true,\n      get() {\n        return new Set(this._owner);\n      },\n    },\n    [ISXDATA]: {\n      value: true,\n    },\n    [SELF]: {\n      configurable: true,\n      get: () => this,\n    },\n    [PROXY]: {\n      configurable: true,\n      get: () => proxySelf,\n    },\n    // Save the object of the listener function\n    [WATCHS]: {\n      get: () => watchs || (watchs = new Map()),\n    },\n    _hasWatchs: {\n      get: () => !!watchs,\n    },\n    _revoke: {\n      value: revoke,\n    },\n  });\n\n  Object.keys(data).forEach((key) => {\n    const descObj = getOwnPropertyDescriptor(data, key);\n    let { value, get, set } = descObj;\n\n    if (get || set) {\n      defineProperties(this, {\n        [key]: descObj,\n      });\n    } else {\n      // Set the function directly\n      proxySelf[key] = value;\n    }\n  });\n\n  return proxySelf;\n}\n\nexport default class Stanz extends Array {\n  constructor(data) {\n    super();\n\n    return constructor.call(this, data);\n  }\n\n  // This method is still in the experimental period\n  revoke() {\n    const self = this[SELF];\n\n    if (self._onrevokes) {\n      self._onrevokes.forEach((f) => f());\n      self._onrevokes.length = 0;\n    }\n\n    self.__unupdate = 1;\n\n    self[WATCHS].clear();\n\n    entries(this).forEach(([name, value]) => {\n      if (isxdata(value)) {\n        this[name] = null;\n      }\n    });\n\n    self._owner.forEach((parent) => {\n      entries(parent).forEach(([name, value]) => {\n        if (value === this) {\n          parent[name] = null;\n        }\n      });\n    });\n\n    delete self[SELF];\n    delete self[PROXY];\n    self._revoke();\n  }\n\n  toJSON() {\n    let obj = {};\n\n    let isPureArray = true;\n    let maxId = -1;\n\n    Object.keys(this).forEach((k) => {\n      let val = this[k];\n\n      if (!/\\D/.test(k)) {\n        k = parseInt(k);\n        if (k > maxId) {\n          maxId = k;\n        }\n      } else {\n        isPureArray = false;\n      }\n\n      if (isxdata(val)) {\n        val = val.toJSON();\n      }\n\n      obj[k] = val;\n    });\n\n    if (isPureArray) {\n      obj.length = maxId + 1;\n      obj = Array.from(obj);\n    }\n\n    const xid = this.xid;\n    defineProperties(obj, {\n      xid: {\n        get: () => xid,\n      },\n    });\n\n    return obj;\n  }\n\n  toString() {\n    return JSON.stringify(this.toJSON());\n  }\n\n  extend(obj, desc) {\n    return extend(this, obj, desc);\n  }\n\n  get(key) {\n    if (/\\./.test(key)) {\n      const keys = key.split(\".\");\n      let target = this;\n      for (let i = 0, len = keys.length; i < len; i++) {\n        try {\n          target = target[keys[i]];\n        } catch (error) {\n          const err = getErr(\n            \"failed_to_get_data\",\n            {\n              key: keys.slice(0, i).join(\".\"),\n            },\n            error\n          );\n\n          console.log(err.message, \":\", key, this, error);\n\n          throw err;\n        }\n      }\n\n      return target;\n    }\n\n    return this[key];\n  }\n  set(key, value) {\n    if (/\\./.test(key)) {\n      const keys = key.split(\".\");\n      const lastKey = keys.pop();\n      let target = this;\n      for (let i = 0, len = keys.length; i < len; i++) {\n        try {\n          target = target[keys[i]];\n        } catch (error) {\n          const err = getErr(\n            \"failed_to_get_data\",\n            {\n              key: keys.slice(0, i).join(\".\"),\n            },\n            error\n          );\n\n          console.log(err.message, \":\", key, this, error);\n\n          throw err;\n        }\n      }\n\n      return (target[lastKey] = value);\n    }\n\n    return (this[key] = value);\n  }\n}\n\nStanz.prototype.extend(\n  { ...watchFn, ...arrayFn },\n  {\n    enumerable: false,\n  }\n);\n","import { isObject } from \"./public.mjs\";\nimport Stanz, { PROXY, isxdata } from \"./main.mjs\";\nimport { emitUpdate } from \"./watch.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\n\nconst { defineProperties } = Object;\n\nexport const setData = ({ target, key, value, receiver, type, succeed }) => {\n  const oldValue = receiver[key];\n\n  let data = value;\n  if (isxdata(data)) {\n    if (oldValue === value) {\n      return true;\n    }\n    data._owner.push(receiver);\n  } else if (isObject(value)) {\n    const desc = Object.getOwnPropertyDescriptor(target, key);\n    if (!desc || desc.hasOwnProperty(\"value\")) {\n      data = new Stanz(value);\n      data._owner.push(receiver);\n    }\n  }\n\n  const isSame = oldValue === value;\n\n  if (!isSame && isxdata(oldValue)) {\n    clearData(oldValue, receiver);\n  }\n\n  const reval = succeed(data);\n\n  !isSame &&\n    // __unupdate: Let the system not trigger an upgrade, system self-use attribute\n    !target.__unupdate &&\n    emitUpdate({\n      type: type || \"set\",\n      target: receiver,\n      currentTarget: receiver,\n      name: key,\n      value,\n      oldValue,\n    });\n\n  return reval;\n};\n\nexport const clearData = (val, target) => {\n  if (isxdata(val)) {\n    const index = val._owner.indexOf(target);\n    if (index > -1) {\n      val._owner.splice(index, 1);\n    } else {\n      console.error({\n        desc: \"This data is wrong, the owner has no boarding object at the time of deletion\",\n        target,\n        mismatch: val,\n      });\n    }\n  }\n};\n\nexport const handler = {\n  set(target, key, value, receiver) {\n    if (typeof key === \"symbol\") {\n      return Reflect.set(target, key, value, receiver);\n    }\n\n    // Set properties with _ prefix directly\n    if (/^_/.test(key)) {\n      if (!target.hasOwnProperty(key)) {\n        defineProperties(target, {\n          [key]: {\n            writable: true,\n            configurable: true,\n            value,\n          },\n        });\n      } else {\n        Reflect.set(target, key, value, receiver);\n      }\n      return true;\n    }\n\n    try {\n      return setData({\n        target,\n        key,\n        value,\n        receiver,\n        succeed(data) {\n          return Reflect.set(target, key, data, receiver);\n        },\n      });\n    } catch (error) {\n      const err = getErr(\n        \"failed_to_set_data\",\n        {\n          key,\n        },\n        error\n      );\n\n      console.log(err.message, key, target, value);\n\n      throw err;\n    }\n  },\n  deleteProperty(target, key) {\n    if (/^_/.test(key) || typeof key === \"symbol\") {\n      return Reflect.deleteProperty(target, key);\n    }\n\n    return setData({\n      target,\n      key,\n      value: undefined,\n      receiver: target[PROXY],\n      type: \"delete\",\n      succeed() {\n        return Reflect.deleteProperty(target, key);\n      },\n    });\n  },\n};\n","import { eleX } from \"./util.mjs\";\nimport { handler as stanzHandler } from \"../stanz/accessor.mjs\";\n\n// const tempEl = document.createElement(\"template\");\n\nexport const handler = {\n  set(target, key, value, receiver) {\n    if (!/\\D/.test(String(key))) {\n      return Reflect.set(target, key, value, receiver);\n    }\n\n    if (target[key] === value) {\n      // Optimise performance;\n      // fix focus remapping caused by 'text' being reset\n      return true;\n    }\n\n    if (key === \"html\") {\n      // When setting HTML values that contain single quotes, they become double quotes when set, leading to an infinite loop of updates.\n      // tempEl.innerHTML = value;\n      // value = tempEl.innerHTML;\n\n      // If custom elements are stuffed, the html values may remain inconsistent\n      return Reflect.set(target, key, value, receiver);\n    }\n\n    return stanzHandler.set(target, key, value, receiver);\n  },\n  get(target, key, receiver) {\n    if (!/\\D/.test(String(key))) {\n      return eleX(target.ele.children[key]);\n    }\n\n    return Reflect.get(target, key, receiver);\n  },\n  ownKeys(target) {\n    let keys = Reflect.ownKeys(target);\n    let len = target.ele.children.length;\n    for (let i = 0; i < len; i++) {\n      keys.push(String(i));\n    }\n    return keys;\n  },\n  getOwnPropertyDescriptor(target, key) {\n    if (typeof key === \"string\" && !/\\D/.test(key)) {\n      return {\n        enumerable: true,\n        configurable: true,\n      };\n    }\n    return Reflect.getOwnPropertyDescriptor(target, key);\n  },\n};\n","import { getErr, getErrDesc } from \"../../ofa-error/main.js\";\nimport { getRandomId, isRevokedErr } from \"../../stanz/public.mjs\";\nimport stanzProto from \"../../stanz/watch.mjs\";\n\nimport {\n  isFunction,\n  hyphenToUpperCase,\n  meetsEle,\n  isEmptyObject,\n  searchEle,\n  removeArrayValue as remove,\n} from \"../public.mjs\";\nimport { eleX } from \"../util.mjs\";\n\nexport const renderExtends = {\n  beforeRender() {},\n  render() {},\n};\n\nconst getRevokes = (target) => target.__revokes || (target.__revokes = []);\nconst addRevoke = (target, revoke) => getRevokes(target).push(revoke);\n\nconst convertToFunc = (expr, data, opts) => {\n  const funcStr = `\nconst isRevokedErr = ${isRevokedErr.toString()}\nconst [$event] = $args;\nconst {data, errCall} = this;\ntry{\n  with(data){\n    return ${expr};\n  }\n}catch(error){\n  if(isRevokedErr(error)){\n    return;\n  }\n  if(data.ele && !data.ele.isConnected){\n    return;\n  }\n  if(errCall){\n    const result = errCall(error);\n    if(result !== false){\n      console.error(error);\n    }\n  }else{\n    console.error(error);\n  }\n}\n`;\n  return new Function(\"...$args\", funcStr).bind({ data, ...opts });\n};\n\nexport function render({\n  data,\n  target,\n  template,\n  temps,\n  isRenderSelf,\n  ...otherOpts\n}) {\n  const content = template && template.innerHTML;\n\n  if (content) {\n    target.innerHTML = content;\n  }\n\n  renderExtends.beforeRender({\n    target,\n  });\n\n  const texts = searchEle(target, \"xtext\");\n\n  const tasks = [];\n  const revokes = getRevokes(target);\n\n  // Styles with data() function to monitor and correct rendering\n  searchEle(target, \"style\").forEach((el) => {\n    const originStyle = el.innerHTML;\n\n    if (/data\\(.+\\)/.test(originStyle)) {\n      const matchs = Array.from(new Set(originStyle.match(/data\\(.+?\\)/g))).map(\n        (dataExpr) => {\n          const expr = dataExpr.replace(/data\\((.+)\\)/, \"$1\");\n          const func = convertToFunc(expr, data);\n\n          return {\n            dataExpr,\n            func,\n          };\n        }\n      );\n\n      const renderStyle = () => {\n        let afterStyle = originStyle;\n\n        matchs.forEach(({ dataExpr, func }) => {\n          afterStyle = afterStyle.replace(dataExpr, func());\n        });\n\n        if (el.innerHTML !== afterStyle) {\n          el.innerHTML = afterStyle;\n        }\n      };\n      tasks.push(renderStyle);\n\n      const revokeStyle = () => {\n        matchs.length = 0;\n        remove(tasks, renderStyle);\n        remove(getRevokes(el), revokeStyle);\n        remove(revokes, revokeStyle);\n      };\n\n      addRevoke(el, revokeStyle);\n      revokes.push(revokeStyle);\n    }\n  });\n\n  // Render text nodes\n  texts.forEach((el) => {\n    const textEl = document.createTextNode(\"\");\n    const { parentNode } = el;\n    parentNode.insertBefore(textEl, el);\n    parentNode.removeChild(el);\n\n    const func = convertToFunc(el.getAttribute(\"expr\"), data);\n    const renderFunc = () => {\n      const content = func();\n      if (textEl.textContent !== String(content)) {\n        textEl.textContent = content;\n      }\n    };\n    tasks.push(renderFunc);\n\n    const textRevoke = () => {\n      remove(revokes, textRevoke);\n      remove(tasks, renderFunc);\n      remove(getRevokes(textEl), textRevoke);\n    };\n    revokes.push(textRevoke);\n    addRevoke(textEl, textRevoke);\n  });\n\n  const eles = searchEle(target, `[x-bind-data]`);\n\n  if (isRenderSelf && meetsEle(target, `[x-bind-data]`)) {\n    eles.unshift(target);\n  }\n\n  // Render properties based on expressions\n  eles.forEach((el) => {\n    const bindData = JSON.parse(el.getAttribute(\"x-bind-data\"));\n\n    const $el = eleX(el);\n\n    for (let [actionName, arr] of Object.entries(bindData)) {\n      arr.forEach((args) => {\n        try {\n          const { always } = $el[actionName];\n          let afterArgs = [];\n\n          let workResult;\n\n          const work = () => {\n            const [key, expr] = args;\n\n            const func = convertToFunc(expr, data, {\n              errCall: (error) => {\n                const stack = `Rendering of target element failed: ${$el.ele.outerHTML} \\n  ${error.stack}`;\n                console.error(stack);\n                console.error({ stack, element: $el.ele, target, error });\n\n                return false;\n              },\n            });\n\n            afterArgs = [key, func];\n\n            const reval = $el[actionName](...afterArgs, {\n              actionName,\n              target: $el,\n              data,\n              beforeArgs: args,\n              args: afterArgs,\n            });\n\n            renderExtends.render({\n              step: \"refresh\",\n              args,\n              name: actionName,\n              target: $el,\n            });\n\n            return reval;\n          };\n\n          let clearRevs = () => {\n            const { revoke: methodRevoke } = $el[actionName];\n\n            if (methodRevoke) {\n              methodRevoke({\n                actionName,\n                target: $el,\n                data,\n                beforeArgs: args,\n                args: afterArgs,\n                result: workResult,\n              });\n            }\n\n            remove(revokes, clearRevs);\n            remove(getRevokes(el), clearRevs);\n            remove(tasks, work);\n            clearRevs = null;\n          };\n\n          if (always) {\n            // Run every data update\n            tasks.push(work);\n          } else {\n            workResult = work();\n          }\n\n          revokes.push(clearRevs);\n          if (el !== target) {\n            addRevoke(el, clearRevs);\n          }\n        } catch (error) {\n          const err = getErr(\n            \"xhear_eval\",\n            {\n              name: actionName,\n              arg0: args[0],\n              arg1: args[1],\n            },\n            error\n          );\n          console.log(err, el);\n          throw err;\n        }\n      });\n    }\n\n    el.removeAttribute(\"x-bind-data\");\n\n    el._bindingRendered = true;\n    el.dispatchEvent(new Event(\"binding-rendered\"));\n  });\n\n  if (!target.__render_temps && !isEmptyObject(temps)) {\n    target.__render_temps = temps;\n  }\n\n  if (tasks.length) {\n    if (target.__render_data && target.__render_data !== data) {\n      const err = getErr(\"xhear_listen_already\");\n\n      console.log(err, {\n        element: target,\n        old: target.__render_data,\n        new: data,\n      });\n\n      throw err;\n    }\n\n    target.__render_data = data;\n\n    tasks.forEach((f) => f());\n\n    // After the data changes, traverse the rendering tasks\n    const wid = data.watchTick((e) => {\n      if (tasks.length) {\n        tasks.forEach((f) => f());\n      } else {\n        data.unwatch(wid);\n      }\n    });\n  }\n\n  renderExtends.render({ step: \"init\", target });\n}\n\nconst convertEl = (el) => {\n  const { tagName } = el;\n\n  if (tagName === \"TEMPLATE\") {\n    return;\n  }\n\n  if (tagName) {\n    // Converting elements\n    const obj = {};\n\n    Array.from(el.attributes).forEach((attr) => {\n      const matchData = /(.*):(.+)/.exec(attr.name);\n\n      if (!matchData) {\n        return;\n      }\n\n      let [, actionName, param0] = matchData;\n\n      if (!actionName) {\n        actionName = \"prop\";\n      }\n\n      const targetActions = obj[actionName] || (obj[actionName] = []);\n\n      targetActions.push([param0, attr.value]);\n\n      el.removeAttribute(attr.name);\n    });\n\n    const keys = Object.keys(obj);\n\n    if (keys.length) {\n      el.setAttribute(\"x-bind-data\", JSON.stringify(obj));\n    }\n  }\n\n  Array.from(el.children).forEach(convertEl);\n};\n\nconst searchTemp = (template, expr, func) => {\n  const rearr = Array.from(template.content.querySelectorAll(expr));\n\n  if (func) {\n    rearr.forEach(func);\n  }\n\n  return rearr;\n};\n\nlet isWarned;\n\nexport const convert = (template) => {\n  let temps = {};\n  const codeEls = {};\n\n  searchTemp(template, \"code\", (code) => {\n    const cid = getRandomId();\n    code.setAttribute(\"code-id\", cid);\n\n    codeEls[cid] = code.innerHTML;\n    code.innerHTML = \"\";\n  });\n\n  template.innerHTML = template.innerHTML.replace(\n    /{{(.+?)}}/g,\n    (str, match) => {\n      return `<xtext expr=\"${match}\"></xtext>`;\n    }\n  );\n\n  const tempName = template.getAttribute(\"name\");\n\n  if (tempName) {\n    const tempChilds = template.content.children;\n    if (tempChilds.length > 1) {\n      if (!isWarned) {\n        console.warn(\n          `Only one child element can be contained within a template element. If multiple child elements appear, the child elements will be rewrapped within a <div> element`\n        );\n        isWarned = 1;\n      }\n\n      const wrapName = `wrapper-${tempName}`;\n      template.innerHTML = `<div ${wrapName} style=\"display:contents\">${template.innerHTML}</div>`;\n      console.warn(\n        `The template \"${tempName}\" contains ${tempChilds.length} child elements that have been wrapped in a div element with attribute \"${wrapName}\".`\n      );\n    }\n    temps[tempName] = template;\n    template.remove();\n  }\n\n  searchTemp(template, \"x-fill:not([name])\", (fillEl) => {\n    if (fillEl.querySelector(\"x-fill:not([name])\")) {\n      throw getErr(\"xhear_dbfill_noname\");\n    }\n\n    if (fillEl.innerHTML.trim()) {\n      const tid = `t${getRandomId()}`;\n      fillEl.setAttribute(\"name\", tid);\n\n      const temp = document.createElement(\"template\");\n      temp.setAttribute(\"name\", tid);\n      temp.innerHTML = fillEl.innerHTML;\n      fillEl.innerHTML = \"\";\n      fillEl.appendChild(temp);\n    }\n  });\n\n  searchTemp(template, \"x-if,x-else-if,x-else\", (condiEl) => {\n    const firstChild = condiEl.children[0];\n    if (!firstChild || firstChild.tagName !== \"TEMPLATE\") {\n      condiEl.innerHTML = `<template condition>${condiEl.innerHTML}</template>`;\n    }\n  });\n\n  searchTemp(template, \"template\", (e) => {\n    const newTemps = convert(e);\n\n    Object.keys(newTemps).forEach((tempName) => {\n      if (temps[tempName]) {\n        throw getErr(\"xhear_temp_exist\", {\n          name: tempName,\n        });\n      }\n    });\n\n    temps = { ...temps, ...newTemps };\n  });\n\n  Array.from(template.content.children).forEach((el) => convertEl(el));\n\n  // Restore the contents of the code\n  for (let [key, value] of Object.entries(codeEls)) {\n    searchTemp(template, `[code-id=\"${key}\"]`, (el) => {\n      el.removeAttribute(\"code-id\");\n      // el.innerHTML = htmlEncode(value);\n      el.innerHTML = value;\n    });\n  }\n\n  return temps;\n};\n\nconst getVal = (val) => {\n  if (isFunction(val)) {\n    return val();\n  }\n\n  return val;\n};\n\nconst defaultData = {\n  prop(...args) {\n    let [name, value] = args;\n\n    if (args.length === 1) {\n      return this[name];\n    }\n\n    value = getVal(value);\n    name = hyphenToUpperCase(name);\n\n    this.set(name, value);\n  },\n  attr(...args) {\n    let [name, value] = args;\n\n    if (args.length === 1) {\n      return this.ele.getAttribute(name);\n    }\n\n    value = getVal(value);\n\n    if (value === false) {\n      value = null;\n    } else if (value === true) {\n      value = \"\";\n    }\n\n    if (value === null) {\n      this.ele.removeAttribute(name);\n    } else {\n      this.ele.setAttribute(name, value);\n    }\n  },\n  class(...args) {\n    let [name, value] = args;\n\n    if (args.length === 1) {\n      return this.ele.classList.contains(name);\n    }\n\n    value = getVal(value);\n\n    if (value) {\n      this.ele.classList.add(name);\n    } else {\n      this.ele.classList.remove(name);\n    }\n  },\n  watch(...args) {\n    if (args.length < 3) {\n      return stanzProto.watch.apply(this, args);\n    }\n\n    const options = args[2];\n    const { beforeArgs, data: target } = options;\n    const [selfPropName, targetPropName] = beforeArgs;\n    const propName = hyphenToUpperCase(selfPropName);\n\n    const setData = () => {\n      let val = this[propName];\n      if (val instanceof Object) {\n        // If val is Object, deepClone it.\n        val = JSON.parse(JSON.stringify(val));\n        const errDesc = getErrDesc(\"heed_object\");\n        console.log(errDesc, target);\n      }\n      target[targetPropName] = val;\n    };\n\n    const wid = this.watch((e) => {\n      if (e.hasModified(propName)) {\n        setData();\n      }\n    });\n\n    // Initialize once\n    setData();\n\n    return () => {\n      this.unwatch(wid);\n    };\n  },\n};\n\ndefaultData.prop.always = true;\ndefaultData.attr.always = true;\ndefaultData.class.always = true;\n\ndefaultData.prop.revoke = ({ target, args, $ele, data }) => {\n  const propName = args[0];\n  target.set(propName, null);\n};\n\ndefaultData.watch.revoke = (e) => {\n  e.result();\n};\n\nexport default defaultData;\n","import { hyphenToUpperCase } from \"../public.mjs\";\nimport { dataRevoked } from \"../../stanz/public.mjs\";\nimport { getErr } from \"../../ofa-error/main.js\";\n\nconst syncFn = {\n  sync(propName, targetName, options) {\n    if (!options) {\n      throw getErr(\"xhear_sync_no_options\");\n    }\n\n    [propName, targetName] = options.beforeArgs;\n\n    propName = hyphenToUpperCase(propName);\n    targetName = hyphenToUpperCase(targetName);\n\n    const { data } = options;\n\n    const val = data.get(targetName);\n\n    if (val instanceof Object) {\n      const err = getErr(\"xhear_sync_object_value\", { targetName });\n      console.log(err, data);\n      throw err;\n    }\n\n    this[propName] = data.get(targetName);\n\n    const wid1 = this.watch((e) => {\n      if (e.hasModified(propName)) {\n        try {\n          const value = this.get(propName);\n          data.set(targetName, value);\n        } catch (err) {\n          // Errors are reported when a proxy is revoked.\n          // console.warn(err);\n        }\n      }\n    });\n\n    const wid2 = data.watch((e) => {\n      if (e.hasModified(targetName)) {\n        try {\n          const value = data.get(targetName);\n          this.set(propName, value);\n        } catch (err) {\n          // Errors are reported when a proxy is revoked.\n          // console.warn(err);\n        }\n      }\n    });\n\n    return () => {\n      this.unwatch(wid1);\n      if (!dataRevoked(data)) {\n        data.unwatch(wid2);\n      }\n    };\n  },\n};\n\nsyncFn.sync.revoke = (e) => {\n  e.result();\n};\n\nexport default syncFn;\n","import { getErr } from \"../ofa-error/main.js\";\n\nfunction getBindOptions(name, func, options) {\n  let revoker;\n  if (options) {\n    const beforeValue = options.beforeArgs[1];\n\n    if (!/[^\\d\\w_\\$\\.]/.test(beforeValue)) {\n      func = options.data.get(beforeValue);\n      if (!func) {\n        const tag = options.data.tag;\n        const err = getErr(\"not_found_func\", {\n          name: beforeValue,\n          tag: tag ? `\"${tag}\"` : \"\",\n        });\n        console.log(err, \" target =>\", options.data);\n        throw err;\n      }\n      func = func.bind(options.data);\n    }\n\n    revoker = () => this.ele.removeEventListener(name, func);\n  }\n\n  return { revoker, name, func };\n}\n\nconst eventFn = {\n  on(...args) {\n    const { revoker, name, func } = getBindOptions.call(this, ...args);\n\n    this.ele.addEventListener(name, func);\n\n    if (revoker) {\n      return revoker;\n    }\n\n    return this;\n  },\n  one(...args) {\n    const { revoker, name, func } = getBindOptions.call(this, ...args);\n\n    let callback = (e) => {\n      this.off(name, callback);\n      func(e);\n    };\n\n    this.ele.addEventListener(name, callback);\n\n    if (revoker) {\n      return revoker;\n    }\n\n    return this;\n  },\n  off(name, func) {\n    this.ele.removeEventListener(name, func);\n    return this;\n  },\n  emit(name, opts) {\n    const options = { ...opts };\n\n    let data;\n    if (options.hasOwnProperty(\"data\")) {\n      data = options.data;\n      delete options.data;\n    }\n\n    let event;\n\n    if (name instanceof Event) {\n      event = name;\n    } else if (name) {\n      event = new Event(name, { bubbles: true, ...options });\n    }\n\n    data && (event.data = data);\n\n    this.ele.dispatchEvent(event);\n\n    return this;\n  },\n};\n\neventFn.on.revoke = (e) => {\n  e.result();\n};\n\neventFn.one.revoke = (e) => {\n  e.result();\n};\n\nexport default eventFn;\n","import { isFunction } from \"./public.mjs\";\nimport { createXEle, eleX } from \"./util.mjs\";\nimport { emitUpdate } from \"../stanz/watch.mjs\";\n\nconst originSplice = (ele, start, count, ...items) => {\n  const { children } = ele;\n  if (start < 0) {\n    start += ele.children.length;\n  }\n\n  if (count === undefined) {\n    count = ele.children.length - start;\n  }\n\n  const removes = [];\n  for (let i = start, len = start + count; i < len; i++) {\n    const target = children[i];\n    removes.push(target);\n  }\n\n  removes.forEach((el) => el && el.remove());\n\n  if (items.length) {\n    const frag = document.createDocumentFragment();\n    items.forEach((e) => frag.append(createXEle(e).ele));\n\n    const positionEle = children[start];\n    if (positionEle) {\n      ele.insertBefore(frag, positionEle);\n    } else {\n      ele.appendChild(frag);\n    }\n  }\n\n  return removes;\n};\n\nconst mutatingMethods = [\n  \"push\",\n  \"pop\",\n  \"shift\",\n  \"unshift\",\n  \"splice\",\n  \"reverse\",\n  \"sort\",\n  \"fill\",\n  \"copyWithin\",\n];\n\nconst likeArrayFn = {\n  push(...args) {\n    const { ele } = this;\n\n    originSplice(ele, ele.children.length, 0, ...args);\n\n    emitUpdate({\n      type: \"array\",\n      currentTarget: this,\n      target: this,\n      args,\n      name: \"push\",\n    });\n\n    return ele.children.length;\n  },\n\n  pop(...args) {\n    const { ele } = this;\n\n    const targets = originSplice(ele, ele.children.length - 1, 1, ...args);\n\n    emitUpdate({\n      type: \"array\",\n      currentTarget: this,\n      target: this,\n      args,\n      name: \"pop\",\n    });\n\n    return eleX(targets[0]);\n  },\n\n  shift(...args) {\n    const { ele } = this;\n\n    const targets = originSplice(ele, 0, 1, ...args);\n\n    emitUpdate({\n      type: \"array\",\n      currentTarget: this,\n      target: this,\n      args,\n      name: \"shift\",\n    });\n\n    return eleX(targets[0]);\n  },\n\n  unshift(...args) {\n    const { ele } = this;\n\n    originSplice(ele, 0, 0, ...args);\n\n    emitUpdate({\n      type: \"array\",\n      currentTarget: this,\n      target: this,\n      args,\n      name: \"unshift\",\n    });\n\n    return ele.children.length;\n  },\n  splice(...args) {\n    const reVal = originSplice(this.ele, ...args);\n\n    emitUpdate({\n      type: \"array\",\n      currentTarget: this,\n      target: this,\n      args,\n      name: \"splice\",\n    });\n\n    return reVal.map(eleX);\n  },\n  reverse(...args) {\n    const childs = Array.from(this.ele.childNodes);\n\n    arrayFn.reverse.call(childs, ...args);\n\n    const frag = document.createDocumentFragment();\n\n    childs.forEach((ele) => {\n      // Identify internal operations to prevent detached corrections\n      ele.__internal = 1;\n      frag.append(ele);\n    });\n\n    this.ele.append(frag);\n\n    childs.forEach((ele) => {\n      delete ele.__internal;\n    });\n\n    emitUpdate({\n      type: \"array\",\n      currentTarget: this,\n      target: this,\n      args,\n      name: \"reverse\",\n    });\n\n    return this;\n  },\n  sort(...args) {\n    const childs = Array.from(this.ele.children).map(eleX);\n\n    arrayFn.sort.call(childs, ...args);\n\n    const frag = document.createDocumentFragment();\n\n    childs.forEach((e) => {\n      e.ele.__internal = 1;\n      frag.append(e.ele);\n    });\n\n    this.ele.append(frag);\n\n    childs.forEach((e) => {\n      delete e.ele.__internal;\n    });\n\n    emitUpdate({\n      type: \"array\",\n      currentTarget: this,\n      target: this,\n      args,\n      name: \"sort\",\n    });\n\n    return this;\n  },\n};\n\nconst arrayFn = Array.prototype;\n\nObject.keys(Object.getOwnPropertyDescriptors(arrayFn)).forEach((key) => {\n  if (\n    key === \"constructor\" ||\n    key === \"length\" ||\n    mutatingMethods.includes(key)\n  ) {\n    return;\n  }\n\n  const targetFunc = arrayFn[key];\n\n  if (isFunction(targetFunc)) {\n    likeArrayFn[key] = function (...args) {\n      return targetFunc.apply(Array.from(this.ele.children).map(eleX), args);\n    };\n  }\n});\n\nexport default class LikeArray {}\n\nfor (let [name, value] of Object.entries(likeArrayFn)) {\n  Object.defineProperty(LikeArray.prototype, name, {\n    value,\n  });\n}\n","import Stanz, { isxdata } from \"./main.mjs\";\n\nconst stanz = (data) => {\n  return new Stanz(data);\n};\n\nObject.assign(stanz, { is: isxdata });\n\nexport default stanz;\n","import stanz from \"../stanz/base.mjs\";\nimport { emitUpdate } from \"../stanz/watch.mjs\";\nimport { mergeObjects, searchEle } from \"./public.mjs\";\n\nconst { defineProperty, assign } = Object;\n\nconst hasValueEleNames = [\"input\", \"textarea\", \"select\"];\n\nconst setKeys = (keys, $ele) => {\n  const { ele } = $ele;\n\n  keys.forEach((k) => {\n    if (k in ele) {\n      let isNum = false;\n      defineProperty($ele, k, {\n        enumerable: true,\n        get: () => {\n          let val = ele[k];\n          if (isNum) {\n            if (/\\D/.test(val)) {\n              isNum = false;\n            } else {\n              val = Number(val);\n            }\n          }\n          return val;\n        },\n        set: (val) => {\n          isNum = typeof val === \"number\";\n          ele[k] = val;\n        },\n      });\n    }\n  });\n};\n\nconst formEleNames = new Set([\n  ...hasValueEleNames,\n  \"option\",\n  \"button\",\n  \"label\",\n  \"fieldset\",\n  \"legend\",\n  \"form\",\n]);\n\nconst bindProp = ($ele, opts = {}) => {\n  const { name: keyName, type } = opts;\n\n  const { ele } = $ele;\n  let old = ele[keyName];\n\n  $ele.on(type, () => {\n    emitUpdate({\n      type: \"set\",\n      target: $ele,\n      currentTarget: $ele,\n      name: keyName,\n      value: ele[keyName],\n      oldValue: old,\n    });\n\n    old = ele[keyName];\n  });\n};\n\nexport const initFormEle = ($ele) => {\n  const { tag } = $ele;\n\n  if (!formEleNames.has(tag)) {\n    return;\n  }\n\n  setKeys([\"type\", \"name\", \"disabled\"], $ele);\n\n  switch (tag) {\n    case \"input\":\n      initInput($ele);\n      break;\n    case \"textarea\":\n      setKeys([\"value\"], $ele);\n      bindProp($ele, { name: \"value\", type: \"input\" });\n      break;\n    case \"option\":\n      setKeys([\"selected\", \"value\"], $ele);\n      break;\n    case \"select\":\n      {\n        const { ele } = $ele;\n        $ele.__unupdate = 1;\n        $ele.value = ele.value;\n        delete $ele.__unupdate;\n\n        $ele.watch(() => {\n          ele.value = $ele.value;\n        });\n        $ele.on(\"change\", () => {\n          $ele.value = ele.value;\n        });\n      }\n      break;\n  }\n};\n\nconst initInput = ($ele) => {\n  const type = $ele.attr(\"type\");\n\n  switch (type) {\n    case \"file\":\n      setKeys([\"multiple\", \"files\"], $ele);\n      bindProp($ele, { name: \"files\", type: \"change\" });\n      break;\n    case \"checkbox\":\n      setKeys([\"checked\", \"multiple\", \"value\"], $ele);\n      bindProp($ele, { name: \"checked\", type: \"change\" });\n      break;\n    case \"radio\":\n      setKeys([\"checked\", \"value\"], $ele);\n      bindProp($ele, { name: \"checked\", type: \"change\" });\n      break;\n    case \"text\":\n    default:\n      setKeys([\"placeholder\", \"value\"], $ele);\n      bindProp($ele, { name: \"value\", type: \"input\" });\n      break;\n  }\n};\n\nconst getFormData = (target, expr) => {\n  const data = {};\n\n  target.all(expr).forEach(($el) => {\n    const { name, tag, ele } = $el;\n\n    if (tag === \"input\") {\n      switch ($el.type) {\n        case \"checkbox\":\n          if (!(name in data)) {\n            data[name] = [];\n          }\n\n          if (ele.checked) {\n            data[name].push(ele.value);\n          }\n          break;\n        case \"radio\":\n          if (ele.checked) {\n            data[name] = ele.value;\n          }\n          break;\n        case \"file\":\n          data[name] = ele.files;\n          break;\n        default:\n          data[name] = ele.value;\n      }\n    } else if (tag === \"textarea\") {\n      data[name] = ele.value;\n    } else if (tag === \"select\") {\n      const selectedsOpt = searchEle(ele, `option:checked`);\n\n      if (ele.multiple) {\n        data[name] = selectedsOpt.map((e) => e.value || e.textContent);\n      } else {\n        const [e] = selectedsOpt;\n        data[name] = e.value || e.textContent;\n      }\n    } else {\n      // custom element\n      data[name] = $el.value;\n    }\n  });\n\n  return data;\n};\n\nexport default {\n  // This method is still being tested\n  formData(expr, opts = { wait: 200 }) {\n    const data = stanz({});\n\n    assign(data, getFormData(this, expr || \"input,select,textarea\"));\n\n    const wid1 = this.watchTick((e) => {\n      const newData = getFormData(this, expr || \"input,select,textarea\");\n      mergeObjects(data, newData);\n    }, opts.wait);\n\n    const wid2 = data.watchTick((e) => {\n      resetValue(this, expr || \"input,select,textarea\", data);\n    });\n\n    const _this = this;\n\n    const oldRevoke = data.revoke;\n    data.extend({\n      revoke() {\n        _this.unwatch(wid1);\n        data.unwatch(wid2);\n        oldRevoke.call(this);\n      },\n    });\n\n    return data;\n  },\n};\n\nfunction resetValue(el, expr, data) {\n  const eles = el.all(expr);\n\n  Object.keys(data).forEach((name) => {\n    const targets = eles.filter((e) => e.attr(\"name\") === name);\n\n    if (targets.length === 0) {\n      return;\n    }\n\n    const val = data[name];\n    const target = targets[0];\n    const type = target.attr(\"type\");\n    if (targets.length === 1) {\n      let isUseValue = true;\n\n      if (target.tag === \"input\" && (type === \"radio\" || type === \"checkbox\")) {\n        isUseValue = false;\n      }\n\n      if (isUseValue) {\n        if (target.value !== val) {\n          target.value = val;\n        }\n        return;\n      }\n    }\n\n    // checkbox or radio\n    targets.forEach((e) => {\n      switch (e.attr(\"type\")) {\n        case \"radio\":\n          if (e.value === val) {\n            e.checked = true;\n          } else {\n            e.checked = false;\n          }\n          break;\n        case \"checkbox\":\n          e.checked = val.includes(e.value);\n          break;\n      }\n    });\n  });\n}\n","import { getType } from \"../stanz/public.mjs\";\n\nconst cssHandler = {\n  set(target, key, value, receiver) {\n    target._ele.style[key] = value;\n    Reflect.set(target, key, value, receiver);\n    return true;\n  },\n  get(target, key, receiver) {\n    if (key === \"length\") {\n      return 0;\n    }\n\n    const { style } = target._ele;\n    if (Array.from(style).includes(key)) {\n      return style[key];\n    }\n\n    return getComputedStyle(target._ele)[key];\n  },\n};\n\nclass XhearCSS {\n  constructor($el) {\n    const obj = {};\n\n    Object.defineProperty(obj, \"_ele\", {\n      enumerable: false,\n      get: () => $el.ele,\n    });\n\n    const { style } = $el.ele;\n\n    Array.from(style).forEach((key) => {\n      obj[key] = style[key];\n    });\n\n    return ($el._css = new Proxy(obj, cssHandler));\n  }\n}\n\nexport default {\n  get css() {\n    return new XhearCSS(this);\n  },\n  set css(d) {\n    if (getType(d) == \"string\") {\n      this.ele.style = d;\n      return;\n    }\n\n    let { style } = this;\n\n    // Covering the old style\n    let nextKeys = Object.keys(d);\n\n    // Clear the unused key\n    Array.from(style).forEach((k) => {\n      if (!nextKeys.includes(k)) {\n        style[k] = \"\";\n      }\n    });\n\n    Object.assign(style, d);\n  },\n};\n","import { getErr } from \"../ofa-error/main.js\";\nimport { getType } from \"../stanz/public.mjs\";\nimport {\n  hyphenToUpperCase,\n  capitalizeFirstLetter,\n  toDashCase,\n} from \"./public.mjs\";\nimport { convert, render } from \"./render/render.mjs\";\nimport { eleX } from \"./util.mjs\";\n\nconst COMPS = {};\n\nexport const renderElement = ({ defaults, ele, template, temps }) => {\n  let $ele;\n\n  try {\n    const data = {\n      ...deepCopyData(defaults.data, defaults.tag),\n      ...defaults.attrs,\n    };\n\n    defaults.attrs &&\n      Object.keys(defaults.attrs).forEach((name) => {\n        const value = ele.getAttribute(toDashCase(name));\n        if (value !== null && value !== undefined) {\n          data[name] = value;\n        }\n      });\n\n    $ele = eleX(ele);\n\n    defaults.proto && $ele.extend(defaults.proto, { enumerable: false });\n\n    for (let [key, value] of Object.entries(data)) {\n      if (!$ele.hasOwnProperty(key)) {\n        $ele[key] = value;\n      }\n    }\n\n    if (defaults.temp) {\n      const root = ele.attachShadow({ mode: \"open\" });\n\n      root.innerHTML = template.innerHTML;\n\n      render({\n        target: root,\n        data: $ele,\n        temps,\n      });\n    }\n\n    defaults.ready && defaults.ready.call($ele);\n  } catch (error) {\n    throw getErr(\n      \"xhear_reander_err\",\n      {\n        tag: ele.tagName.toLowerCase(),\n      },\n      error\n    );\n  }\n\n  if (defaults.watch) {\n    const wen = Object.entries(defaults.watch);\n\n    $ele.watchTick((e) => {\n      for (let [name, func] of wen) {\n        const names = name.split(\",\");\n\n        if (names.length >= 2) {\n          if (names.some((name) => e.hasModified(name))) {\n            func.call(\n              $ele,\n              names.map((name) => $ele[name]),\n              {\n                watchers: e,\n              }\n            );\n          }\n        } else {\n          if (e.hasModified(name)) {\n            func.call($ele, $ele[name], {\n              watchers: e,\n            });\n          }\n        }\n      }\n    });\n\n    for (let [name, func] of wen) {\n      const names = name.split(\",\");\n      if (names.length >= 2) {\n        func.call(\n          $ele,\n          names.map((name) => $ele[name]),\n          {}\n        );\n      } else {\n        func.call($ele, $ele[name], {});\n      }\n    }\n  }\n};\n\nexport const register = (opts = {}) => {\n  const defaults = {\n    // Registered component name\n    tag: \"\",\n    // Body content string\n    temp: \"\",\n    // Initialization data after element creation\n    data: {},\n    // Values that will not be traversed\n    proto: {},\n    // Keys bound to attributes\n    // attrs: {},\n    // The listener function for the element\n    // watch: {},\n    // Function triggered when the component is created (data initialization complete)\n    // created() { },\n    // Function triggered after component data initialization is complete (initial rendering completed)\n    // ready() { },\n    // Functions that are added to the document trigger\n    // attached() { },\n    // Functions triggered by moving out of the document\n    // detached() { },\n    // The container element is changed\n    // slotchange() { }\n    ...opts,\n  };\n\n  let template, temps, name;\n\n  try {\n    validateTagName(defaults.tag);\n\n    defaults.data = deepCopyData(defaults.data, defaults.tag);\n\n    name = capitalizeFirstLetter(hyphenToUpperCase(defaults.tag));\n\n    if (COMPS[name]) {\n      throw getErr(\"xhear_register_exists\", { name });\n    }\n\n    template = document.createElement(\"template\");\n    template.innerHTML = defaults.temp;\n    temps = convert(template);\n  } catch (error) {\n    throw getErr(\"xhear_register_err\", { tag: defaults.tag }, error);\n  }\n\n  const getAttrKeys = (attrs) => {\n    let attrKeys;\n\n    if (attrs instanceof Array) {\n      attrKeys = [...attrs];\n    } else {\n      attrKeys = Object.keys(attrs);\n    }\n\n    return attrKeys;\n  };\n\n  const XElement = (COMPS[name] = class extends HTMLElement {\n    constructor(...args) {\n      super(...args);\n\n      const $ele = eleX(this);\n\n      defaults.created && defaults.created.call($ele);\n\n      if (defaults.attrs) {\n        const attrKeys = getAttrKeys(defaults.attrs);\n\n        // fix self attribule value\n        $ele.watchTick((e) => {\n          attrKeys.forEach((key) => {\n            if (e.hasModified(key)) {\n              const val = $ele[key];\n              const attrName = toDashCase(key);\n              const oldVal = this.getAttribute(attrName);\n              if (val === null || val === undefined) {\n                this.removeAttribute(attrName);\n              } else if (oldVal !== val) {\n                let reval = val;\n\n                const valType = getType(val);\n\n                if (valType === \"number\" && oldVal === String(val)) {\n                  // Setting the number will cause an infinite loop\n                  return;\n                }\n                if (valType === \"object\") {\n                  // Setting the object will cause an infinite loop\n                  reval = JSON.stringify(reval);\n                  if (reval === oldVal) {\n                    return;\n                  }\n                }\n\n                this.setAttribute(attrName, reval);\n              }\n            }\n          });\n        });\n\n        // The data set before initialization needs to be reflected in attrs\n        attrKeys.forEach((key) => {\n          if (\n            $ele[key] !== null &&\n            $ele[key] !== undefined &&\n            $ele[key] !== defaults.attrs[key]\n          ) {\n            this.setAttribute(toDashCase(key), $ele[key]);\n          }\n        });\n      }\n\n      renderElement({\n        defaults,\n        ele: this,\n        template,\n        temps,\n      });\n    }\n\n    connectedCallback() {\n      if (isInternal(this)) {\n        return;\n      }\n\n      defaults.attached && defaults.attached.call(eleX(this));\n    }\n\n    disconnectedCallback() {\n      if (isInternal(this)) {\n        return;\n      }\n\n      defaults.detached && defaults.detached.call(eleX(this));\n    }\n\n    attributeChangedCallback(name, oldValue, newValue) {\n      const $ele = eleX(this);\n\n      if (!/[^\\d.]/.test(newValue) && typeof $ele[name] === \"number\") {\n        newValue = Number(newValue);\n      }\n\n      $ele[hyphenToUpperCase(name)] = newValue;\n    }\n\n    static get observedAttributes() {\n      return getAttrKeys(defaults.attrs || {}).map((e) => toDashCase(e));\n    }\n  });\n\n  if (document.readyState !== \"loading\") {\n    customElements.define(defaults.tag, XElement);\n  } else {\n    const READYSTATE = \"readystatechange\";\n    let f;\n    document.addEventListener(\n      READYSTATE,\n      (f = () => {\n        customElements.define(defaults.tag, XElement);\n        document.removeEventListener(READYSTATE, f);\n      })\n    );\n  }\n};\n\nfunction isInternal(ele) {\n  let target = ele;\n\n  while (target) {\n    if (target.__internal) {\n      return true;\n    }\n\n    target = target.parentNode || target.host;\n\n    if (!target || (target.tagName && target.tagName === \"BODY\")) {\n      break;\n    }\n  }\n\n  return false;\n}\n\nfunction validateTagName(str) {\n  // Check if the string has at least one '-' character\n  if (!str.includes(\"-\")) {\n    throw getErr(\"xhear_tag_noline\", { str });\n  }\n\n  // Check if the string starts or ends with '-'\n  if (str.charAt(0) === \"-\" || str.charAt(str.length - 1) === \"-\") {\n    throw getErr(\"xhear_validate_tag\", { str });\n  }\n\n  // Check if the string has consecutive '-' characters\n  for (let i = 0; i < str.length - 1; i++) {\n    if (str.charAt(i) === \"-\" && str.charAt(i + 1) === \"-\") {\n      throw getErr(\"xhear_validate_tag\", { str });\n    }\n  }\n\n  return true;\n}\n\nfunction deepCopyData(obj, tag = \"\") {\n  if (obj instanceof Set || obj instanceof Map) {\n    throw getErr(\"xhear_regster_data_noset\", { tag });\n  }\n\n  if (obj instanceof Function) {\n    throw getErr(\"xhear_regster_data_nofunc\", { tag });\n  }\n\n  if (typeof obj !== \"object\" || obj === null) {\n    return obj;\n  }\n\n  const copy = Array.isArray(obj) ? [] : {};\n\n  for (let key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      copy[key] = deepCopyData(obj[key], tag);\n    }\n  }\n\n  return copy;\n}\n","import { renderExtends } from \"./render.mjs\";\nimport { isSafariBrowser } from \"../public.mjs\";\nimport { getErr } from \"../../ofa-error/main.js\";\n\nexport class FakeNode extends Comment {\n  constructor(markname) {\n    const tagText = `Fake Node${markname ? \": \" + markname : \"\"}`;\n\n    super(` ${tagText} --end `);\n\n    this._mark = markname;\n    this._inited = false;\n\n    const startCom = new Comment(` ${tagText} --start `);\n    startCom.__fake_end = this;\n\n    Object.defineProperty(this, \"_start\", {\n      value: startCom,\n    });\n  }\n\n  init() {\n    if (this._inited) {\n      return;\n    }\n\n    this.parentNode.insertBefore(this._start, this);\n    this._inited = true;\n  }\n\n  querySelector(expr) {\n    return this.__searchEl(expr, \"find\");\n  }\n\n  querySelectorAll(expr) {\n    return this.__searchEl(expr);\n  }\n\n  __searchEl(expr, funcName = \"filter\") {\n    const startParent = this.parentNode;\n    if (!startParent) return [];\n\n    const childs = this.children;\n\n    return Array.from(startParent.querySelectorAll(expr))[funcName]((e) => {\n      let par = e;\n      while (true) {\n        if (childs.includes(par)) {\n          return true;\n        }\n\n        par = par.parentNode;\n\n        if (!par) {\n          break;\n        }\n      }\n    });\n  }\n\n  insertBefore(newEle, target) {\n    const { parentNode } = this;\n\n    if (Array.from(parentNode.children).includes(target)) {\n      parentNode.insertBefore(newEle, target);\n    } else {\n      parentNode.insertBefore(newEle, this);\n    }\n  }\n\n  appendChild(newEle) {\n    this.parentNode.insertBefore(newEle, this);\n  }\n\n  get children() {\n    const childs = [];\n\n    let prev = this;\n    while (true) {\n      prev = prev.previousSibling;\n\n      if (prev) {\n        if (prev instanceof HTMLElement) {\n          childs.unshift(prev);\n        } else if (prev === this._start) {\n          break;\n        }\n      } else {\n        throw getErr(\"xhear_fakenode_unclose\", { name: \"children\" });\n      }\n    }\n\n    return childs;\n  }\n\n  get childNodes() {\n    const childs = [];\n\n    let prev = this;\n    while (true) {\n      prev = prev.previousSibling;\n\n      if (prev) {\n        if (prev === this._start) {\n          break;\n        }\n        childs.unshift(prev);\n      } else {\n        throw getErr(\"xhear_fakenode_unclose\", { name: \"childNodes\" });\n      }\n    }\n\n    return childs;\n  }\n\n  set innerHTML(val) {\n    this.childNodes.forEach((e) => {\n      e.remove();\n    });\n\n    const temp = document.createElement(\"template\");\n    temp.innerHTML = val;\n\n    Array.from(temp.content.childNodes).forEach((e) => {\n      this.appendChild(e);\n    });\n  }\n\n  get innerHTML() {\n    const { children } = this;\n    let content = \"\";\n\n    children.forEach((e) => {\n      content += e.outerHTML + \"\\n\";\n    });\n\n    return content;\n  }\n\n  get nextElementSibling() {\n    let next = this.nextSibling;\n\n    if (!next) {\n      return null;\n    }\n\n    if (next.__fake_end) {\n      return next.__fake_end;\n    }\n\n    if (next && !(next instanceof Element)) {\n      next = next.nextElementSibling;\n    }\n\n    return next;\n  }\n\n  get previousElementSibling() {\n    const { _start } = this;\n    let prev = _start.previousSibling;\n\n    if (!prev) {\n      return null;\n    }\n\n    if (prev instanceof FakeNode) {\n      return prev;\n    }\n\n    return _start.previousElementSibling;\n  }\n}\n\nconst replaceTempInit = (_this) => {\n  const parent = _this.parentNode;\n  if (parent) {\n    const parent = _this.parentNode;\n    Array.from(_this.content.children).forEach((e) => {\n      parent.insertBefore(e, _this);\n    });\n\n    _this.remove();\n  }\n};\n\nif (isSafariBrowser()) {\n  renderExtends.beforeRender = ({ target }) => {\n    let replaces = [];\n    while (true) {\n      replaces = Array.from(\n        target.querySelectorAll('template[is=\"replace-temp\"]')\n      );\n\n      if (!replaces.length) {\n        break;\n      }\n\n      replaces.forEach((temp) => {\n        replaceTempInit(temp);\n      });\n    }\n  };\n} else {\n  class ReplaceTemp extends HTMLTemplateElement {\n    constructor() {\n      super();\n      this.init();\n    }\n\n    init() {\n      replaceTempInit(this);\n    }\n\n    connectedCallback() {\n      this.init();\n    }\n  }\n\n  customElements.define(\"replace-temp\", ReplaceTemp, {\n    extends: \"template\",\n  });\n}\n","/**\n * `x-if` first replaces all neighboring conditional elements with token elements and triggers the rendering process once; the rendering process is triggered again after each `value` change.\n * The rendering process is as follows:\n * 1. First, collect all conditional elements adjacent to `x-if`.\n * 2. Mark these elements and wait for the `value` of each conditional element to be set successfully before proceeding to the next step.\n * 3. Based on the marking, perform a judgment operation asynchronously, the element that satisfies the condition first will be rendered; after successful rendering, the subsequent conditional elements will clear the rendered content.\n */\n\nimport { dataRevoked } from \"../../stanz/public.mjs\";\nimport { register } from \"../register.mjs\";\nimport { eleX, revokeAll } from \"../util.mjs\";\nimport { FakeNode } from \"./fake-node.mjs\";\nimport { render } from \"./render.mjs\";\n\nconst regOptions = {\n  data: {\n    value: null,\n    __rendered: false,\n  },\n  watch: {\n    value() {\n      if (!this._bindend) {\n        return;\n      }\n\n      this.refreshValue();\n    },\n  },\n  proto: {\n    refreshValue() {\n      clearTimeout(this._timer);\n      this._timer = setTimeout(() => {\n        const conditions = [this, ...this._others];\n\n        let isOK = false;\n\n        conditions.forEach((conditionEl) => {\n          if (isOK) {\n            // A success condition has preceded it, and any subsequent conditional elements should be clear\n            conditionEl._clearContent();\n            return;\n          }\n\n          if (conditionEl.value || conditionEl.tag === \"x-else\") {\n            isOK = true;\n            conditionEl._renderContent();\n          } else {\n            conditionEl._clearContent();\n          }\n        });\n        if (this._fake.parentNode) {\n          eleX(this._fake.parentNode).refresh();\n        }\n\n        // const fakeParent = eleX(this._fake.parentNode);\n        // fakeParent.refresh();\n        // fakeParent.host && fakeParent.host.refresh({ unupdate: 1 });\n      }, 0);\n    },\n    _renderContent() {\n      if (this.__rendered) {\n        return;\n      }\n      this.__rendered = true;\n\n      const result = getRenderData(this._fake);\n\n      if (!result) {\n        return;\n      }\n\n      const { target, data, temps } = result;\n\n      if (dataRevoked(data)) {\n        return;\n      }\n\n      this._fake.innerHTML = this.__originHTML;\n\n      render({ target, data, temps });\n\n      this.emit(\"rendered\", {\n        bubbles: false,\n      });\n    },\n    _clearContent() {\n      if (!this.__rendered) {\n        return;\n      }\n\n      this.__rendered = false;\n\n      revokeAll(this._fake);\n      this._fake.innerHTML = \"\";\n\n      this.emit(\"clear\", {\n        bubbles: false,\n      });\n    },\n    init() {\n      if (this._bindend) {\n        return;\n      }\n\n      this._bindend = true;\n      const fake = (this._fake = new FakeNode(this.tag));\n      this.before(fake);\n      fake.init();\n      this.remove();\n\n      // 给 else-if 添加 _xif，给 else 初始化\n      if (this.tag === \"x-if\") {\n        const others = (this._others = []);\n\n        let next = fake;\n        while (true) {\n          next = next.nextElementSibling;\n\n          if (!next) {\n            break;\n          }\n\n          switch (next.tagName) {\n            case \"X-ELSE\": {\n              const $el = eleX(next);\n              if ($el.init) {\n                $el.init();\n              } else {\n                $el._if_ready = 1;\n              }\n\n              others.push($el);\n              return;\n            }\n            case \"X-ELSE-IF\": {\n              const $el = eleX(next);\n\n              $el._xif = this;\n\n              others.push($el);\n              break;\n            }\n            default:\n              break;\n          }\n        }\n      }\n    },\n  },\n  created() {\n    this.__originHTML = this.$(\"template[condition]\").html;\n    this.html = \"\";\n  },\n  ready() {\n    if (this.ele._bindingRendered) {\n      this.init();\n    } else {\n      this.one(\"binding-rendered\", () => this.init());\n    }\n  },\n};\n\nregister({\n  tag: \"x-if\",\n  ...regOptions,\n});\n\nregister({\n  tag: \"x-else-if\",\n  ...regOptions,\n  watch: {\n    value() {\n      if (!this._bindend) {\n        return;\n      }\n\n      if (this._xif) {\n        this._xif.refreshValue();\n      }\n    },\n  },\n});\n\nregister({\n  tag: \"x-else\",\n  ...regOptions,\n  watch: {},\n  ready() {\n    if (this._if_ready) {\n      this.init();\n    }\n  },\n});\n\nexport const getRenderData = (target) => {\n  while (target && !target.__render_data) {\n    target = target.parentNode;\n  }\n\n  if (target) {\n    return {\n      target,\n      data: target.__render_data,\n      temps: target.__render_temps,\n    };\n  }\n\n  return null;\n};\n","import { register } from \"../register.mjs\";\nimport { render } from \"./render.mjs\";\nimport { FakeNode } from \"./fake-node.mjs\";\nimport Stanz from \"../../stanz/main.mjs\";\nimport { createXEle, eleX, revokeAll } from \"../util.mjs\";\nimport { removeArrayValue } from \"../public.mjs\";\nimport { getRenderData } from \"./condition.mjs\";\nimport { getErr } from \"../../ofa-error/main.js\";\n\nregister({\n  tag: \"x-fill\",\n  data: {\n    value: null,\n  },\n  watch: {\n    value(value, t) {\n      this.refreshValue(t?.watchers);\n    },\n  },\n  proto: {\n    refreshValue(watchers) {\n      const arrayData = this.value;\n\n      if (!this._bindend) {\n        return;\n      }\n\n      const childs = this._fake.children;\n\n      if (!arrayData) {\n        childs.forEach((e) => revokeAll(e));\n        this._fake.innerHTML = \"\";\n        return;\n      }\n\n      if (!(arrayData instanceof Array)) {\n        console.warn(\n          `The value of x-fill component must be of type Array, and the type of the current value is ${getType(\n            arrayData\n          )}`\n        );\n\n        childs &&\n          childs.forEach((el) => {\n            revokeAll(el);\n            el.remove();\n          });\n        return;\n      }\n\n      const regData = getRenderData(this._fake);\n\n      if (!regData) {\n        return;\n      }\n\n      const { data, temps } = regData;\n\n      const targetTemp = temps[this._name];\n\n      const keyName = this.attr(\"fill-key\") || \"xid\";\n\n      if (!childs.length) {\n        const frag = document.createDocumentFragment();\n\n        arrayData.forEach((e, i) => {\n          const $ele = createItem(\n            e,\n            temps,\n            targetTemp,\n            data.$host || data,\n            i,\n            keyName\n          );\n          frag.appendChild($ele.ele);\n        });\n\n        this._fake.appendChild(frag);\n      } else {\n        if (watchers) {\n          const isReplaced = watchers.some((e) => e.path.length <= 1);\n\n          if (!isReplaced) {\n            // It is not a replacement, it can be corrected by binding the item internally.\n            return;\n          }\n        }\n\n        const vals = arrayData.slice();\n        const valsKeys = new Set(\n          vals.map((e) => {\n            const val = e[keyName];\n            return val === undefined ? e : val;\n          })\n        );\n\n        const { parentNode } = this._fake;\n\n        if (keyName !== \"xid\" && vals.length !== valsKeys.size) {\n          const errDesc = \"fill key duplicates\";\n          console.error(errDesc);\n          console.log(\n            errDesc,\n            \",its parent node is:\",\n            parentNode,\n            \"host: \",\n            eleX(parentNode)?.host?.ele\n          );\n        }\n\n        // const positionKeys = childs.map((e) => e._data_xid || e);\n        // Delete non-existing projects in advance (used to improve performance, this step can be removed and the above comment is turned on)\n        const positionKeys = [];\n        for (let i = 0, len = childs.length; i < len; i++) {\n          const e = childs[i];\n          const key = e._data_xid || e;\n\n          if (!valsKeys.has(key)) {\n            // If it no longer exists, delete it in advance.\n            revokeAll(e);\n            e.remove();\n            childs.splice(i, 1);\n            len--;\n            i--;\n          } else {\n            positionKeys.push(key);\n          }\n        }\n\n        let target = this._fake._start;\n\n        const needRemoves = [];\n\n        let count = 0;\n\n        while (target) {\n          if (target === this._fake) {\n            if (vals.length) {\n              // We have reached the end, add all elements directly to the front\n              vals.forEach((item) => {\n                const $ele = createItem(\n                  item,\n                  temps,\n                  targetTemp,\n                  data.$host || data,\n                  count,\n                  keyName\n                );\n\n                count++;\n\n                // target.parentNode.insertBefore($ele.ele, target);\n                parentNode.insertBefore($ele.ele, target);\n              });\n            }\n            break;\n          }\n          if (!(target instanceof Element)) {\n            target = target.nextSibling;\n            continue;\n          }\n          const currentVal = vals.shift();\n          const isObj = currentVal instanceof Object;\n          const $tar = eleX(target);\n          const item = $tar.__item;\n\n          if (currentVal === undefined && !vals.length) {\n            // There will be no follow-up, just delete it directly\n            needRemoves.push(target);\n            target = target.nextSibling;\n            continue;\n          }\n\n          const oldId = positionKeys.indexOf(\n            isObj ? currentVal[keyName] : currentVal\n          );\n          if (oldId > -1) {\n            // If the key originally exists, perform key displacement.\n            const oldItem = childs[oldId];\n            if (\n              isObj\n                ? currentVal[keyName] !== item.$data[keyName]\n                : currentVal !== item.$data\n            ) {\n              // Adjust position\n              oldItem.__internal = 1;\n              // target.parentNode.insertBefore(oldItem, target);\n              parentNode.insertBefore(oldItem, target);\n              delete oldItem.__internal;\n              target = oldItem;\n            }\n\n            // Update object\n            const $old = eleX(oldItem);\n            if ($old.__item.$data !== currentVal) {\n              $old.__item.$data = currentVal;\n            }\n            $old.__item.$index = count;\n          } else {\n            // Add new element\n            const $ele = createItem(\n              currentVal,\n              temps,\n              targetTemp,\n              data.$host || data,\n              count,\n              keyName\n            );\n\n            // target.parentNode.insertBefore($ele.ele, target);\n            parentNode.insertBefore($ele.ele, target);\n            target = $ele.ele;\n          }\n\n          count++;\n          target = target.nextSibling;\n        }\n\n        if (needRemoves.length) {\n          needRemoves.forEach((e) => {\n            revokeAll(e);\n            e.remove();\n          });\n        }\n      }\n\n      if (this._fake.parentNode) {\n        eleX(this._fake.parentNode).refresh();\n      }\n\n      this.emit(\"rendered\", {\n        bubbles: false,\n      });\n    },\n    init() {\n      if (this._bindend) {\n        return;\n      }\n      this._bindend = true;\n      const fake = (this._fake = new FakeNode(\"x-fill\"));\n      this.before(fake);\n      fake.init();\n      this.remove();\n\n      this.refreshValue();\n    },\n  },\n  ready() {\n    this._name = this.attr(\"name\");\n\n    if (!this._name) {\n      const err = getErr(\"xhear_fill_tempname\", { name: this._name });\n      console.log(err, this.ele);\n      throw err;\n    }\n\n    if (this.ele._bindingRendered) {\n      this.init();\n    } else {\n      this.one(\"binding-rendered\", () => this.init());\n    }\n  },\n});\n\nconst createItem = ($data, temps, targetTemp, $host, $index, keyName) => {\n  const $ele = createXEle(targetTemp.innerHTML);\n\n  const itemData = new Stanz({\n    $data,\n    $ele,\n    $host,\n    $index,\n  });\n\n  render({\n    target: $ele.ele,\n    data: itemData,\n    temps,\n    $host,\n    isRenderSelf: true,\n  });\n\n  const revokes = $ele.ele.__revokes;\n\n  const revoke = () => {\n    removeArrayValue(revokes, revoke);\n    itemData.revoke();\n  };\n\n  revokes.push(revoke);\n\n  $ele.__item = itemData;\n  $ele.ele._data_xid = $data[keyName] || $data;\n\n  return $ele;\n};\n","import { createXEle, eleX } from \"./util.mjs\";\nimport { meetsEle, searchEle } from \"./public.mjs\";\nimport { handler } from \"./accessor.mjs\";\nimport renderFn from \"./render/render.mjs\";\nimport syncFn from \"./render/sync.mjs\";\nimport eventFn from \"./event.mjs\";\nimport LikeArray from \"./array.mjs\";\nimport formFn, { initFormEle } from \"./form.mjs\";\nimport cssFn from \"./css.mjs\";\nimport { extend } from \"../stanz/public.mjs\";\nimport Stanz, { constructor } from \"../stanz/main.mjs\";\nimport watchFn from \"../stanz/watch.mjs\";\nimport \"./render/condition.mjs\";\nimport \"./render/fill.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\nconst { defineProperties } = Object;\n\nconst init = ({ _this, ele, proxySelf }) => {\n  const descs = {\n    owner: {\n      get() {\n        const { parentNode } = ele;\n        const { _owner } = _this;\n        const arr = parentNode ? [eleX(parentNode), ..._owner] : [..._owner];\n        return new Set(arr);\n      },\n    },\n    ele: {\n      get: () => ele,\n    },\n  };\n\n  const tag = ele.tagName && ele.tagName.toLowerCase();\n\n  if (tag) {\n    descs.tag = {\n      enumerable: true,\n      value: tag,\n    };\n  }\n\n  defineProperties(_this, descs);\n\n  initFormEle(proxySelf);\n};\n\nexport default class Xhear extends LikeArray {\n  constructor({ ele }) {\n    super();\n\n    const proxySelf = constructor.call(this, {}, handler);\n\n    init({\n      _this: this,\n      ele,\n      proxySelf,\n    });\n\n    ele.__xhear__ = proxySelf;\n\n    return proxySelf;\n  }\n\n  get length() {\n    return this.ele && this.ele.children.length;\n  }\n\n  $(expr) {\n    let { ele } = this;\n    if (ele instanceof HTMLTemplateElement) {\n      ele = ele.content;\n    }\n\n    const target = ele.querySelector(expr);\n    return target ? eleX(target) : null;\n  }\n\n  all(expr) {\n    return searchEle(this.ele, expr).map(eleX);\n  }\n\n  extend(obj, desc) {\n    return extend(this, obj, desc);\n  }\n\n  get text() {\n    return this.ele.textContent;\n  }\n\n  set text(val) {\n    this.ele.textContent = val;\n  }\n\n  get html() {\n    return this.ele.innerHTML;\n  }\n\n  set html(val) {\n    this.ele.innerHTML = val;\n  }\n\n  get classList() {\n    return this.ele.classList;\n  }\n\n  get data() {\n    return this.ele.dataset;\n  }\n\n  get shadow() {\n    return eleX(this.ele.shadowRoot);\n  }\n\n  get root() {\n    const rootNode = this.ele.getRootNode();\n    return rootNode ? eleX(rootNode) : null;\n  }\n  get host() {\n    let root = this.ele.getRootNode();\n    let { host } = root;\n    return host instanceof Node ? eleX(host) : null;\n  }\n\n  get parent() {\n    let { parentNode } = this.ele;\n    return !parentNode || parentNode === document ? null : eleX(parentNode);\n  }\n\n  get parents() {\n    const parents = [];\n    let target = this;\n    while (target.parent) {\n      target = target.parent;\n      parents.push(target);\n    }\n    return parents;\n  }\n\n  get hosts() {\n    const hosts = [];\n    let target = this;\n    while (target.host) {\n      target = target.host;\n      hosts.push(target);\n    }\n    return hosts;\n  }\n\n  get next() {\n    const nextEle = this.ele.nextElementSibling;\n    return nextEle ? eleX(nextEle) : null;\n  }\n\n  after(val) {\n    const { next: nextEl } = this;\n\n    if (nextEl) {\n      nextEl.before(val);\n    } else {\n      this.parent.push(val);\n    }\n  }\n\n  get nexts() {\n    const { parent } = this;\n    const selfIndex = this.index;\n    return parent.filter((e, i) => i > selfIndex);\n  }\n\n  get prev() {\n    const prevEle = this.ele.previousElementSibling;\n    return prevEle ? eleX(prevEle) : null;\n  }\n\n  before(val) {\n    const $el = createXEle(val);\n    this.parent.ele.insertBefore($el.ele, this.ele);\n  }\n\n  get prevs() {\n    const { parent } = this;\n    const selfIndex = this.index;\n    return parent.filter((e, i) => i < selfIndex);\n  }\n\n  get siblings() {\n    return this.parent.filter((e) => e !== this);\n  }\n\n  get index() {\n    let { parentNode } = this.ele;\n\n    if (!parentNode) {\n      return null;\n    }\n\n    return Array.prototype.indexOf.call(parentNode.children, this.ele);\n  }\n\n  get style() {\n    return this.ele.style;\n  }\n\n  get width() {\n    return parseInt(getComputedStyle(this.ele).width) || 0;\n  }\n\n  get height() {\n    return parseInt(getComputedStyle(this.ele).height) || 0;\n  }\n\n  get clientWidth() {\n    return this.ele.clientWidth;\n  }\n\n  get clientHeight() {\n    return this.ele.clientHeight;\n  }\n\n  get offsetWidth() {\n    return this.ele.offsetWidth;\n  }\n\n  get offsetHeight() {\n    return this.ele.offsetHeight;\n  }\n\n  get outerWidth() {\n    let computedStyle = getComputedStyle(this.ele);\n    return (\n      this.ele.offsetWidth +\n      parseInt(computedStyle[\"margin-left\"]) +\n      parseInt(computedStyle[\"margin-right\"])\n    );\n  }\n\n  get outerHeight() {\n    let computedStyle = getComputedStyle(this.ele);\n    return (\n      this.ele.offsetHeight +\n      parseInt(computedStyle[\"margin-top\"]) +\n      parseInt(computedStyle[\"margin-bottom\"])\n    );\n  }\n\n  is(expr) {\n    return meetsEle(this.ele, expr);\n  }\n\n  remove() {\n    const { parent } = this;\n    if (parent) {\n      parent.splice(parent.indexOf(this), 1);\n    }\n    // this.ele.remove();\n  }\n\n  clone(bool = true) {\n    return eleX(this.ele.cloneNode(bool));\n  }\n\n  wrap(content) {\n    const $el = createXEle(content);\n\n    const { ele } = this;\n\n    if (!ele.parentNode) {\n      throw getErr(\"xhear_wrap_no_parent\");\n    }\n\n    ele.parentNode.insertBefore($el.ele, ele);\n\n    ele.__internal = 1;\n\n    $el.ele.appendChild(ele);\n\n    delete ele.__internal;\n\n    return this;\n  }\n\n  unwrap() {\n    const { ele } = this;\n\n    const target = ele.parentNode;\n\n    if (target.children.length > 1) {\n      throw getErr(\"xhear_unwrap_has_siblings\");\n    }\n\n    ele.__internal = 1;\n\n    target.parentNode.insertBefore(ele, target);\n\n    target.remove();\n\n    delete ele.__internal;\n\n    return this;\n  }\n}\n\nconst sfn = Stanz.prototype;\nconst fn = Xhear.prototype;\n\nfn.extend(\n  {\n    get: sfn.get,\n    set: sfn.set,\n    toJSON: sfn.toJSON,\n    toString: sfn.toString,\n    ...watchFn,\n    ...eventFn,\n    ...renderFn,\n    ...syncFn,\n    ...formFn,\n  },\n  {\n    enumerable: false,\n  }\n);\n\nfn.extend(cssFn);\n","import Xhear from \"./main.mjs\";\nimport { getType } from \"../stanz/public.mjs\";\n\nexport const eleX = (ele) => {\n  if (!ele) return null;\n\n  if (ele.__xhear__) {\n    return ele.__xhear__;\n  }\n\n  return new Xhear({ ele });\n};\n\nexport const objToXEle = (obj) => {\n  const data = { ...obj };\n\n  if (!obj.tag) {\n    return null;\n  }\n\n  const ele = document.createElement(obj.tag);\n  delete data.tag;\n  const $ele = eleX(ele);\n\n  Object.assign($ele, data);\n\n  return $ele;\n};\n\nconst temp = document.createElement(\"template\");\n\nexport const strToXEle = (str) => {\n  temp.innerHTML = str;\n  const ele = temp.content.children[0] || temp.content.childNodes[0];\n  temp.innerHTML = \"\";\n\n  return eleX(ele);\n};\n\nexport const createXEle = (expr, exprType) => {\n  if (expr instanceof Xhear) {\n    return expr;\n  }\n\n  if (expr instanceof Node || expr === window) {\n    return eleX(expr);\n  }\n\n  const type = getType(expr);\n\n  switch (type) {\n    case \"object\":\n      return objToXEle(expr);\n    case \"string\":\n      return strToXEle(expr);\n  }\n};\n\nexport const revokeAll = (target) => {\n  if (target.__revokes) {\n    Array.from(target.__revokes).forEach((f) => f && f());\n  }\n  target.childNodes &&\n    Array.from(target.childNodes).forEach((el) => {\n      revokeAll(el);\n    });\n\n  const revokes = target?.shadowRoot?.__revokes;\n\n  if (revokes) {\n    [...revokes].forEach((f) => f());\n  }\n};\n","import { eleX, createXEle } from \"./util.mjs\";\nimport { getType } from \"../stanz/public.mjs\";\n\nexport default function $(expr) {\n  if (getType(expr) === \"string\" && !/<.+>/.test(expr)) {\n    const ele = document.querySelector(expr);\n\n    return eleX(ele);\n  }\n\n  return createXEle(expr);\n}\n\nObject.defineProperties($, {\n  // Convenient objects for use as extensions\n  extensions: {\n    value: {},\n  },\n});\n","import { getErr } from \"../ofa-error/main.js\";\nimport $ from \"../xhear/base.mjs\";\nimport { eleX } from \"../xhear/util.mjs\";\n\n$.register({\n  tag: \"inject-host\",\n  temp: `<slot></slot>`,\n  data: {},\n  proto: {\n    init() {\n      if (!this.ele.isConnected) {\n        return;\n      }\n\n      this.forEach((e) => this._init(e));\n    },\n\n    _init(e) {\n      if (e.ele.__inited) {\n        return;\n      }\n\n      switch (e.tag) {\n        case \"link\":\n          this._initLink(e);\n          break;\n        case \"style\":\n          this._initStyle(e);\n          break;\n        case \"x-if\":\n        case \"x-else-if\":\n        case \"x-else\":\n        case \"x-fill\":\n          // Components of a rendered nature do not need to be alerted\n          break;\n        default:\n          console.log(\n            `This element will be invalidated within the inject-host`,\n            e\n          );\n      }\n    },\n\n    _initLink(e) {\n      const href = e.attr(\"href\");\n\n      const rel = e.attr(\"rel\");\n\n      if (rel !== \"stylesheet\" && rel !== \"host\") {\n        throw getErr(\"inject-link-rel\");\n      }\n\n      let { ele } = e;\n\n      if (rel !== \"host\") {\n        e.attr(\"rel\", \"host\");\n        // It needs to be reset or it will contaminate itself\n        e.attr(\"href\", href);\n      }\n\n      ele.__inited = true;\n\n      ele._revoke = () => {\n        revokeLink(ele);\n        ele._revoke = null;\n      };\n\n      initInjectEle(\n        this,\n        href,\n        () => {\n          const newEl = e.clone();\n          newEl.attr(\"rel\", \"stylesheet\");\n          return newEl;\n        },\n        ele\n      );\n    },\n    async _initStyle(e) {\n      if (/data\\(.+?\\)/.test(e.html)) {\n        const err = getErr(\"use-data-inject\");\n        console.log(err, e.ele);\n        throw err;\n      }\n\n      // Use only the text inside the style to prevent contaminating yourself\n      const com = new Comment(e.html);\n      com.__inited = true;\n\n      com._revoke = () => {\n        revokeLink(e.ele);\n        delete com.__inited;\n        delete e.ele.__inited;\n        com._revoke = null;\n        e.ele._revoke = null;\n      };\n\n      e.html = \"\";\n      e.push(com);\n      e.ele.__inited = true;\n      e.ele._revoke = com._revoke;\n\n      // const hash = await getHash(com.data);\n      const hash = getStringHash(com.data);\n\n      initInjectEle(this, hash, () => $(`<style>${com.data}</style>`), e.ele);\n    },\n  },\n  attached() {\n    const observer = (this._obs = new MutationObserver((mutationsList) => {\n      for (let mutation of mutationsList) {\n        if (mutation.type === \"attributes\") {\n          if (mutation.attributeName === \"x-bind-data\") {\n            // x component render\n            continue;\n          }\n\n          // Logic for handling attribute changes\n          const { target } = mutation;\n\n          if (target.__inited) {\n            target._revoke();\n            this._init(eleX(target));\n          }\n        } else if (mutation.type === \"childList\") {\n          mutation.removedNodes.forEach((e) => {\n            if (e.__inited) {\n              e._revoke();\n            }\n          });\n\n          mutation.addedNodes.forEach((e) => {\n            if (!e.__inited) {\n              if (e instanceof Text) {\n                if (e.parentElement.tagName === \"STYLE\") {\n                  // change style text\n                  this.init(e.parentNode);\n                }\n              }\n\n              if (e.__inited) {\n                // Don't get involved if you've been initialized.\n                return;\n              }\n\n              if (e instanceof Text || e instanceof Comment) {\n                // Invalid content\n                return;\n              }\n\n              this._init(eleX(e));\n            }\n          });\n        }\n      }\n    }));\n\n    const config = { attributes: true, childList: true, subtree: true };\n\n    observer.observe(this.ele, config);\n\n    this.init();\n  },\n  detached() {\n    this.forEach((e) => revokeLink(e.ele));\n\n    this._obs.disconnect();\n  },\n});\n\nfunction getStringHash(str) {\n  let hash = 0;\n  let len = str.length;\n  for (let i = 0; i < len; i++) {\n    const charCode = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) ^ charCode;\n    hash = (hash << 13) | (hash >>> 19);\n    hash = hash * 7 - hash * 3;\n  }\n  return hash.toString(36) + \"--\" + len;\n}\n\nfunction initInjectEle(injectEl, mark, cloneFunc, item) {\n  const hostRoot = injectEl.host.root;\n\n  let clink = hostRoot.$(`[inject-host=\"${mark}\"]`);\n\n  if (clink) {\n    clink.ele.__items.add(item);\n    item.__host_link = clink;\n    return;\n  }\n\n  clink = cloneFunc();\n\n  clink.attr(\"inject-host\", mark);\n\n  clink.ele.__items = new Set([item]);\n  item.__host_link = clink;\n\n  const { root } = injectEl.host;\n  if (root.ele === document) {\n    document.head.appendChild(clink.ele);\n  } else {\n    root.root.push(clink);\n  }\n}\n\nfunction revokeLink(item) {\n  if (item.__inited && item.__host_link) {\n    const items = item.__host_link.ele.__items;\n    items.delete(item);\n\n    if (!items.size) {\n      item.__host_link.remove();\n    }\n\n    delete item.__inited;\n  }\n}\n","import { eleX } from \"./util.mjs\";\nimport { render, convert } from \"./render/render.mjs\";\nimport Xhear from \"./main.mjs\";\nimport stanz from \"../stanz/base.mjs\";\nimport { register } from \"./register.mjs\";\nimport { searchEle } from \"./public.mjs\";\nimport $ from \"./dollar.mjs\";\nimport { nextTick } from \"../stanz/public.mjs\";\n\nObject.assign($, {\n  stanz,\n  render,\n  convert,\n  register,\n  nextTick,\n  fn: Xhear.prototype,\n  all: (expr) => searchEle(document, expr).map(eleX),\n  frag: () => $(document.createDocumentFragment()),\n});\n\nexport default $;\n","const getOid = () => Math.random().toString(32).slice(2);\n\nexport default class Onion {\n  constructor() {\n    this._middlewares = new Map();\n  }\n\n  use(middleware) {\n    const oid = getOid();\n    this._middlewares.set(oid, middleware);\n    return oid;\n  }\n\n  unuse(oid) {\n    return this._middlewares.delete(oid);\n  }\n\n  async run(context) {\n    let index = -1;\n\n    const middlewares = Array.from(this._middlewares.values());\n\n    const next = async () => {\n      index++;\n      if (index < middlewares.length) {\n        await middlewares[index](context, next);\n      }\n    };\n\n    await next();\n  }\n}\n","import { getErr } from \"../ofa-error/main.js\";\nimport Onion from \"./onion.mjs\";\n\nexport const caches = new Map();\nexport const wrapFetch = async (url, params) => {\n  const d = new URL(url);\n\n  const reUrl = params.includes(\"-direct\") ? url : `${d.origin}${d.pathname}`;\n\n  let fetchObj = caches.get(reUrl);\n\n  if (!fetchObj) {\n    fetchObj = fetch(reUrl);\n    caches.set(reUrl, fetchObj);\n  }\n\n  const resp = await fetchObj;\n\n  return resp.clone();\n};\n\nexport const processor = {};\n\nconst addHandler = (name, handler) => {\n  const oni = processor[name] || (processor[name] = new Onion());\n  oni.use(handler);\n};\n\nexport const use = (name, handler) => {\n  if (name instanceof Function) {\n    handler = name;\n    name = [\"js\", \"mjs\"];\n  }\n\n  if (name instanceof Array) {\n    name.forEach((name) => {\n      addHandler(name, handler);\n    });\n    return;\n  }\n\n  addHandler(name, handler);\n};\n\nuse([\"mjs\", \"js\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n    const d = new URL(url);\n\n    const notHttp = /^blob:/.test(url) || /^data:/.test(url);\n    try {\n      if (notHttp || params.includes(\"-direct\")) {\n        ctx.result = await import(url);\n      } else {\n        ctx.result = await import(`${d.origin}${d.pathname}`);\n      }\n    } catch (error) {\n      const err = getErr(\n        \"load_module\",\n        {\n          url: ctx.realUrl || url,\n        },\n        error\n      );\n\n      if (notHttp) {\n        console.log(\"load failed:\", ctx.realUrl || url, \" ctx:\", ctx);\n      }\n\n      throw err;\n    }\n  }\n\n  await next();\n});\n\nuse([\"txt\", \"html\", \"htm\"], async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    let resp;\n    try {\n      resp = await wrapFetch(url, params);\n    } catch (error) {\n      throw getErr(\"load_fail\", { url }, error);\n    }\n\n    if (!/^2.{2}$/.test(resp.status)) {\n      throw getErr(\"load_fail_status\", {\n        url,\n        status: resp.status,\n      });\n    }\n\n    ctx.result = await resp.text();\n  }\n\n  await next();\n});\n\nuse(\"json\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    ctx.result = await wrapFetch(url, params).then((e) => e.json());\n  }\n\n  await next();\n});\n\nuse(\"wasm\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, params } = ctx;\n\n    const data = await wrapFetch(url, params).then((e) => e.arrayBuffer());\n\n    const module = await WebAssembly.compile(data);\n    const instance = new WebAssembly.Instance(module);\n\n    ctx.result = instance.exports;\n  }\n\n  await next();\n});\n\nuse(\"css\", async (ctx, next) => {\n  if (!ctx.result) {\n    const { url, element, params } = ctx;\n\n    if (element) {\n      const link = document.createElement(\"link\");\n      link.rel = \"stylesheet\";\n      link.href = url;\n\n      const root = element.getRootNode();\n\n      if (root === document) {\n        root.head.append(link);\n      } else {\n        root.appendChild(link);\n      }\n\n      let f;\n      element.addEventListener(\n        \"disconnected\",\n        (f = (e) => {\n          link.remove();\n          element.removeEventListener(\"disconnected\", f);\n        })\n      );\n    } else {\n      ctx.result = await wrapFetch(url, params).then((e) => e.text());\n    }\n  }\n\n  await next();\n});\n","import { getErr } from \"../ofa-error/main.js\";\n\nexport const aliasMap = {};\n\nexport default async function config(opts) {\n  const { alias } = opts;\n\n  if (alias) {\n    Object.entries(alias).forEach(([name, path]) => {\n      if (!/^@.+/.test(name)) {\n        throw getErr(\"config_alias_name_error\", {\n          name,\n        });\n      }\n\n      if (!aliasMap[name]) {\n        if (!/^\\./.test(path)) {\n          aliasMap[name] = path;\n        } else {\n          throw getErr(\"alias_relate_name\", {\n            name,\n            path,\n          });\n        }\n      } else {\n        throw getErr(\"alias_already\", {\n          name,\n        });\n      }\n    });\n  }\n  return true;\n}\n\nexport const path = (moduleName, baseURI) => {\n  if (moduleName.startsWith(\"http://\") || moduleName.startsWith(\"https://\")) {\n    return moduleName;\n  }\n\n  const [url, ...params] = moduleName.split(\" \");\n\n  let lastUrl = url;\n\n  if (/^@/.test(url)) {\n    const [first, ...args] = url.split(\"/\");\n\n    if (aliasMap[first]) {\n      lastUrl = [aliasMap[first].replace(/\\/$/, \"\"), ...args].join(\"/\");\n    } else {\n      throw getErr(\"no_alias\", {\n        name: first,\n        url: moduleName,\n      });\n    }\n  }\n\n  if (typeof location !== \"undefined\") {\n    const base = baseURI ? new URL(baseURI, location.href) : location.href;\n\n    const moduleURL = new URL(lastUrl, base);\n\n    lastUrl = moduleURL.href;\n  }\n\n  if (params.length) {\n    return `${lastUrl} ${params.join(\" \")}`;\n  }\n\n  return lastUrl;\n};\n","import { processor, use } from \"./use.mjs\";\nimport { aliasMap, path } from \"./config.mjs\";\nexport const LOADED = Symbol(\"loaded\");\n\nconst createLoad = (meta, opts) => {\n  if (!meta) {\n    meta = {\n      url: document.location.href,\n    };\n  }\n  const load = (ourl) => {\n    let [url, ...params] = ourl.split(\" \");\n\n    const reurl = path(url, meta.url);\n\n    return agent(reurl, { params, ...opts });\n  };\n  return load;\n};\n\nexport const agent = async (url, opts) => {\n  const urldata = new URL(url);\n  const { pathname } = urldata;\n\n  let type;\n  let realUrl = null;\n\n  opts.params &&\n    opts.params.forEach((e) => {\n      if (/^\\..+/.test(e)) {\n        type = e.replace(/^\\.(.+)/, \"$1\");\n      } else if (/^\\-\\-real/.test(e)) {\n        realUrl = e.replace(/^\\-\\-real\\:/, \"\");\n      }\n    });\n\n  if (!type) {\n    type = pathname.slice(((pathname.lastIndexOf(\".\") - 1) >>> 0) + 2);\n  }\n\n  const ctx = {\n    url,\n    result: null,\n    realUrl,\n    ...opts,\n  };\n\n  const oni = processor[type];\n\n  if (oni) {\n    await oni.run(ctx);\n  } else {\n    const result = await fetch(url);\n    const contentType = result.headers.get(\"Content-Type\");\n\n    const targetMapObject = [\n      [\"application/javascript\", \"js\"],\n      [\"application/json\", \"json\"],\n      [\"text/html\", \"html\"],\n      [\"text/xml\", \"xml\"],\n    ].find((e) => contentType.includes(e[0]));\n\n    let newOni;\n    if (targetMapObject) {\n      newOni = processor[targetMapObject[1]];\n    }\n\n    if (newOni) {\n      await newOni.run(ctx);\n    } else {\n      ctx.result = result;\n    }\n  }\n\n  if (opts && opts.element) {\n    const { element } = opts;\n    element[LOADED] = true;\n    const event = new Event(\"load\");\n    element.dispatchEvent(event);\n  }\n\n  if (opts.params && opts.params.includes(\"-ctx\")) {\n    return ctx;\n  }\n\n  return ctx.result;\n};\n\nexport default function lm(meta, opts) {\n  return createLoad(meta, opts);\n}\n\nObject.defineProperties(lm, {\n  use: {\n    value: use,\n  },\n  alias: {\n    get() {\n      return { ...aliasMap };\n    },\n  },\n});\n","import { agent, LOADED } from \"./main.mjs\";\n\nclass LoadModule extends HTMLElement {\n  constructor(...args) {\n    super(...args);\n\n    this[LOADED] = false;\n\n    Object.defineProperties(this, {\n      loaded: {\n        get: () => this[LOADED],\n      },\n    });\n\n    this._init();\n  }\n\n  _init() {\n    if (this.__initSrc || this.attributes.hasOwnProperty(\"pause\")) {\n      return;\n    }\n\n    let src = this.getAttribute(\"src\");\n\n    if (!src) {\n      return;\n      // throw `The ${this.tagName.toLowerCase()} element requires the src attribut `;\n    }\n    this.__initSrc = src;\n\n    const load = lm(undefined, {\n      element: this,\n    });\n\n    load(src);\n\n    Object.defineProperties(this, {\n      src: {\n        configurable: true,\n        value: src,\n      },\n    });\n  }\n\n  connectedCallback() {\n    const event = new CustomEvent(\"connected\");\n    event.root = this._root = this.getRootNode();\n    this.dispatchEvent(event);\n  }\n\n  disconnectedCallback() {\n    const event = new CustomEvent(\"disconnected\");\n    event.root = this._root;\n    delete this._root;\n    this.dispatchEvent(event);\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"src\") {\n      if (newValue && oldValue === null) {\n        this._init();\n      } else if (this.__initSrc && oldValue && newValue !== this.__initSrc) {\n        console.warn(\n          `${this.tagName.toLowerCase()} change src is invalid, only the first change will be loaded`\n        );\n        this.setAttribute(\"src\", this.__initSrc);\n      }\n    } else if (name === \"pause\" && newValue === null) {\n      this._init();\n    }\n  }\n\n  static get observedAttributes() {\n    return [\"src\", \"pause\"];\n  }\n}\n\nclass LM extends LoadModule {\n  constructor(...args) {\n    super(...args);\n  }\n}\n\nconst ready = () => {\n  customElements.define(\"load-module\", LoadModule);\n  customElements.define(\"l-m\", LM);\n  window.removeEventListener(\"load\", ready);\n};\n\nif (document.readyState === \"complete\") {\n  ready();\n} else {\n  window.addEventListener(\"load\", ready);\n}\n","import lm from \"./main.mjs\";\nimport \"./component.mjs\";\nimport config, { path } from \"./config.mjs\";\nlm.config = config;\nlm.path = path;\nObject.freeze(lm);\n\nwindow.lm = lm;\n\nexport default lm;\n","import { nextTick } from \"../stanz/public.mjs\";\nimport { searchEle } from \"../xhear/public.mjs\";\nimport { path } from \"../drill.js/config.mjs\";\nimport { eleX } from \"../xhear/util.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\n\nexport const resolvePath = path;\n\nexport function fixRelate(ele, path) {\n  searchEle(ele, \"[href],[src]\").forEach((el) => {\n    [\"href\", \"src\"].forEach((name) => {\n      const val = el.getAttribute(name);\n\n      if (/^#/.test(val)) {\n        return;\n      }\n\n      if (val && !/^(https?:)?\\/\\/\\S+/.test(val)) {\n        el.setAttribute(name, resolvePath(val, path));\n      }\n    });\n  });\n\n  searchEle(ele, \"template\").forEach((el) => {\n    fixRelate(el.content, path);\n  });\n}\n\nexport function fixRelatePathContent(content, path) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = content;\n\n  fixRelate(template.content, path);\n\n  // fix Resource references within style\n  searchEle(template.content, \"style\").forEach((styleEl) => {\n    const html = styleEl.innerHTML;\n\n    styleEl.innerHTML = html.replace(/url\\((.+)\\)/g, (original, adapted) => {\n      return `url(${resolvePath(adapted, path)})`;\n    });\n  });\n\n  return template.innerHTML;\n}\n\nexport const ISERROR = Symbol(\"loadError\");\n\nexport const getPagesData = async (src) => {\n  const load = lm({\n    url: src,\n  });\n  const pagesData = [];\n  let defaults;\n  let pageSrc = src;\n  let beforeSrc;\n  let errorObj;\n\n  while (true) {\n    try {\n      let lastSrc = pageSrc;\n      const [realPageSrc] = pageSrc.split(\" \");\n      const pageSrcObj = new URL(realPageSrc);\n      if (/\\/$/.test(pageSrcObj.pathname)) {\n        lastSrc += \" .html\";\n      }\n\n      defaults = await load(lastSrc);\n    } catch (error) {\n      let err;\n      if (beforeSrc) {\n        err = getErr(\n          \"page_wrap_fetch\",\n          {\n            before: beforeSrc,\n            current: pageSrc,\n          },\n          error\n        );\n      } else {\n        err = getErr(\n          \"load_page_module\",\n          {\n            url: pageSrc,\n          },\n          error\n        );\n      }\n      errorObj = err;\n\n      console.error(errorObj);\n    }\n\n    if (errorObj) {\n      pagesData.unshift({\n        src,\n        ISERROR,\n        error: errorObj,\n      });\n      break;\n    }\n\n    pagesData.unshift({\n      src: pageSrc,\n      defaults,\n    });\n\n    if (!defaults.parent) {\n      break;\n    }\n\n    beforeSrc = pageSrc;\n    pageSrc = resolvePath(defaults.parent, pageSrc);\n  }\n\n  return pagesData;\n};\n\nexport const createPage = (src, defaults) => {\n  // The $generated elements are not initialized immediately, so they need to be rendered in a normal container.\n  const tempCon = document.createElement(\"div\");\n\n  tempCon.innerHTML = `<o-page src=\"${src}\" data-pause-init=\"1\"></o-page>`;\n\n  const targetPage = eleX(tempCon.children[0]);\n\n  nextTick(async () => {\n    if (!targetPage._renderDefault) {\n      await waitPageReaded(targetPage);\n    }\n\n    targetPage._renderDefault(defaults);\n    targetPage.attr(\"data-pause-init\", null);\n  });\n\n  return targetPage;\n};\n\n// In the firefox environment, there will be a problem that the page component is not initialized, but the routing starts to be initialized in advance, resulting in an error. Therefore, wait for the page component to be initialized before continuing with the subsequent operations.\nexport const waitPageReaded = (page) => {\n  if (page._rendered) {\n    return;\n  }\n\n  return new Promise((resolve) => {\n    const timer = setInterval(() => {\n      if (page._rendered) {\n        clearInterval(timer);\n        resolve();\n      }\n    }, 500);\n  });\n};\n","import { nextTick } from \"../stanz/public.mjs\";\nimport $ from \"../xhear/base.mjs\";\nimport { fixRelate } from \"./public.mjs\";\nimport { renderExtends } from \"../xhear/render/render.mjs\";\n\nconst oldRender = renderExtends.render;\nrenderExtends.render = (e) => {\n  oldRender && oldRender(e);\n\n  const { step, name, target } = e;\n\n  const { link } = $.extensions;\n\n  if (step === \"init\") {\n    // Renders the component or page only once\n    if (target.host && link) {\n      $(target)\n        .all(\"a\")\n        .forEach((e) => link(e));\n    }\n  } else if (\n    name === \"attr\" &&\n    step === \"refresh\" &&\n    target.attr(\"olink\") === \"\"\n  ) {\n    const top = target.parents.pop() || target;\n\n    if (top.__fixLinkTimer) {\n      return;\n    }\n\n    top.__fixLinkTimer = nextTick(() => {\n      const { host } = target;\n\n      if (host && host.tag === \"o-page\") {\n        fixRelate(top.ele, host.src);\n      }\n\n      if (link) {\n        $(top)\n          .all(\"a\")\n          .forEach((e) => link(e));\n      }\n      delete top.__fixLinkTimer;\n    });\n  }\n};\n\nexport const initLink = (_this) => {\n  const $ele = $(_this);\n\n  // olink click to amend\n  $ele.on(\"click\", (e) => {\n    if (e.__processed) {\n      return;\n    }\n\n    const $tar = $(e.target);\n    const all = [$tar, ...$tar.parents];\n\n    let currentTarget = all.find((e) => e.tag === \"a\");\n    if (currentTarget) {\n      currentTarget = currentTarget.ele;\n    }\n\n    if (!currentTarget) {\n      return;\n    }\n\n    const targetVal = currentTarget.getAttribute(\"target\");\n    if (targetVal || currentTarget.getAttribute(\"download\")) {\n      return;\n    }\n\n    if (currentTarget.attributes.hasOwnProperty(\"olink\")) {\n      if ($ele.app) {\n        if (e.metaKey || e.shiftKey) {\n          return;\n        }\n\n        if (e.defaultPrevented) {\n          return;\n        }\n\n        e.preventDefault();\n\n        // Whether to abort the goto event\n        let prevented = false;\n        e.preventDefault = () => {\n          prevented = true;\n        };\n\n        e.__processed = true;\n\n        if (currentTarget.tagName === \"A\") {\n          const originHref = currentTarget.getAttribute(\"origin-href\");\n          // Prioritize the use of origin links\n          setTimeout(() => {\n            const finalHref = originHref || currentTarget.href;\n            finalHref && !prevented && $ele.app.goto(finalHref);\n          });\n        }\n      } else {\n        console.warn(\"olink is only allowed within o-apps\");\n      }\n    }\n  });\n};\n","import { resolvePath } from \"./public.mjs\";\nimport $ from \"../xhear/base.mjs\";\n\nconst strToBase64DataURI = async (str, type, isb64 = true) => {\n  const mime = type === \"js\" ? \"text/javascript\" : \"application/json\";\n\n  const file = new File([str], \"genfile\", { type: mime });\n\n  if (!isb64) {\n    return URL.createObjectURL(file);\n  }\n\n  const result = await new Promise((resolve) => {\n    const fr = new FileReader();\n\n    fr.onload = (e) => {\n      resolve(e.target.result);\n    };\n\n    fr.readAsDataURL(file);\n  });\n\n  return result;\n};\n\n// In the actual logical code, the generated code and the source code actually use the exact same logic, with only a change in line numbers. Therefore, it is only necessary to map the generated valid code back to the corresponding line numbers in the source file.\nconst getSourcemapUrl = async (filePath, originContent, startLine) => {\n  const originLineArr = originContent.split(\"\\n\");\n\n  let mappings = \"\";\n\n  for (let i = 0; i <= startLine; i++) {\n    mappings += \";\";\n  }\n\n  // Determine the starting line number of the source file.\n  const originStarRowIndex = originLineArr.findIndex(\n    (lineContent) => lineContent.trim() === \"<script>\"\n  );\n\n  // Determine the ending line number of the source file.\n  const originEndRowIndex = originLineArr.findIndex(\n    (lineContent) => lineContent.trim() === \"</script>\"\n  );\n\n  let beforeRowIndex = 0;\n  let beforeColIndex = 0;\n\n  for (let rowId = originStarRowIndex + 1; rowId < originEndRowIndex; rowId++) {\n    const target = originLineArr[rowId];\n\n    let rowStr = \"\";\n\n    Array.from(target).forEach((e, colId) => {\n      const currentStr = `AA${vlcEncode(rowId - beforeRowIndex)}${vlcEncode(\n        colId - beforeColIndex\n      )}`;\n\n      if (!rowStr) {\n        rowStr = currentStr;\n      } else {\n        rowStr += `,${currentStr}`;\n      }\n\n      beforeRowIndex = rowId;\n      beforeColIndex = colId;\n    });\n\n    mappings += `${rowStr};`;\n  }\n\n  const sourcesContent = JSON.stringify([originContent])\n    .replace(/^\\[/, \"\")\n    .replace(/\\]$/, \"\");\n\n  const str = `{\"version\": 3,\n    \"file\": \"${filePath\n      .replace(/\\?.+/, \"\")\n      .replace(/.+\\/(.+?)/, \"$1\")\n      .replace(\".html\", \".js\")}\",\n    \"sources\": [\"${filePath.replace(/\\?.+/, \"\")}\"],\n    \"sourcesContent\":[${sourcesContent}],\n    \"mappings\": \"${mappings}\"}`;\n\n  return await strToBase64DataURI(str, null);\n};\n\nconst cacheLink = new Map();\n\nexport async function drawUrl(content, url, isPage = true) {\n  let targetUrl = cacheLink.get(url);\n  if (targetUrl) {\n    return targetUrl;\n  }\n\n  let isDebug = true;\n\n  if ($.hasOwnProperty(\"debugMode\")) {\n    isDebug = $.debugMode;\n  }\n\n  const tempEl = $(\"<template></template>\");\n  tempEl.html = content;\n  const titleEl = tempEl.$(\"title\");\n\n  const targetTemp = tempEl.$(`template[${isPage ? \"page\" : \"component\"}]`);\n  const scriptEl = targetTemp.$(\"script\");\n\n  scriptEl && scriptEl.remove();\n\n  // If there is no content other than the <script>, then the shadow root is not set.\n  const hasTemp = !!targetTemp.html\n    .replace(/\\<\\!\\-\\-[\\s\\S]*?\\-\\-\\>/g, \"\")\n    .trim();\n  let temp = \"\";\n\n  if (hasTemp) {\n    temp =\n      \"<style>*:not(:defined){display:none;}</style>\" +\n      targetTemp.html\n        .replace(/\\s+$/, \"\")\n        .replace(/`/g, \"\\\\`\")\n        .replace(/\\$\\{/g, \"\\\\${\");\n  }\n\n  const beforeContent = `\n  export const type = ${isPage ? \"ofa.PAGE\" : \"ofa.COMP\"};\n  ${isPage && titleEl ? `export const title = '${titleEl.text}';` : \"\"}\n  export const temp = \\`${temp}\\`;`;\n\n  let scriptContent = \"\";\n  if (scriptEl) {\n    scriptContent = scriptEl.html\n      .split(/;/g)\n      .map((content) => {\n        const t_content = content.trim();\n        // Confirm it is an import reference and correct the address\n        if (/^import[ \\{'\"]/.test(t_content)) {\n          // Update address string directly\n          return content.replace(/['\"]([\\s\\S]+)['\"]/, (arg0, pathStr) => {\n            return `\"${resolvePath(pathStr, url)}\"`;\n          });\n        }\n        return content;\n      })\n      .join(\";\");\n  }\n\n  const fileContent = `${beforeContent};\n${scriptContent}`;\n\n  let sourcemapStr = \"\";\n\n  if (isDebug) {\n    sourcemapStr = `//# sourceMappingURL=${await getSourcemapUrl(\n      url,\n      content,\n      beforeContent.split(\"\\n\").length\n    )}`;\n  }\n\n  const finalContent = `${fileContent}\\n${sourcemapStr}`;\n\n  const isFirefox = navigator.userAgent.includes(\"Firefox\");\n\n  targetUrl = strToBase64DataURI(finalContent, \"js\", isFirefox ? false : true);\n\n  cacheLink.set(url, targetUrl);\n\n  return targetUrl;\n}\n\nconst base64 =\n  \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\nfunction toVLQSigned(value) {\n  return value < 0 ? (-value << 1) + 1 : (value << 1) + 0;\n}\n\nfunction vlcEncode(value) {\n  let encoded = \"\";\n  let vlq = toVLQSigned(value);\n\n  do {\n    let digit = vlq & 0b11111;\n    vlq >>>= 5;\n    if (vlq > 0) {\n      digit |= 0b100000;\n    }\n    encoded += base64[digit];\n  } while (vlq > 0);\n\n  return encoded;\n}\n","import lm from \"../drill.js/base.mjs\";\nimport $ from \"../xhear/base.mjs\";\nimport { renderElement } from \"../xhear/register.mjs\";\nimport { convert } from \"../xhear/render/render.mjs\";\nimport { searchEle, isFunction } from \"../xhear/public.mjs\";\nimport {\n  fixRelatePathContent,\n  resolvePath,\n  getPagesData,\n  createPage,\n  ISERROR,\n} from \"./public.mjs\";\nimport { initLink } from \"./link.mjs\";\nimport { nextTick } from \"../stanz/public.mjs\";\n\nimport { drawUrl } from \"./draw-template.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\n\nconst clone = (obj) => JSON.parse(JSON.stringify(obj));\n\nconst PAGE = Symbol(\"Page\");\n\nObject.defineProperty($, \"PAGE\", {\n  value: PAGE,\n});\n\nlm.use([\"html\", \"htm\"], async (ctx, next) => {\n  const { result: content, params } = ctx;\n\n  if (\n    content &&\n    /<template +page *>/.test(content) &&\n    !params.includes(\"-ignore-temp\")\n  ) {\n    try {\n      const url = await drawUrl(content, ctx.url);\n      ctx.result = await lm()(`${url} .mjs --real:${ctx.url}`);\n    } catch (error) {\n      throw getErr(\n        \"load_page_module\",\n        {\n          url: ctx.url,\n        },\n        error\n      );\n    }\n    ctx.resultContent = content;\n  }\n\n  await next();\n});\n\nlm.use([\"js\", \"mjs\"], async (ctx, next) => {\n  const { result: moduleData, url, realUrl } = ctx;\n  if (typeof moduleData !== \"object\" || moduleData.type !== PAGE) {\n    await next();\n    return;\n  }\n\n  const defaultsData = await getDefault(moduleData, realUrl || url);\n\n  let tempSrc = defaultsData.temp;\n\n  if (!/<.+>/.test(tempSrc)) {\n    if (tempSrc) {\n      tempSrc = resolvePath(tempSrc, url);\n    } else {\n      tempSrc = url.replace(/\\.m?js.*/, \".html\");\n    }\n\n    try {\n      defaultsData.temp = await fetch(tempSrc).then((e) => e.text());\n    } catch (error) {\n      const err = getErr(\n        \"fetch_temp_err\",\n        {\n          url: realUrl || url,\n          tempSrc,\n        },\n        error\n      );\n      self.emit(\"error\", { data: { error: err } });\n      throw err;\n    }\n  }\n\n  ctx.result = defaultsData;\n\n  await next();\n});\n\nsetTimeout(() => {\n  // Let the pod's running time be slower than the `type=\"module\"` time\n  $.register({\n    tag: \"o-page\",\n    attrs: {\n      src: null,\n    },\n    data: {\n      pageIsReady: null,\n    },\n    watch: {\n      async src(src) {\n        if (!src) {\n          return;\n        }\n\n        if (!src.startsWith(\"//\") && !/[a-z]+:\\/\\//.test(src)) {\n          src = resolvePath(src);\n          this.src = src;\n          return;\n        }\n\n        if (this.__init_src) {\n          if (this.__init_src !== src) {\n            throw Error(\n              \"A page that has already been initialized cannot be set with the src attribute\"\n            );\n          }\n          return;\n        }\n\n        this.__init_src = src;\n\n        if (this._defaults || this.attr(\"data-pause-init\")) {\n          return;\n        }\n\n        const pagesData = await getPagesData(src);\n\n        if (this._defaults) {\n          return;\n        }\n\n        const target = pagesData.pop();\n\n        pagesData.forEach((e, i) => {\n          const parentPage = createPage(e.src, e.defaults);\n\n          if (this.parent) {\n            this.wrap(parentPage);\n          } else {\n            const needWraps = this.__need_wraps || (this.__need_wraps = []);\n            needWraps.push(parentPage);\n          }\n        });\n\n        if (target.ISERROR === ISERROR) {\n          const failContent = getFailContent(\n            src,\n            target,\n            this?.app?._module?.fail\n          );\n\n          this._renderDefault({\n            type: PAGE,\n            temp: failContent,\n          });\n        } else {\n          this._renderDefault(target.defaults);\n        }\n      },\n    },\n    attached() {\n      // this.css.display = \"block\";\n\n      const needWraps = this.__need_wraps;\n      if (needWraps) {\n        needWraps.forEach((page) => {\n          this.wrap(page);\n        });\n        delete this.__need_wraps;\n      }\n\n      if (this.__not_run_attached) {\n        if (this._defaults.attached) {\n          this._defaults.attached.call(this);\n        }\n        delete this.__not_run_attached;\n      }\n    },\n    detached() {\n      const { _defaults } = this;\n\n      if (_defaults && _defaults.detached) {\n        _defaults.detached.call(this);\n      }\n    },\n    proto: {\n      async _renderDefault(defaults) {\n        const { src } = this;\n\n        if (this._defaults) {\n          const err = getErr(\"page_no_defaults\", { src });\n          console.log(err, this);\n          throw err;\n        }\n\n        this._defaults = defaults;\n\n        if (defaults.pageAnime) {\n          this._pageAnime = defaults.pageAnime;\n        }\n\n        if (!defaults || defaults.type !== PAGE) {\n          const err = getErr(\"not_page_module\", { src });\n          console.log(err, this);\n          this.emit(\"error\", { data: { error: err } });\n          this.__reject(err);\n          throw err;\n        }\n\n        const template = document.createElement(\"template\");\n        template.innerHTML = fixRelatePathContent(defaults.temp, src);\n        const temps = convert(template);\n\n        try {\n          renderElement({\n            defaults,\n            ele: this.ele,\n            template,\n            temps,\n          });\n        } catch (error) {\n          const err = getErr(\"page_failed\", { src }, error);\n          console.error(err);\n          console.log(err, this);\n        }\n\n        await dispatchLoad(this, defaults.loaded);\n\n        initLink(this.shadow);\n\n        this.emit(\"page-loaded\");\n\n        this.__resolve();\n\n        this.pageIsReady = 1;\n\n        const { app } = this;\n        if (app && !app.appIsReady) {\n          nextTick(() => {\n            app.appIsReady = 1;\n          });\n        }\n\n        if (this.ele.isConnected) {\n          if (defaults.attached) {\n            defaults.attached.call(this);\n          }\n        } else {\n          this.__not_run_attached = 1;\n        }\n      },\n      back() {\n        this.app.back();\n      },\n      goto(src) {\n        this.app.goto(resolvePath(src, this.src));\n      },\n      replace(src) {\n        this.app.replace(resolvePath(src, this.src));\n      },\n      get pageAnime() {\n        const { app, _pageAnime } = this;\n\n        const { pageAnime } = app?._module || {};\n\n        return clone({ ...pageAnime, ...(_pageAnime || {}) });\n      },\n      set pageAnime(val) {\n        this._pageAnime = val;\n      },\n    },\n\n    ready() {\n      this._rendered = new Promise((resolve, reject) => {\n        this.__resolve = () => {\n          delete this.__resolve;\n          delete this.__reject;\n          resolve();\n        };\n        this.__reject = () => {\n          delete this.__resolve;\n          delete this.__reject;\n          reject();\n        };\n      });\n    },\n  });\n});\n\nexport const dispatchLoad = async (_this, loaded) => {\n  const shadow = _this.ele.shadowRoot;\n\n  if (shadow) {\n    const srcEles = searchEle(shadow, `l-m,load-module`);\n    const pms = srcEles.map(\n      (el) =>\n        new Promise((res) => {\n          el.addEventListener(\"load\", (e) => {\n            res();\n          });\n        })\n    );\n\n    const links = searchEle(shadow, `link`);\n\n    links.forEach((link) => {\n      if (link.rel === \"stylesheet\") {\n        pms.push(\n          new Promise((res) => {\n            let resolve = () => {\n              clearInterval(timer);\n              link.removeEventListener(\"load\", resolve);\n              link.removeEventListener(\"error\", resolve);\n              res();\n            };\n            const timer = setInterval(() => {\n              if (!link.parentNode) {\n                resolve();\n              }\n            }, 100);\n\n            if (link.sheet) {\n              resolve();\n            } else {\n              link.addEventListener(\"load\", resolve);\n              link.addEventListener(\"error\", resolve);\n            }\n          })\n        );\n      }\n    });\n\n    await Promise.all(pms);\n  }\n\n  if (loaded) {\n    loaded.call(_this);\n  }\n};\n\nexport const getDefault = async (moduleData, url) => {\n  let finnalDefault = {};\n\n  const { default: defaultData } = moduleData;\n\n  const relateLoad = lm({\n    url,\n  });\n\n  if (isFunction(defaultData)) {\n    finnalDefault = await defaultData({\n      load: relateLoad,\n      url,\n      get query() {\n        const urlObj = new URL(url);\n        return Object.fromEntries(Array.from(urlObj.searchParams.entries()));\n      },\n    });\n  } else if (defaultData instanceof Object) {\n    finnalDefault = { ...defaultData };\n  }\n\n  const defaults = {\n    proto: {},\n    ...moduleData,\n    ...finnalDefault,\n  };\n\n  return defaults;\n};\n\nexport const getFailContent = (src, target, fail) => {\n  let failContent;\n\n  if (fail) {\n    failContent = fail({\n      src,\n      error: target.error,\n    });\n  } else {\n    failContent = `<div style=\"padding:20px;color:red;\">${target.error.stack\n      .replace(/\\n/g, \"<br>\")\n      .replace(/ /g, \"&nbsp;\")}</div>`;\n  }\n\n  return failContent;\n};\n","import lm from \"../drill.js/base.mjs\";\nimport $ from \"../xhear/base.mjs\";\nimport { isFunction, toDashCase } from \"../xhear/public.mjs\";\nimport { dispatchLoad } from \"./page.mjs\";\nimport { drawUrl } from \"./draw-template.mjs\";\nimport { fixRelatePathContent, resolvePath } from \"./public.mjs\";\nimport { initLink } from \"./link.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\n\nconst COMP = Symbol(\"Component\");\nexport const COMPONENT_PATH = Symbol(\"PATH\");\n\nObject.defineProperty($, \"COMP\", {\n  value: COMP,\n});\n\nconst cacheComps = {};\n\nlm.use([\"html\", \"htm\"], async (ctx, next) => {\n  const { result: content, params } = ctx;\n\n  if (\n    content &&\n    /<template +component *>/.test(content) &&\n    !params.includes(\"-ignore-temp\")\n  ) {\n    try {\n      const url = await drawUrl(content, ctx.url, false);\n      ctx.result = await lm()(`${url} .mjs --real:${ctx.url}`);\n    } catch (err) {\n      throw getErr(\n        \"load_comp_module\",\n        {\n          url: ctx.url,\n        },\n        err\n      );\n    }\n    ctx.resultContent = content;\n  }\n\n  await next();\n});\n\nlm.use([\"js\", \"mjs\"], async (ctx, next) => {\n  const { result: moduleData, url, realUrl } = ctx;\n  if (typeof moduleData !== \"object\" || moduleData.type !== COMP) {\n    next();\n    return;\n  }\n\n  let finnalDefault = {};\n\n  const { default: defaultData } = moduleData;\n\n  const path = realUrl || url;\n\n  if (isFunction(defaultData)) {\n    finnalDefault = await defaultData({\n      load: lm({\n        url: path,\n      }),\n    });\n  } else if (defaultData instanceof Object) {\n    finnalDefault = { ...defaultData };\n  }\n\n  const { tag, temp } = { ...moduleData, ...finnalDefault };\n\n  let tagName = tag;\n  const matchName = path.match(/\\/([^/]+)\\.m?(js|htm|html)$/);\n\n  if (!tagName) {\n    if (matchName) {\n      tagName = toDashCase(matchName[1]);\n    }\n  }\n\n  const cacheUrl = cacheComps[tagName];\n  if (cacheUrl) {\n    if (path !== cacheUrl) {\n      throw getErr(\"comp_registered\", {\n        name: tagName,\n      });\n    }\n\n    await next();\n    return;\n  }\n\n  cacheComps[tagName] = path;\n\n  let tempUrl,\n    tempContent = \"\";\n\n  if (/<.+>/.test(temp)) {\n    tempUrl = path;\n    tempContent = temp;\n  } else if (temp !== \"\") {\n    // An empty string means the shadow root is not needed.\n    if (!temp) {\n      tempUrl = resolvePath(`${matchName[1]}.html`, path);\n    } else {\n      tempUrl = resolvePath(temp, path);\n    }\n\n    tempContent = await fetch(tempUrl).then((e) => e.text());\n  }\n\n  const registerOpts = {\n    ...moduleData,\n    ...finnalDefault,\n  };\n\n  const oldReady = registerOpts.ready;\n  const { loaded } = registerOpts;\n  registerOpts.ready = async function (...args) {\n    oldReady && oldReady.apply(this, args);\n    loaded && dispatchLoad(this, loaded);\n    this.shadow && initLink(this.shadow);\n  };\n\n  const oldCreated = registerOpts.created;\n  registerOpts.created = function (...args) {\n    this[COMPONENT_PATH] = path;\n    oldCreated && oldCreated.call(this, ...args);\n  };\n\n  const regTemp = fixRelatePathContent(tempContent, path || tempUrl);\n\n  $.register({\n    ...registerOpts,\n    tag: tagName,\n    temp: regTemp,\n  });\n\n  await next();\n});\n","// import lm from \"../drill.js/base.mjs\";\nimport $ from \"../xhear/base.mjs\";\nimport {\n  resolvePath,\n  getPagesData,\n  ISERROR,\n  createPage,\n  waitPageReaded,\n} from \"./public.mjs\";\nimport { getDefault, getFailContent } from \"./page.mjs\";\nimport { createXEle } from \"../xhear/util.mjs\";\nimport { getErr } from \"../ofa-error/main.js\";\n\nconst HISTORY = \"_history\";\n\nconst appendPage = async ({ src, app }) => {\n  const { loading, fail } = app._module || {};\n\n  let loadingEl;\n  if (loading) {\n    loadingEl = createXEle(loading());\n\n    if (!loadingEl) {\n      const err = getErr(\"loading_nothing\");\n      console.log(err, loading);\n      throw err;\n    }\n\n    app.push(loadingEl);\n  }\n\n  const currentPages = [];\n  {\n    const { current } = app;\n    if (current) {\n      currentPages.push(current);\n      for (let page of current.parents) {\n        if (page.tag !== \"o-page\") {\n          break;\n        }\n\n        currentPages.unshift(page);\n      }\n    }\n  }\n\n  const oriNextPages = await getPagesData(src);\n\n  let container = app;\n\n  const publicParents = []; // Public parent pages that have not been cleared\n  const finalPages = [];\n  let old;\n\n  // Nested routing code\n  // Keep the parent page with the same src\n  let isSame = true;\n  oriNextPages.forEach((e, index) => {\n    const current = currentPages[index];\n\n    if (!isSame) {\n      finalPages.push(e);\n      return;\n    }\n\n    if (!current || current.src !== e.src) {\n      isSame = false;\n      finalPages.push(e);\n      old = current;\n      return;\n    }\n\n    publicParents.push(current);\n\n    container = current;\n  });\n\n  // In the case of only the parent page, the old variable needs to be corrected\n  if (currentPages.length > oriNextPages.length && !old) {\n    currentPages.some((e, index) => {\n      const current = oriNextPages[index];\n\n      if (!current || current.src !== e.src) {\n        old = e;\n        return true;\n      }\n    });\n  }\n\n  let topPage, innerPage;\n\n  finalPages.forEach((pageData) => {\n    const { ISERROR: isError } = pageData;\n\n    let page;\n    if (isError) {\n      const failContent = getFailContent(pageData.src, pageData, fail);\n\n      page = createPage(pageData.src, {\n        type: $.PAGE,\n        temp: failContent,\n      });\n    } else {\n      page = createPage(pageData.src, pageData.defaults);\n    }\n\n    if (!topPage) {\n      topPage = page;\n      return;\n    }\n\n    if (!innerPage) {\n      topPage.push(page);\n      innerPage = page;\n      return;\n    }\n\n    innerPage.push(page);\n    innerPage = page;\n  });\n\n  if (topPage) {\n    container.push(topPage);\n  }\n\n  loadingEl && loadingEl.remove();\n\n  return { current: topPage, old, publics: publicParents };\n};\n\nconst emitRouterChange = (_this, publics, type) => {\n  if (publics && publics.length) {\n    const { current } = _this;\n    publics.forEach((page) => {\n      // const { page } = e;\n      const { routerChange } = page._defaults;\n\n      if (routerChange) {\n        routerChange.call(page, { type, current });\n      }\n    });\n  }\n};\n\n$.register({\n  tag: \"o-app\",\n  temp: `<style>:host{position:relative;display:block}::slotted(*){display:block;width:100%;height:100%;}</style><slot></slot>`,\n  attrs: {\n    src: null,\n  },\n  data: {\n    [HISTORY]: [],\n    appIsReady: null,\n  },\n  watch: {\n    async src(val) {\n      if (this.__init_src) {\n        if (this.__init_src !== val) {\n          throw getErr(\"app_src_change\");\n        }\n        return;\n      }\n\n      if (!val) {\n        return;\n      }\n\n      this.__init_src = val;\n\n      let selfUrl = val;\n      if (val && !val.startsWith(\"//\") && !/[a-z]+:\\/\\//.test(val)) {\n        selfUrl = resolvePath(val);\n      }\n\n      const load = lm();\n\n      const moduleData = await load(selfUrl);\n\n      const defaults = await getDefault(moduleData, selfUrl);\n\n      this._module = defaults;\n\n      this.extend(defaults.proto);\n\n      if (defaults.ready) {\n        defaults.ready.call(this);\n      }\n\n      if (this._settedRouters) {\n        return;\n      }\n\n      if (!this.$(\"o-page\") && !this._initHome && defaults.home) {\n        const homeUrl = new URL(defaults.home, selfUrl).href;\n        this.push(`<o-page src=\"${homeUrl}\"></o-page>`);\n      }\n    },\n  },\n  proto: {\n    async back(delta = 1) {\n      if (!this[HISTORY].length) {\n        console.warn(`It's already the first page, can't go back`);\n        return;\n      }\n\n      const { _noanime } = this;\n\n      // Delete historical data for response numbers\n      delta = delta < this[HISTORY].length ? delta : this[HISTORY].length;\n\n      const newCurrent = this[HISTORY].splice(-delta)[0];\n\n      let {\n        current: page,\n        old: needRemovePage,\n        publics,\n      } = await appendPage({\n        src: newCurrent.src,\n        app: this,\n      });\n\n      if (!_noanime && page) {\n        await pageInAnime({\n          page,\n          key: \"previous\",\n        });\n      }\n\n      if (needRemovePage) {\n        needRemovePage = resetOldPage(needRemovePage);\n      }\n\n      this.emit(\"router-change\", {\n        data: { name: \"back\", delta },\n      });\n\n      emitRouterChange(this, publics, \"back\");\n\n      if (!_noanime && needRemovePage) {\n        await pageOutAnime({\n          page: needRemovePage,\n          key: \"next\",\n        });\n      }\n\n      if (needRemovePage) {\n        needRemovePage.remove();\n      }\n    },\n    async _navigate({ type, src }) {\n      const { _noanime } = this;\n      const { current: oldCurrent } = this;\n      // src = new URL(src, location.href).href;\n      src = resolvePath(src);\n\n      runAccess(this, src);\n\n      if (!oldCurrent) {\n        this._initHome = src;\n      }\n\n      let {\n        current: page,\n        old: needRemovePage,\n        publics,\n      } = await appendPage({\n        src,\n        app: this,\n      });\n\n      if (!page) {\n        return;\n      }\n\n      if (!_noanime && page) {\n        await pageInAnime({\n          page,\n          key: \"next\",\n        });\n      }\n\n      if (needRemovePage) {\n        needRemovePage = resetOldPage(needRemovePage);\n      }\n\n      if (type === \"goto\") {\n        oldCurrent && this[HISTORY].push({ src: oldCurrent.src });\n      }\n\n      this.emit(\"router-change\", {\n        data: { name: type, src },\n      });\n\n      emitRouterChange(this, publics, type);\n\n      if (oldCurrent && needRemovePage) {\n        if (!_noanime) {\n          await pageOutAnime({\n            page: needRemovePage,\n            key: \"previous\",\n          });\n        }\n        needRemovePage.remove();\n      }\n    },\n    goto(src) {\n      return this._navigate({ type: \"goto\", src });\n    },\n    replace(src) {\n      return this._navigate({ type: \"replace\", src });\n    },\n    get current() {\n      return this.all(\"o-page\")\n        .reverse()\n        .find((page) => {\n          let target = page;\n          while (target.tag === \"o-page\") {\n            if (target.data.willRemoved) {\n              return false;\n            }\n            target = target.parent;\n          }\n\n          return true;\n        });\n    },\n    get routers() {\n      let { current } = this;\n\n      if (!current) {\n        return [];\n      }\n\n      const routers = [\n        ...this[HISTORY],\n        {\n          src: current.src,\n        },\n      ];\n\n      return routers;\n    },\n    set routers(_routers) {\n      _routers = _routers.map((e) => {\n        runAccess(this, e.src);\n\n        return { src: e.src };\n      });\n\n      this._settedRouters = 1;\n\n      this.html = \"\";\n\n      const historyRouters = _routers.slice();\n\n      const currentRouter = historyRouters.pop();\n\n      this[HISTORY].length = 0;\n      this[HISTORY].push(...historyRouters);\n\n      this.push({\n        tag: \"o-page\",\n        src: currentRouter.src,\n      });\n    },\n  },\n});\n\n// Ensure that the page is available, handle cross-domain pages and other operations\nconst runAccess = (app, src) => {\n  const access = app?._module?.access;\n\n  const srcObj = new URL(src);\n\n  if (srcObj.origin !== location.origin && !access) {\n    const err = getErr(\"no_cross_access_func\");\n    console.log(err, app.ele, app?._module);\n    throw err;\n  }\n\n  if (access) {\n    const result = access(src);\n\n    if (result !== true) {\n      const err = getErr(\n        \"access_return_error\",\n        { src },\n        result instanceof Error ? result : undefined\n      );\n      console.log(err, app);\n      throw err;\n    }\n  }\n};\n\nconst pageInAnime = async ({ page, key }) => {\n  if (!page._rendered) {\n    // firefox bug\n    await waitPageReaded(page);\n  }\n\n  const { pageAnime } = page;\n\n  const targetAnime = pageAnime[key];\n\n  if (targetAnime) {\n    page.css = {\n      ...page.css,\n      ...targetAnime,\n    };\n\n    nextAnimeFrame(() => {\n      page.css = {\n        ...page.css,\n        transition: \"all ease .3s\",\n        ...(pageAnime.current || {}),\n      };\n    });\n  }\n};\n\nconst pageOutAnime = ({ page, key }) =>\n  new Promise((resolve) => {\n    const targetAnime = page.pageAnime[key];\n\n    if (targetAnime) {\n      nextAnimeFrame(() => {\n        page.one(\"transitionend\", resolve);\n\n        page.css = {\n          ...page.css,\n          transition: \"all ease .3s\",\n          ...targetAnime,\n        };\n      });\n    } else {\n      resolve();\n    }\n  });\n\nconst nextAnimeFrame = (func) =>\n  requestAnimationFrame(() => {\n    setTimeout(func, 5);\n  });\n\nconst resetOldPage = (needRemovePage) => {\n  needRemovePage.css = {\n    position: \"absolute\",\n    width: `${needRemovePage.width}px`,\n    height: `${needRemovePage.height}px`,\n  };\n  needRemovePage.data.willRemoved = 1;\n\n  return needRemovePage;\n};\n","import $ from \"../xhear/base.mjs\";\nimport { isFunction } from \"../xhear/public.mjs\";\nimport { COMPONENT_PATH } from \"./comp.mjs\";\n\nconst oldAttr = $.fn.attr;\n\nfunction attr(...args) {\n  let [name, value, options] = args;\n\n  if (isFunction(value)) {\n    value = value();\n  }\n\n  const { host } = this;\n\n  if (host && [\"href\", \"src\"].includes(name) && /^\\./.test(value)) {\n    const { PATH } = host;\n\n    if (PATH) {\n      const { href } = new URL(value, PATH);\n\n      return oldAttr.call(this, name, href);\n    }\n  }\n\n  return oldAttr.call(this, ...args);\n}\n\nattr.always = oldAttr.always;\n\n$.fn.extend({\n  get app() {\n    let target = this;\n\n    while (target && target !== \"o-app\") {\n      if (target.tag === \"o-page\") {\n        const result = target.parents.find((el) => el.tag === \"o-app\");\n\n        if (result) {\n          target = result;\n          break;\n        }\n      }\n\n      target = target.host;\n\n      if (!target) {\n        break;\n      }\n    }\n\n    return target;\n  },\n  get PATH() {\n    // component or page file path\n    return this[COMPONENT_PATH] || this.src || null;\n  },\n  attr,\n});\n","import { nextTick } from \"../stanz/public.mjs\";\nimport $ from \"../xhear/base.mjs\";\nimport { hyphenToUpperCase, toDashCase } from \"../xhear/public.mjs\";\n\nconst temp = `<style>:host{display:contents}</style><slot></slot>`;\n\nconst CONSUMERS = Symbol(\"consumers\");\n\n$.register({\n  tag: \"o-provider\",\n  temp,\n  attrs: {\n    name: null,\n  },\n  watch: {\n    name() {\n      this.consumers.forEach((item) => {\n        item._update();\n      });\n    },\n  },\n  proto: {\n    get consumers() {\n      return [...Array.from(this[CONSUMERS])];\n    },\n  },\n  ready() {\n    this[CONSUMERS] = new Set();\n\n    // 通过监听事件，更新consumer\n    this.on(`update-consumer`, (e) => {\n      const { name, consumer } = e.data;\n\n      if (name && this.name === name) {\n        consumer[PROVIDER] = this.ele;\n        this[CONSUMERS].add(consumer.ele);\n\n        // 查找到对应的provider后，禁止向上冒泡\n        e.stopPropagation();\n\n        if (this._refreshed) {\n          // 刷新过后，consumer直接开始重置数据\n          Object.keys(this).forEach((key) => {\n            if (key === \"name\" || key === \"tag\" || !/\\D/.test(key)) {\n              return;\n            }\n\n            consumer[key] = this[key];\n          });\n        }\n      }\n    });\n\n    this.watch((e) => {\n      if (e.target === this && e.type === \"set\") {\n        // 自身的值修改，更新consumer\n        const { name, value } = e;\n\n        const attrName = toDashCase(name);\n\n        if (value === null || value === undefined) {\n          this.ele.removeAttribute(attrName);\n        } else if (this.ele.getAttribute(attrName) !== String(value)) {\n          this.ele.setAttribute(attrName, value);\n        }\n\n        if (name !== \"name\") {\n          this[CONSUMERS].forEach((el) => {\n            const consumer = $(el);\n            if (consumer[name] !== value) {\n              consumer[name] = value;\n            }\n          });\n        }\n      }\n    });\n  },\n  attached() {\n    // 将 attributes 的值绑定到 props 上\n    const refreshToProps = () => {\n      // 更新（添加）属性\n      Array.from(this.ele.attributes).forEach((item) => {\n        const { name, value } = item;\n\n        const propName = hyphenToUpperCase(name);\n\n        if (name === \"name\") {\n          return;\n        }\n\n        if (String(this[propName]) !== value) {\n          this[propName] = value;\n        }\n      });\n\n      // 删除属性\n      Object.keys(this).forEach((key) => {\n        if (key === \"name\" || key === \"tag\" || !/\\D/.test(key)) {\n          return;\n        }\n\n        const attrName = toDashCase(key);\n\n        const val = this.ele.getAttribute(attrName);\n\n        if (\n          (val === null || val === undefined) &&\n          (this[key] !== null || this[key] !== undefined)\n        ) {\n          this[key] = undefined;\n        }\n      });\n    };\n\n    // 将元素的所有 attributes 和 props 进行绑定\n    const obs = (this._obs = new MutationObserver((e) => {\n      // 更新数据\n      refreshToProps();\n    }));\n\n    obs.observe(this.ele, {\n      attributes: true,\n    });\n\n    // 初次更新数据\n    nextTick(() => {\n      refreshToProps();\n      this._refreshed = 1;\n\n      // 组件影子节点内，对应 slot 上冒泡的修正\n      if (this.$(\"slot\")) {\n        // 重新让所有子级的 consumer 重新刷新冒泡\n        const { ele } = this;\n        Array.from(ele.children).forEach((childEl) =>\n          emitAllConsumer(childEl, ele)\n        );\n      }\n    });\n  },\n  detached() {\n    this._refreshed = null;\n    this._obs && this._obs.disconnect();\n  },\n});\n\n/**\n * 递归地触发所有consumer组件的更新。\n *\n * 此函数会检查传入的DOM元素，如果该元素是consumer组件，它将更新该组件。\n * 如果元素具有shadowRoot，函数将递归地通知影子节点内的元素。\n * 如果元素是slot元素，并且emitSlot参数为true，它将检查slot的名称，并通知具有相同slot名称的元素。\n *\n * @param {HTMLElement} ele - 要检查和触发更新的DOM元素。\n * @param {HTMLElement} rootProvider - 根provider元素，consumer将使用此元素作为数据源。\n * @param {boolean} [emitSlot=true] - 是否应该触发slot元素对应的子元素的更新。\n * @returns {void}\n */\nconst emitAllConsumer = (ele, rootProvider, emitSlot = true) => {\n  if (ele.tagName === \"O-PROVIDER\") {\n    return;\n  }\n\n  if (ele.tagName === \"O-CONSUMER\") {\n    // 重新冒泡\n    $(ele)._update(rootProvider);\n  } else if (ele.tagName === \"SLOT\" && emitSlot) {\n    const slotName = ele.getAttribute(\"name\") || \"\";\n    const host = ele?.getRootNode()?.host;\n    Array.from(host.children).forEach((e) => {\n      const selfSlotName = e.getAttribute(\"slot\") || \"\";\n      if (selfSlotName === slotName) {\n        // 继续递归符合插槽的元素\n        emitAllConsumer(e, rootProvider);\n      }\n    });\n    return;\n  } else if (ele.shadowRoot) {\n    // 通知影子节点内的元素\n    Array.from(ele.shadowRoot.children).forEach((childEl) =>\n      emitAllConsumer(childEl, rootProvider, false)\n    );\n  }\n\n  // 不符合的元素继续递归\n  Array.from(ele.children).forEach((childEl) =>\n    emitAllConsumer(childEl, rootProvider)\n  );\n};\n\nconst PROVIDER = Symbol(\"provider\");\n\n$.register({\n  tag: \"o-consumer\",\n  temp,\n  attrs: {\n    name: null,\n  },\n  watch: {\n    name() {\n      this._update();\n    },\n  },\n  proto: {\n    get provider() {\n      return this[PROVIDER];\n    },\n    _update(provider) {\n      if (provider) {\n        if (this[PROVIDER] === provider) {\n          // 相同的 provider 发送的通知，不用再继续冒泡查找\n          return true;\n        }\n\n        // 切换 provider 操作，删除不存在的属性\n        const $provider = $(provider);\n        const keys = Object.keys($provider);\n        Object.keys(this).forEach((key) => {\n          if (!/\\D/.test(key)) {\n            return;\n          }\n          if (!keys.includes(key)) {\n            this[key] = undefined;\n          }\n        });\n      }\n\n      this.clearProvider();\n\n      if (this.name) {\n        this.emit(`update-consumer`, {\n          data: {\n            name: this.name,\n            consumer: this,\n          },\n          composed: true,\n        });\n      }\n    },\n    clearProvider() {\n      if (this[PROVIDER]) {\n        // 刷新前清除旧的附身provider\n        const provider = $(this[PROVIDER]);\n        provider[CONSUMERS].delete(this.ele);\n      }\n    },\n  },\n  ready() {\n    this[PROVIDER] = null;\n\n    // 最开始带有 attribute 的 key，在 provider 更新后，也同步到 consumer 的 attributes 上\n    const names = Array.from(this.ele.attributes)\n      .map((e) => {\n        if (e.name !== \"name\") {\n          return e.name;\n        }\n      })\n      .filter((e) => !!e);\n\n    if (names.length) {\n      this.watch((e) => {\n        let { name } = e;\n        const attrName = toDashCase(name);\n\n        if (e.target === this && e.type === \"set\" && names.includes(attrName)) {\n          if (e.value === null || e.value === undefined) {\n            this.ele.removeAttribute(attrName);\n            return;\n          }\n          this.ele.setAttribute(attrName, String(e.value));\n        }\n      });\n    }\n  },\n  attached() {\n    if (!this[PROVIDER]) {\n      this._update();\n    }\n  },\n  detached() {\n    this.clearProvider();\n  },\n});\n","import $ from \"../xhear/base.mjs\";\nimport { isDebug } from \"../stanz/public.mjs\";\nimport \"./inject-host.mjs\";\nimport \"./comp.mjs\";\nimport \"./page.mjs\";\nimport \"./app.mjs\";\nimport \"./extend.mjs\";\nimport \"./link.mjs\";\nimport \"./context.mjs\";\n\nconst version = \"ofa.js@4.5.0\";\n$.version = version.replace(\"ofa.js@\", \"\");\n\nif (document.currentScript) {\n  Object.defineProperty($, \"debugMode\", {\n    get: () => isDebug.value,\n  });\n}\n\nif (typeof window !== \"undefined\") {\n  window.$ = $;\n}\n\nObject.defineProperty(globalThis, \"ofa\", {\n  value: $,\n});\n\nexport default $;\n"],"names":["error_origin","errors","globalThis","navigator","language","langFirst","toLowerCase","split","localStorage","targetLangErrors","JSON","parse","Object","assign","errCacheTime","Date","now","Number","fetch","then","e","json","catch","stringify","error","console","isSafari","userAgent","includes","getErr","key","options","errObj","desc","getErrDesc","toString","stack","replace","Error","cause","k","RegExp","getRandomId","Math","random","slice","objectToString","prototype","getType","value","call","isObject","obj","type","isDebug","document","currentScript","attributes","hasOwnProperty","TICKERR","afterTimer","asyncsCounter","tickSets","Set","nextTick","callback","clearTimeout","setTimeout","Promise","resolve","log","tickId","add","clear","has","delete","extend","_this","proto","descriptor","getOwnPropertyNames","getOwnPropertySymbols","forEach","result","getOwnPropertyDescriptor","configurable","enumerable","writable","get","set","defineProperty","dataRevoked","data","xid","err","isRevokedErr","firstLine","isFunction","val","hyphenToUpperCase","str","match","p1","toUpperCase","toDashCase","meetsEle","ele","expr","temp","createElement","content","append","cloneNode","querySelector","removeArrayValue","arr","target","index","indexOf","splice","searchEle","el","HTMLTemplateElement","Array","from","querySelectorAll","freeze","Watcher","constructor","opts","this","hasModified","path","currentTarget","keys","name","positionIndex","getModifieds","currentKeys","length","hasReplaced","modifieds","cloneKeys","targetKey","shift","push","Watchers","super","some","emitUpdate","oldValue","args","warn","_hasWatchs","watcher","WATCHS","func","_update","owner","parent","watchFn","watch","Function","wid","unwatch","watchTick","wait","timeout","hisArgs","debounce","filter","item","refresh","watchUntil","f","tid","mutatingMethods","holder","Symbol","fn","arrayFn","methodName","backupArr","reval","apply","SELF","deletedItems","addedItems","oldArray","newArray","backupNewArray","backupOldArray","Map","oldLen","i","oldItem","newIndex","newLen","newItem","oldIndex","compareArrays","isxdata","_owner","__unupdate","clearData","PROXY","oldFunc","defineProperties","entries","ISXDATA","handler","stanzHandler","watchs","proxy","proxySelf","revoke","Proxy","revocable","_revoke","descObj","Stanz","self","_onrevokes","toJSON","isPureArray","maxId","test","parseInt","len","join","message","lastKey","pop","setData","receiver","succeed","isSame","mismatch","Reflect","deleteProperty","undefined","String","eleX","children","ownKeys","renderExtends","beforeRender","render","getRevokes","__revokes","addRevoke","convertToFunc","funcStr","bind","template","temps","isRenderSelf","otherOpts","innerHTML","texts","tasks","revokes","originStyle","matchs","map","dataExpr","renderStyle","afterStyle","revokeStyle","remove","textEl","createTextNode","parentNode","insertBefore","removeChild","getAttribute","renderFunc","textContent","textRevoke","eles","unshift","bindData","$el","actionName","always","workResult","afterArgs","work","errCall","outerHTML","element","beforeArgs","step","clearRevs","methodRevoke","arg0","arg1","removeAttribute","_bindingRendered","dispatchEvent","Event","__render_temps","isEmptyObject","__render_data","old","new","convertEl","tagName","attr","matchData","exec","param0","setAttribute","searchTemp","rearr","isWarned","convert","codeEls","code","cid","tempName","tempChilds","wrapName","fillEl","trim","appendChild","condiEl","firstChild","newTemps","getVal","defaultData","prop","class","classList","contains","stanzProto","selfPropName","targetPropName","propName","errDesc","$ele","syncFn","sync","targetName","wid1","wid2","getBindOptions","revoker","beforeValue","tag","removeEventListener","eventFn","on","addEventListener","one","off","emit","event","bubbles","originSplice","start","count","items","removes","frag","createDocumentFragment","createXEle","positionEle","likeArrayFn","targets","reVal","reverse","childs","childNodes","__internal","sort","getOwnPropertyDescriptors","targetFunc","LikeArray","stanz","is","setKeys","isNum","formEleNames","bindProp","keyName","initInput","getFormData","all","checked","files","selectedsOpt","multiple","formFn","formData","newData","obj1","obj2","mergeObjects","isUseValue","resetValue","oldRevoke","cssHandler","_ele","style","getComputedStyle","XhearCSS","_css","cssFn","css","d","nextKeys","COMPS","renderElement","defaults","deepCopyData","attrs","root","attachShadow","mode","ready","wen","names","watchers","register","charAt","validateTagName","getAttrKeys","attrKeys","XElement","HTMLElement","created","attrName","oldVal","valType","connectedCallback","isInternal","attached","disconnectedCallback","detached","attributeChangedCallback","newValue","observedAttributes","readyState","customElements","define","READYSTATE","host","copy","isArray","FakeNode","Comment","markname","tagText","_mark","_inited","startCom","__fake_end","init","_start","__searchEl","funcName","startParent","par","newEle","prev","previousSibling","nextElementSibling","next","nextSibling","Element","previousElementSibling","replaceTempInit","replaces","ReplaceTemp","extends","regOptions","__rendered","_bindend","refreshValue","_timer","conditions","_others","isOK","conditionEl","_clearContent","_renderContent","_fake","getRenderData","__originHTML","revokeAll","fake","before","others","_if_ready","_xif","$","html","t","arrayData","regData","targetTemp","_name","vals","valsKeys","size","positionKeys","_data_xid","needRemoves","createItem","$host","currentVal","isObj","__item","oldId","$data","$old","$index","itemData","descs","initFormEle","Xhear","__xhear__","text","dataset","shadow","shadowRoot","rootNode","getRootNode","Node","parents","hosts","nextEle","after","nextEl","nexts","selfIndex","prevEle","prevs","siblings","width","height","clientWidth","clientHeight","offsetWidth","offsetHeight","outerWidth","computedStyle","outerHeight","clone","bool","wrap","unwrap","sfn","renderFn","exprType","window","objToXEle","strToXEle","initInjectEle","injectEl","mark","cloneFunc","clink","__items","__host_link","head","revokeLink","__inited","extensions","isConnected","_init","_initLink","_initStyle","href","rel","newEl","async","com","hash","charCodeAt","getStringHash","_obs","MutationObserver","mutationsList","mutation","attributeName","removedNodes","addedNodes","Text","parentElement","observe","childList","subtree","disconnect","Onion","_middlewares","use","middleware","oid","unuse","context","middlewares","values","caches","wrapFetch","url","params","URL","reUrl","origin","pathname","fetchObj","processor","addHandler","ctx","notHttp","import","realUrl","resp","status","arrayBuffer","module","WebAssembly","compile","instance","Instance","exports","link","aliasMap","moduleName","baseURI","startsWith","lastUrl","first","location","base","LOADED","agent","urldata","lastIndexOf","oni","run","contentType","headers","targetMapObject","find","newOni","lm","meta","ourl","reurl","createLoad","alias","LoadModule","loaded","__initSrc","src","load","CustomEvent","_root","LM","config","resolvePath","fixRelate","fixRelatePathContent","styleEl","original","adapted","ISERROR","getPagesData","pagesData","beforeSrc","errorObj","pageSrc","lastSrc","realPageSrc","pageSrcObj","current","createPage","tempCon","targetPage","_renderDefault","waitPageReaded","page","_rendered","timer","setInterval","clearInterval","oldRender","top","__fixLinkTimer","initLink","__processed","$tar","app","metaKey","shiftKey","defaultPrevented","preventDefault","prevented","originHref","finalHref","goto","strToBase64DataURI","isb64","file","File","createObjectURL","fr","FileReader","onload","readAsDataURL","cacheLink","drawUrl","isPage","targetUrl","debugMode","tempEl","titleEl","scriptEl","beforeContent","scriptContent","t_content","pathStr","fileContent","sourcemapStr","filePath","originContent","startLine","originLineArr","mappings","originStarRowIndex","findIndex","lineContent","originEndRowIndex","beforeRowIndex","beforeColIndex","rowId","rowStr","colId","currentStr","vlcEncode","sourcesContent","getSourcemapUrl","finalContent","isFirefox","base64","encoded","vlq","toVLQSigned","digit","PAGE","resultContent","moduleData","defaultsData","getDefault","tempSrc","pageIsReady","__init_src","_defaults","parentPage","__need_wraps","failContent","getFailContent","_module","fail","needWraps","__not_run_attached","pageAnime","_pageAnime","__reject","dispatchLoad","__resolve","appIsReady","back","reject","pms","res","sheet","finnalDefault","default","relateLoad","query","urlObj","fromEntries","searchParams","COMP","COMPONENT_PATH","cacheComps","matchName","cacheUrl","tempUrl","tempContent","registerOpts","oldReady","oldCreated","regTemp","HISTORY","appendPage","loading","loadingEl","currentPages","oriNextPages","container","publicParents","finalPages","topPage","innerPage","pageData","isError","publics","emitRouterChange","routerChange","selfUrl","_settedRouters","_initHome","home","homeUrl","delta","_noanime","newCurrent","needRemovePage","pageInAnime","resetOldPage","pageOutAnime","oldCurrent","runAccess","_navigate","willRemoved","routers","_routers","historyRouters","currentRouter","access","targetAnime","nextAnimeFrame","transition","requestAnimationFrame","position","oldAttr","PATH","CONSUMERS","consumers","consumer","PROVIDER","stopPropagation","_refreshed","refreshToProps","childEl","emitAllConsumer","rootProvider","emitSlot","slotName","provider","$provider","clearProvider","composed","version"],"mappings":"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"}