{"version":3,"file":"body-ghost.min.mjs","sources":["../body-ghost.js"],"sourcesContent":["const MAPPGING_ELE = Symbol(\"mapping-element\");\nconst ORIGIN_ELE = Symbol(\"origin-element\");\n\n$.register({\n  tag: \"body-ghost-mapping\",\n  attrs: {\n    ghostId: null,\n  },\n  proto: {\n    get origin() {\n      return $(this[ORIGIN_ELE]);\n    },\n  },\n  temp: `<style>:host{display:contents}</style>`,\n});\n\n$.register({\n  tag: \"body-ghost\",\n  attrs: {\n    ghostId: Math.random().toString(32).slice(2),\n  },\n  temp: `<style>:host{display:none}</style>`,\n  proto: {\n    get mapping() {\n      return $(this[MAPPGING_ELE]);\n    },\n  },\n  ready() {\n    this[MAPPGING_ELE] = null;\n  },\n  attached() {\n    const mappingEl = (this[MAPPGING_ELE] =\n      document.createElement(\"body-ghost-mapping\"));\n\n    mappingEl.setAttribute(\"ghost-id\", this.ghostId);\n\n    $(mappingEl)[ORIGIN_ELE] = this.ele;\n\n    Object.defineProperties(mappingEl.shadowRoot, {\n      // 伪装parentNode，让所有事情向上冒泡\n      parentNode: {\n        get: () => {\n          return this.ele.parentNode;\n        },\n      },\n    });\n\n    const originChildNodes = this.ele.childNodes;\n\n    Object.defineProperties(this.ele, {\n      // 伪装子元素\n      childNodes: {\n        get: () => {\n          return mappingEl.shadowRoot.childNodes;\n        },\n      },\n    });\n\n    $.nextTick(() => {\n      Array.from(originChildNodes).forEach((el) => {\n        el.__internal = 1;\n        mappingEl.shadowRoot.appendChild(el);\n        delete el.__internal;\n      });\n    });\n\n    document.body.appendChild(mappingEl);\n  },\n  detached() {\n    if (this[MAPPGING_ELE]) {\n      this[MAPPGING_ELE].remove();\n      this[MAPPGING_ELE] = null;\n    }\n  },\n});\n"],"names":["MAPPGING_ELE","Symbol","ORIGIN_ELE","$","register","tag","attrs","ghostId","proto","origin","this","temp","Math","random","toString","slice","mapping","ready","attached","mappingEl","document","createElement","setAttribute","ele","Object","defineProperties","shadowRoot","parentNode","get","originChildNodes","childNodes","nextTick","Array","from","forEach","el","__internal","appendChild","body","detached","remove"],"mappings":";AAAA,MAAMA,EAAeC,OAAO,mBACtBC,EAAaD,OAAO,kBAE1BE,EAAEC,SAAS,CACTC,IAAK,qBACLC,MAAO,CACLC,QAAS,MAEXC,MAAO,CACL,UAAIC,GACF,OAAON,EAAEO,KAAKR,GACf,GAEHS,KAAM,2CAGRR,EAAEC,SAAS,CACTC,IAAK,aACLC,MAAO,CACLC,QAASK,KAAKC,SAASC,SAAS,IAAIC,MAAM,IAE5CJ,KAAM,qCACNH,MAAO,CACL,WAAIQ,GACF,OAAOb,EAAEO,KAAKV,GACf,GAEH,KAAAiB,GACEP,KAAKV,GAAgB,IACtB,EACD,QAAAkB,GACE,MAAMC,EAAaT,KAAKV,GACtBoB,SAASC,cAAc,sBAEzBF,EAAUG,aAAa,WAAYZ,KAAKH,SAExCJ,EAAEgB,GAAWjB,GAAcQ,KAAKa,IAEhCC,OAAOC,iBAAiBN,EAAUO,WAAY,CAE5CC,WAAY,CACVC,IAAK,IACIlB,KAAKa,IAAII,cAKtB,MAAME,EAAmBnB,KAAKa,IAAIO,WAElCN,OAAOC,iBAAiBf,KAAKa,IAAK,CAEhCO,WAAY,CACVF,IAAK,IACIT,EAAUO,WAAWI,cAKlC3B,EAAE4B,UAAS,KACTC,MAAMC,KAAKJ,GAAkBK,SAASC,IACpCA,EAAGC,WAAa,EAChBjB,EAAUO,WAAWW,YAAYF,UAC1BA,EAAGC,UAAU,GACpB,IAGJhB,SAASkB,KAAKD,YAAYlB,EAC3B,EACD,QAAAoB,GACM7B,KAAKV,KACPU,KAAKV,GAAcwC,SACnB9B,KAAKV,GAAgB,KAExB"}