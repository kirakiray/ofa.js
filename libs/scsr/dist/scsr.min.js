//! ofa.js - v4.5.2 https://github.com/kirakiray/ofa.js  (c) 2018-2024 YAO
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";const e="https://ofajs.github.io/ofa-errors/errors",t={};if(globalThis.navigator&&navigator.language){let o=navigator.language.toLowerCase().split("-")[0];"zh"===o&&"zh-cn"!==navigator.language.toLowerCase()&&(o="zhft"),(async()=>{if(localStorage["ofa-errors"]){const e=JSON.parse(localStorage["ofa-errors"]);Object.assign(t,e)}const r=localStorage["ofa-errors-time"];if(!r||Date.now()>Number(r)+3e5){const r=await fetch(`${e}/${o}.json`).then((e=>e.json())).catch((()=>null));r?(localStorage["ofa-errors"]=JSON.stringify(r),localStorage["ofa-errors-time"]=Date.now()):r=await fetch(`${e}/en.json`).then((e=>e.json())).catch((e=>(console.error(e),null))),Object.assign(t,r)}})()}globalThis.navigator&&navigator.userAgent.includes("Safari")&&navigator.userAgent.includes("Chrome"),"undefined"!=typeof document&&document.currentScript&&document.currentScript.attributes.hasOwnProperty("debug"),new Set;function o({app:e,getStateUrl:t,fixStateUrl:o}){let r,n,a,s,i;history.state&&history.state.routerMode&&(e.routers=history.state.routers),e.on("router-change",(o=>{let i="pushState";const{name:c,delta:l,src:u}=o.data||{};switch(c){case"replace":i="replaceState";case"goto":const{routers:o}=e,{pathname:c,search:g,origin:h}=new URL(u,location.href);if(n)return void(n=null);let f="";f=t?t(c,g,i):location.origin===h?`#${c}${g}`:`#${h}${c}${g}`,s&&(i="replaceState",s=null),history[i]({routerMode:1,routers:o.map((e=>({src:e.src})))},"",f);break;case"back":if(a)return void(a=null);r=1,history.go(-l)}})),window.addEventListener("popstate",i=t=>{const{state:i}=t;if(r)return void(r=null);if(!i){if(o){const t=o();if(t)return s=1,void l(e,(()=>e.goto(t)));if(!1===t)return}return a=1,void l(e,(()=>e.back(e.routers.length-1)))}if(!i.routerMode||i.ignore)return;const{routers:c}=i,{routers:u}=e;if(c.length<u.length)a=1,l(e,(()=>e.back(u.length-c.length)));else if(c.length>u.length){const t=c.slice(),o=t.pop();if(t.length>u.length){const o=t.slice(e._history.length);e._history.push(...o)}n=1,l(e,(()=>e.goto(o.src)))}else JSON.stringify(c)!==JSON.stringify(u)&&console.error("o-router error occurred")});const c=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),l=(e,t)=>{c&&(e._noanime=!0),t(),c&&(e._noanime=!1)};return i}(()=>{async function e(){const e=$("o-app");$("o-app template[page]")?.remove();let t=!1;window.addEventListener("hashchange",(o=>{if(t){const t=new URL(location.href),{routers:o}=e;history.replaceState({routerMode:1,ignore:1,routers:o.map((e=>({src:e.src})))},"",t.hash)}})),e.on("page-loaded",(e=>{const{_defaults:t}=$(e.target);if("string"==typeof t.title){const e=$("head title");e&&(e.text=t.title)}})),history?.state?.routerMode||e.push(`<o-page src="${location.pathname}${location.search}"></o-page>`),o({app:e,getStateUrl:(e,t)=>`${e}${t}`,fixStateUrl(e){if(new URL(location.href).hash)return t=!0,setTimeout((()=>t=!1)),!1}})}"complete"===document.readyState?e():$(window).one("load",(()=>{e()}))})()}));
//# sourceMappingURL=scsr.min.js.map
