//! ofa.js - v4.4.16 https://github.com/kirakiray/ofa.js  (c) 2018-2024 YAO
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";"undefined"!=typeof document&&document.currentScript&&document.currentScript.attributes.hasOwnProperty("debug"),new Set;function e({app:e,getStateUrl:t,fixStateUrl:r}){let o,n,i,a,s;history.state&&history.state.routerMode&&(e.routers=history.state.routers),e.on("router-change",(r=>{let s="pushState";const{name:c,delta:u,src:l}=r.data||{};switch(c){case"replace":s="replaceState";case"goto":const{routers:r}=e,{pathname:c,search:h,origin:d}=new URL(l,location.href);if(n)return void(n=null);let f="";f=t?t(c,h,s):location.origin===d?`#${c}${h}`:`#${d}${c}${h}`,a&&(s="replaceState",a=null),history[s]({routerMode:1,routers:r.map((e=>({src:e.src})))},"",f);break;case"back":if(i)return void(i=null);o=1,history.go(-u)}})),window.addEventListener("popstate",s=t=>{const{state:s}=t;if(o)return void(o=null);if(!s){if(r){const t=r();if(t)return a=1,void u(e,(()=>e.goto(t)));if(!1===t)return}return i=1,void u(e,(()=>e.back(e.routers.length-1)))}if(!s.routerMode||s.ignore)return;const{routers:c}=s,{routers:l}=e;if(c.length<l.length)i=1,u(e,(()=>e.back(l.length-c.length)));else if(c.length>l.length){const t=c.slice(),r=t.pop();if(t.length>l.length){const r=t.slice(e._history.length);e._history.push(...r)}n=1,u(e,(()=>e.goto(r.src)))}else JSON.stringify(c)!==JSON.stringify(l)&&console.error("o-router error occurred")});const c=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),u=(e,t)=>{c&&(e._noanime=!0),t(),c&&(e._noanime=!1)};return s}(()=>{async function t(){const t=$("o-app");$("o-app template[page]")?.remove();let r=!1;window.addEventListener("hashchange",(e=>{if(r){const e=new URL(location.href),{routers:r}=t;history.replaceState({routerMode:1,ignore:1,routers:r.map((e=>({src:e.src})))},"",e.hash)}})),t.on("page-loaded",(e=>{const{_defaults:t}=$(e.target);if("string"==typeof t.title){const e=$("head title");e&&(e.text=t.title)}})),history?.state?.routerMode||t.push(`<o-page src="${location.pathname}${location.search}"></o-page>`),e({app:t,getStateUrl:(e,t)=>`${e}${t}`,fixStateUrl(e){if(new URL(location.href).hash)return r=!0,setTimeout((()=>r=!1)),!1}})}"complete"===document.readyState?t():$(window).one("load",(()=>{t()}))})()}));
//# sourceMappingURL=scsr.min.js.map
