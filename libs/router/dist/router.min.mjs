//! ofa.js - v4.4.0.7 https://github.com/kirakiray/ofa.js  (c) 2018-2024 YAO
new Set;function t({app:t,getStateUrl:e,fixStateUrl:o}){let r,n,i,s,a;history.state&&history.state.routerMode&&(t.routers=history.state.routers),t.on("router-change",(o=>{let a="pushState";const{name:h,delta:l,src:c}=o.data||{};switch(h){case"replace":a="replaceState";case"goto":const{routers:o}=t,{pathname:h,search:u,origin:d}=new URL(c,location.href);if(n)return void(n=null);let p="";p=e?e(h,u,a):location.origin===d?`#${h}${u}`:`#${d}${h}${u}`,s&&(a="replaceState",s=null),history[a]({routerMode:1,routers:o.map((t=>({src:t.src})))},"",p);break;case"back":if(i)return void(i=null);r=1,history.go(-l)}})),window.addEventListener("popstate",a=e=>{const{state:a}=e;if(r)return void(r=null);if(!a){if(o){const e=o();if(e)return s=1,void l(t,(()=>t.goto(e)));if(!1===e)return}return i=1,void l(t,(()=>t.back(t.routers.length-1)))}if(!a.routerMode||a.ignore)return;const{routers:h}=a,{routers:c}=t;if(h.length<c.length)i=1,l(t,(()=>t.back(c.length-h.length)));else if(h.length>c.length){const e=h.slice(),o=e.pop();if(e.length>c.length){const o=e.slice(t._history.length);t._history.push(...o)}n=1,l(t,(()=>t.goto(o.src)))}else JSON.stringify(h)!==JSON.stringify(c)&&console.error("o-router error occurred")});const h=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),l=(t,e)=>{h&&(t._noanime=!0),e(),h&&(t._noanime=!1)};return a}const e=`f-${Math.random().toString(32).slice(2)}`;$.register({tag:"o-router",temp:"<style>:host{display:block;width:100%;height:100%;overflow:hidden}::slotted(o-app){width:100%;height:100%}</style><slot></slot>",attrs:{fixBody:null},watch:{fixBody(t){if(null!==t){const t=document.createElement("style");t.setAttribute(e,""),t.innerHTML="html,body{margin:0;padding:0;width:100%;height:100%;}",document.head.append(t)}else{const t=document.head.querySelector(e);t&&t.remove()}}},attached(){const e=this.$("o-app");!history.state&&window.location.hash&&(e.$("o-page")?.remove(),e.goto(location.hash.replace("#",""))),this._popstateFunc=t({app:e,fixStateUrl(){const t=new URL(location.href);if(t.hash)return t.hash.replace("#","")}})},detached(){this._popstateFunc&&window.removeEventListener("popstate",this._popstateFunc)}}),$.extensions.link=t=>{if(""===t.attr("olink")){const e=t.attr("href");let o;try{o=new URL(e)}catch(t){return}if(!/^#\//.test(o.hash)){t.attr("origin-href",e);const o=new URL(e);t.attr("href",`${location.origin}${location.pathname}#${o.pathname}`)}}};
//# sourceMappingURL=router.min.mjs.map
