//! ofa.js - v4.5.33 https://github.com/kirakiray/ofa.js  (c) 2018-2025 YAO
!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";const t="https://ofajs.github.io/ofa-errors/errors",e={};if(globalThis.navigator&&navigator.language){let o=navigator.language.toLowerCase().split("-")[0];"zh"===o&&"zh-cn"!==navigator.language.toLowerCase()&&(o="zhft"),(async()=>{if("undefined"!=typeof localStorage){if(localStorage["ofa-errors"]){const t=JSON.parse(localStorage["ofa-errors"]);Object.assign(e,t)}const r=localStorage["ofa-errors-time"];if(!r||Date.now()>Number(r)+3e5){const r=await fetch(`${t}/${o}.json`).then((t=>t.json())).catch((()=>null));r?(localStorage["ofa-errors"]=JSON.stringify(r),localStorage["ofa-errors-time"]=Date.now()):r=await fetch(`${t}/en.json`).then((t=>t.json())).catch((t=>(console.error(t),null))),Object.assign(e,r)}}})()}globalThis.navigator&&navigator.userAgent.includes("Safari")&&navigator.userAgent.includes("Chrome");function o({app:t,getStateUrl:e,fixStateUrl:o}){let r,n,a,i,s;history.state&&history.state.routerMode&&(t.routers=history.state.routers),t.on("router-change",(o=>{let s="pushState";const{name:l,delta:c,src:h}=o.data||{};switch(l){case"replace":s="replaceState";case"goto":const{routers:o}=t,{pathname:l,search:g,origin:u}=new URL(h,location.href);if(n)return void(n=null);let f="";f=e?e(l,g,s):location.origin===u?`#${l}${g}`:`#${u}${l}${g}`,i&&(s="replaceState",i=null),history[s]({routerMode:1,routers:o.map((t=>({src:t.src})))},"",f);break;case"back":if(a)return void(a=null);r=1,history.go(-c)}})),window.addEventListener("popstate",s=e=>{const{state:s}=e;if(r)return void(r=null);if(!s){if(o){const e=o();if(e)return i=1,void c(t,(()=>t.goto(e)));if(!1===e)return}return a=1,void c(t,(()=>t.back(t.routers.length-1)))}if(!s.routerMode||s.ignore)return;const{routers:l}=s,{routers:h}=t;if(l.length<h.length)a=1,c(t,(()=>t.back(h.length-l.length)));else if(l.length>h.length){const e=l.slice(),o=e.pop();if(e.length>h.length){const o=e.slice(t._history.length);t._history.push(...o)}n=1,c(t,(()=>t.goto(o.src)))}else JSON.stringify(l)!==JSON.stringify(h)&&console.error("o-router error occurred")});const l=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),c=(t,e)=>{l&&(t._noanime=!0),e(),l&&(t._noanime=!1)};return s}const r=`f-${Math.random().toString(32).slice(2)}`;$.register({tag:"o-router",temp:"<style>:host{display:block;width:100%;height:100%;overflow:hidden}::slotted(o-app){width:100%;height:100%}</style><slot></slot>",attrs:{fixBody:null},watch:{fixBody(t){if(null!==t){const t=document.createElement("style");t.setAttribute(r,""),t.innerHTML="html,body{margin:0;padding:0;width:100%;height:100%;}",document.head.append(t)}else{const t=document.head.querySelector(r);t&&t.remove()}}},attached(){const t=this.$("o-app");!history.state&&window.location.hash&&(t.$("o-page")?.remove(),t.goto(location.hash.replace("#",""))),this._popstateFunc=o({app:t,fixStateUrl(){const t=new URL(location.href);if(t.hash)return t.hash.replace("#","")}})},detached(){this._popstateFunc&&window.removeEventListener("popstate",this._popstateFunc)}}),$.extensions.link=t=>{if(""===t.attr("olink")){const e=t.attr("href");let o;try{o=new URL(e)}catch(t){return}if(!/^#\//.test(o.hash)){t.attr("origin-href",e);const o=new URL(e);t.attr("href",`${location.origin}${location.pathname}#${o.pathname}`)}}}}));
//# sourceMappingURL=router.min.js.map
