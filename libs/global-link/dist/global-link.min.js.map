{"version":3,"file":"global-link.min.js","sources":["../global-link.js"],"sourcesContent":["const globalLinks = []; // 需要添加的 global style link\n\nconst OLDHREF = Symbol(\"oldHref\");\n\n$.register({\n  tag: \"o-global-link\",\n  attrs: {\n    href: \"\",\n  },\n  watch: {\n    href() {\n      this._adjustLink();\n    },\n  },\n  proto: {\n    _removeOld() {\n      if (this[OLDHREF]) {\n        // 去掉旧的份额\n        const oldIndex = globalLinks.indexOf(this[OLDHREF]);\n\n        if (oldIndex > -1) {\n          globalLinks.splice(oldIndex, 1);\n        }\n      }\n    },\n    _adjustLink() {\n      const fixedHref = new URL(this.href, location).href;\n\n      if (this[OLDHREF] === fixedHref) {\n        return;\n      }\n\n      this._removeOld();\n\n      this[OLDHREF] = fixedHref;\n\n      globalLinks.push(fixedHref); // 添加到份额内\n    },\n  },\n  attached() {\n    this._adjustLink();\n  },\n  detached() {\n    this._removeOld();\n  },\n});\n\n$.extensions.afterAttached = (el) => {\n  if (el.tag !== \"o-global-link\") {\n    // 添加 globalLink\n    globalLinks.forEach(\n      (href) =>\n        el.shadow && el.shadow.push(`<link rel=\"stylesheet\" href=\"${href}\">`)\n    );\n  }\n};\n"],"names":["globalLinks","OLDHREF","Symbol","$","register","tag","attrs","href","watch","this","_adjustLink","proto","_removeOld","oldIndex","indexOf","splice","fixedHref","URL","location","push","attached","detached","extensions","afterAttached","el","forEach","shadow"],"mappings":";2FAAA,MAAMA,EAAc,GAEdC,EAAUC,OAAO,WAEvBC,EAAEC,SAAS,CACTC,IAAK,gBACLC,MAAO,CACLC,KAAM,IAERC,MAAO,CACL,IAAAD,GACEE,KAAKC,aACN,GAEHC,MAAO,CACL,UAAAC,GACE,GAAIH,KAAKR,GAAU,CAEjB,MAAMY,EAAWb,EAAYc,QAAQL,KAAKR,IAEtCY,GAAY,GACdb,EAAYe,OAAOF,EAAU,EAEhC,CACF,EACD,WAAAH,GACE,MAAMM,EAAY,IAAIC,IAAIR,KAAKF,KAAMW,UAAUX,KAE3CE,KAAKR,KAAae,IAItBP,KAAKG,aAELH,KAAKR,GAAWe,EAEhBhB,EAAYmB,KAAKH,GAClB,GAEH,QAAAI,GACEX,KAAKC,aACN,EACD,QAAAW,GACEZ,KAAKG,YACN,IAGHT,EAAEmB,WAAWC,cAAiBC,IACb,kBAAXA,EAAGnB,KAELL,EAAYyB,SACTlB,GACCiB,EAAGE,QAAUF,EAAGE,OAAOP,KAAK,gCAAgCZ,QAEjE"}